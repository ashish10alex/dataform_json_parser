{
    "tables": [
        {
            "type": "table",
            "target": {
                "schema": "daily_production_report",
                "name": "0100_INDIA_ACTUALS",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\nWITH LATEST_INDIA_BUILD_ABS_WIP_DATA AS (\n  SELECT\n    LAST_UPDATE_DATETIME\n    , FULL_VIN\n    , MODEL_ID\n    , SFLT_DATE\n    , ASSY_LOC_ID\n    , OFFLINE_DATE\n    , CASE\n      WHEN SFLT_DATE IS NOT NULL THEN 'Y'\n      WHEN SFLT_DATE IS NULL THEN 'N'\n    END                                                                              AS ABS_IND\n    , (ROW_NUMBER() OVER (PARTITION BY FULL_VIN ORDER BY LAST_UPDATE_DATETIME DESC)) AS RN\n  FROM `jlr-it-scanalytics-dev.daily_production_report.DPRD_INDIA_BUILD_ABS_WIP_PLAN_ACTUALS`\n  QUALIFY RN = 1\n)\n\n-- ADDED ABS,BUILD,WIP AS TABLE_TYPE\n, TABLE_ABS AS (\n  SELECT\n    LAST_UPDATE_DATETIME\n    , FULL_VIN\n    , MODEL_ID\n    , SFLT_DATE\n    , ASSY_LOC_ID\n    , ABS_IND\n    , SFLT_DATE AS REPORT_DATE\n    , 'ABS'     AS TABLE_TYPE\n  FROM LATEST_INDIA_BUILD_ABS_WIP_DATA\n  WHERE SFLT_DATE IS NOT NULL\n)\n\n, TABLE_BUILD AS (\n  SELECT\n    LAST_UPDATE_DATETIME\n    , FULL_VIN\n    , MODEL_ID\n    , SFLT_DATE\n    , ASSY_LOC_ID\n    , ABS_IND\n    , OFFLINE_DATE AS REPORT_DATE\n    , 'BUILD'      AS TABLE_TYPE\n  FROM LATEST_INDIA_BUILD_ABS_WIP_DATA\n  WHERE OFFLINE_DATE IS NOT NULL\n)\n\n, TABLE_WIP AS (\n  SELECT\n    LAST_UPDATE_DATETIME\n    , FULL_VIN\n    , MODEL_ID\n    , SFLT_DATE\n    , ASSY_LOC_ID\n    , ABS_IND\n    , OFFLINE_DATE AS REPORT_DATE\n    , 'WIP'        AS TABLE_TYPE\n  FROM LATEST_INDIA_BUILD_ABS_WIP_DATA\n  WHERE OFFLINE_DATE IS NOT NULL\n    AND SFLT_DATE IS NULL\n)\n\n, TABLE_NOT_OFFLINE AS (\n  SELECT\n    LAST_UPDATE_DATETIME\n    , FULL_VIN\n    , MODEL_ID\n    , SFLT_DATE\n    , ASSY_LOC_ID\n    , ABS_IND\n    , OFFLINE_DATE  AS REPORT_DATE\n    , 'NOT OFFLINE' AS TABLE_TYPE\n  FROM LATEST_INDIA_BUILD_ABS_WIP_DATA\n  WHERE OFFLINE_DATE IS NULL\n    AND SFLT_DATE IS NULL\n)\n\n\n, FINAL_TABLE AS (\n  SELECT * FROM TABLE_ABS\n  UNION ALL\n  SELECT * FROM TABLE_BUILD\n  UNION ALL\n  SELECT * FROM TABLE_WIP\n-- UNION ALL\n-- SELECT * FROM TABLE_NOT_OFFLINE\n)\n\n\nSELECT * FROM FINAL_TABLE\n\n",
            "disabled": false,
            "fileName": "definitions/intermediate/0100_INDIA_ACTUALS.sqlx",
            "tags": [
                "DPR",
                "INDIA_ACTUALS"
            ],
            "actionDescriptor": {
                "description": "Initial data which comes from the excel file in the sharepoint folder",
                "columns": [
                    {
                        "description": "Unique identifier for a car in D42",
                        "path": [
                            "VEH_ID"
                        ]
                    },
                    {
                        "description": "Unique identifier for base hold",
                        "path": [
                            "HOLD_BASE_ID"
                        ]
                    },
                    {
                        "description": "Base hold description",
                        "path": [
                            "HOLD_BASE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold type",
                        "path": [
                            "HOLD_TYPE_ID"
                        ]
                    },
                    {
                        "description": "Hold type description",
                        "path": [
                            "HOLD_TYPE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold group",
                        "path": [
                            "HOLD_GROUP_ID"
                        ]
                    },
                    {
                        "description": "Hold group description",
                        "path": [
                            "HOLD_GROUP_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Start date of hold",
                        "path": [
                            "HOLD_START_DATE"
                        ]
                    },
                    {
                        "description": "End date of hold",
                        "path": [
                            "HOLD_END_DATE"
                        ]
                    },
                    {
                        "description": "Reason for removing hold, if exisists",
                        "path": [
                            "HOLD_REMOVAL_REASON"
                        ]
                    },
                    {
                        "description": "Unique identifier for car in VISTA",
                        "path": [
                            "META_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Short vin",
                        "path": [
                            "SHORT_VIN"
                        ]
                    },
                    {
                        "description": "Full vin - cars in allocation will not have a VIN",
                        "path": [
                            "FULL_VIN"
                        ]
                    },
                    {
                        "description": "Unique identifier for an order in PLO",
                        "path": [
                            "SPECIFIC_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Identifier in MES",
                        "path": [
                            "CSO_NUMBER"
                        ]
                    },
                    {
                        "description": "Model description e.g L460 - Range Rover",
                        "path": [
                            "MODEL_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Location id of where car was assembled",
                        "path": [
                            "ASSY_LOC_ID"
                        ]
                    },
                    {
                        "description": "Name of the plant where car was build",
                        "path": [
                            "PLANT_NAME"
                        ]
                    },
                    {
                        "description": "Unique identifier for a dealer",
                        "path": [
                            "DEAL_ID"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was sent to a scrapped cars dealer",
                        "path": [
                            "VEHICLE_SCRAPPED"
                        ]
                    },
                    {
                        "description": "Indicator for cars which are assembled in other plants & shipped to India",
                        "path": [
                            "KD_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when a car was built",
                        "path": [
                            "OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car was ABSed. Note that a car can be ABSed multiple times",
                        "path": [
                            "ABS_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Accepted by Sales(ABS)",
                        "path": [
                            "FIRST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was last Accepted by Sales(ABS)",
                        "path": [
                            "LATEST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was Ready for Sales(RFS)",
                        "path": [
                            "RFS_IND"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car is a special vehicle",
                        "path": [
                            "SVO_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "FIRST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "LATEST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. If a hold is not an SVO hold it will be False",
                        "path": [
                            "_SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. All rows for an order will be true if it had SVO hold when RFSed",
                        "path": [
                            "SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "Off assembly timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Latest ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "LATEST_ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Fuel type from VISTA",
                        "path": [
                            "FUEL_TYPE"
                        ]
                    },
                    {
                        "description": "Sales channel - VISTA. e.g. Private, Fleet & Business",
                        "path": [
                            "GLOBAL_SALES_CHANNEL_DESC"
                        ]
                    },
                    {
                        "description": "Model year - VISTA ( e.g. 24MY)",
                        "path": [
                            "MODEL_YEAR_DESC"
                        ]
                    },
                    {
                        "description": "4 letter model id derived from model_description e.g. L460",
                        "path": [
                            "MODEL_ID"
                        ]
                    },
                    {
                        "description": "Adjusted_offassy_time timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_OFFASSY"
                        ]
                    },
                    {
                        "description": "Adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_ABS"
                        ]
                    },
                    {
                        "description": "Latest_adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_LATEST_ABS"
                        ]
                    },
                    {
                        "description": "Marktet for which the car is made for. Europe",
                        "path": [
                            "DEST_REGION"
                        ]
                    },
                    {
                        "description": "Region of the market for which the car is made for. e.g Italy",
                        "path": [
                            "DEST_MARKET"
                        ]
                    },
                    {
                        "description": "Brochure Model Code. e.g AJ460",
                        "path": [
                            "BMC"
                        ]
                    },
                    {
                        "description": "E.g. 2.0L Diesel I4",
                        "path": [
                            "ENGINE_FAMILY"
                        ]
                    },
                    {
                        "description": "E.g. 260JZ",
                        "path": [
                            "DPCK_CODE"
                        ]
                    },
                    {
                        "description": "E.g. SE/HSE",
                        "path": [
                            "TRIM_SPEC"
                        ]
                    },
                    {
                        "description": "Date at which WIP data needs to be looked at",
                        "path": [
                            "WIP_REPORT_DAY"
                        ]
                    },
                    {
                        "description": "Boolean used to identify if the plant was operational on the Day. Not production days are not counted in WIP age.",
                        "path": [
                            "PRODUCTION_DAY"
                        ]
                    },
                    {
                        "description": "Sudo column w/t value that is used for calculating",
                        "path": [
                            "WIP_COUNTER"
                        ]
                    },
                    {
                        "description": "Number of days car has been in WIP on a given reporting day",
                        "path": [
                            "WIP_AGE"
                        ]
                    },
                    {
                        "description": "Maximum WIP age for a given plant-model combination",
                        "path": [
                            "MAX_WIP_AGE_PLANT_MODEL"
                        ]
                    },
                    {
                        "description": "Plan / target corrosponding to table_type",
                        "path": [
                            "PLAN"
                        ]
                    },
                    {
                        "description": "Date for which data is looked at. Use this in Tableau !",
                        "path": [
                            "REPORT_DATE"
                        ]
                    },
                    {
                        "description": "One of BUILD, ABS, WIP. Tells which of the aforementioned 3 does an meta_order_number belong to for a report_date",
                        "path": [
                            "TABLE_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars build for a REPORT_DATE, MODEL_ID, ASSY_LOC_ID combination",
                        "path": [
                            "BUILD_QTY"
                        ]
                    },
                    {
                        "description": "Why loss happened which caused delta against the plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_REASON"
                        ]
                    },
                    {
                        "description": "One of \"Supplier, Quality Production, MP&L, Facilities, Systems/IT, Launch, Other, Quality Holds, Special Cause\"",
                        "path": [
                            "LOSS_CATEGORY"
                        ]
                    },
                    {
                        "description": "Timestamp of when the loss entry was modified/created",
                        "path": [
                            "LOSS_MODIFIED_TIMESTAMP"
                        ]
                    },
                    {
                        "description": "Email of entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_EMAIL"
                        ]
                    },
                    {
                        "description": "Name of the entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_NAME"
                        ]
                    },
                    {
                        "description": "Number of cars away from plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_QTY"
                        ]
                    },
                    {
                        "description": "Date on which loss happened",
                        "path": [
                            "LOSS_DATE"
                        ]
                    },
                    {
                        "description": "BUILD or ABS",
                        "path": [
                            "LOSS_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars affected by the loss for a ASSY_LOC_ID, MODEL_ID combination",
                        "path": [
                            "AFFECTED_NUMBER"
                        ]
                    },
                    {
                        "description": "320_LOSS_COMMENTARY: When was the loss last modified in the Tableau/Power App/SharePoint List",
                        "path": [
                            "MODIFIED_AT"
                        ]
                    },
                    {
                        "description": "Description of the location where the event happened",
                        "path": [
                            "EVENT_LOC_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the record is archived in D42",
                        "path": [
                            "ARCHIVE_IND"
                        ]
                    },
                    {
                        "description": "Used to identify FLEET and OUV cars in D42",
                        "path": [
                            "ARCO_ID"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was Accepted by Sales(ABS). Check ABS_IND to know the current ABS status of the car as car can be ABSed multiple times",
                        "path": [
                            "ABS_DATE"
                        ]
                    },
                    {
                        "description": "Unique identifier for an event in D42",
                        "path": [
                            "EVEN_ID"
                        ]
                    },
                    {
                        "description": "Location id of where the event happened",
                        "path": [
                            "EVENT_LOC_ID"
                        ]
                    },
                    {
                        "description": "Description of the event",
                        "path": [
                            "EVENT_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Timestap of when the event was recorded in D42",
                        "path": [
                            "LAST_UPDATED"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if car is ('OUV', 'SDV') and built in China then it will not be included in ABS for China reporting and by lineage WIP",
                        "path": [
                            "CHINA_ABS_EXCLUSION_IND"
                        ]
                    },
                    {
                        "description": "Date of the saturday of the week for REPORT_DATE",
                        "path": [
                            "REPORT_DATE_SATURDAY"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "WEEK_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production week (saturday)",
                        "path": [
                            "PRODUCTION_WEEK_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production week (friday)",
                        "path": [
                            "PRODUCTION_WEEK_END"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "MONTH_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production month (saturday)",
                        "path": [
                            "PRODUCTION_MONTH_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production month (friday)",
                        "path": [
                            "PRODUCTION_MONTH_END"
                        ]
                    },
                    {
                        "description": "Indenfier for start of production month for Tableau. Is inferred from MONTH_PER_ID in 'yymm' format to 'yyyy-mm-01'",
                        "path": [
                            "PRODUCTION_MONTH_ID"
                        ]
                    }
                ]
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "DPRD_INDIA_BUILD_ABS_WIP_PLAN_ACTUALS",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "0100_INDIA_ACTUALS",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "TABLE"
        },
        {
            "type": "table",
            "target": {
                "schema": "daily_production_report",
                "name": "0150_INDIA_ACTUALS",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\nSELECT\n  INDIA.FULL_VIN\n  , INDIA.ABS_IND\n  , INDIA.MODEL_ID\n  , INDIA.ASSY_LOC_ID\n  , INDIA.REPORT_DATE\n  , INDIA.TABLE_TYPE\n  , VISTA.MODEL_YEAR_DESC\n  , VISTA.SALES_MODEL_DESC\n  , VISTA.ENGINE_FAMILY\n  , VISTA.DPCK_CODE\n  , VISTA.TRIM_SPEC\n  , VISTA.FUEL_TYPE\n  , VISTA.GLOBAL_SALES_CHANNEL_DESC\n  , VISTA.REGION\n  , VISTA.MARKET\n  , VISTA.ORDER_NUMBER AS META_ORDER_NUMBER\n  , FALSE              AS CHINA_ABS_EXCLUSION_IND\n  , STRING(NULL)       AS DEST_REGION\n  , STRING(NULL)       AS DEST_MARKET\n  , STRING(NULL)       AS SVO_IND\n\nFROM `jlr-it-scanalytics-dev.daily_production_report.0100_INDIA_ACTUALS` AS INDIA\n\nLEFT JOIN `jlr-it-scanalytics-prod.vista_metadata_access.0500_VISTA_ORDER_METADATA` AS VISTA ON INDIA.FULL_VIN = VISTA.VIN\n\n",
            "disabled": false,
            "fileName": "definitions/intermediate/0150_INDIA_ACTUALS.sqlx",
            "tags": [
                "DPR",
                "INDIA_ACTUALS"
            ],
            "actionDescriptor": {
                "description": "Joining INDIA ACTUALS data with VISTA data to give complete table which can be joined to DPR",
                "columns": [
                    {
                        "description": "Unique identifier for a car in D42",
                        "path": [
                            "VEH_ID"
                        ]
                    },
                    {
                        "description": "Unique identifier for base hold",
                        "path": [
                            "HOLD_BASE_ID"
                        ]
                    },
                    {
                        "description": "Base hold description",
                        "path": [
                            "HOLD_BASE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold type",
                        "path": [
                            "HOLD_TYPE_ID"
                        ]
                    },
                    {
                        "description": "Hold type description",
                        "path": [
                            "HOLD_TYPE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold group",
                        "path": [
                            "HOLD_GROUP_ID"
                        ]
                    },
                    {
                        "description": "Hold group description",
                        "path": [
                            "HOLD_GROUP_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Start date of hold",
                        "path": [
                            "HOLD_START_DATE"
                        ]
                    },
                    {
                        "description": "End date of hold",
                        "path": [
                            "HOLD_END_DATE"
                        ]
                    },
                    {
                        "description": "Reason for removing hold, if exisists",
                        "path": [
                            "HOLD_REMOVAL_REASON"
                        ]
                    },
                    {
                        "description": "Unique identifier for car in VISTA",
                        "path": [
                            "META_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Short vin",
                        "path": [
                            "SHORT_VIN"
                        ]
                    },
                    {
                        "description": "Full vin - cars in allocation will not have a VIN",
                        "path": [
                            "FULL_VIN"
                        ]
                    },
                    {
                        "description": "Unique identifier for an order in PLO",
                        "path": [
                            "SPECIFIC_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Identifier in MES",
                        "path": [
                            "CSO_NUMBER"
                        ]
                    },
                    {
                        "description": "Model description e.g L460 - Range Rover",
                        "path": [
                            "MODEL_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Location id of where car was assembled",
                        "path": [
                            "ASSY_LOC_ID"
                        ]
                    },
                    {
                        "description": "Name of the plant where car was build",
                        "path": [
                            "PLANT_NAME"
                        ]
                    },
                    {
                        "description": "Unique identifier for a dealer",
                        "path": [
                            "DEAL_ID"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was sent to a scrapped cars dealer",
                        "path": [
                            "VEHICLE_SCRAPPED"
                        ]
                    },
                    {
                        "description": "Indicator for cars which are assembled in other plants & shipped to India",
                        "path": [
                            "KD_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when a car was built",
                        "path": [
                            "OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car was ABSed. Note that a car can be ABSed multiple times",
                        "path": [
                            "ABS_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Accepted by Sales(ABS)",
                        "path": [
                            "FIRST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was last Accepted by Sales(ABS)",
                        "path": [
                            "LATEST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was Ready for Sales(RFS)",
                        "path": [
                            "RFS_IND"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car is a special vehicle",
                        "path": [
                            "SVO_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "FIRST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "LATEST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. If a hold is not an SVO hold it will be False",
                        "path": [
                            "_SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. All rows for an order will be true if it had SVO hold when RFSed",
                        "path": [
                            "SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "Off assembly timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Latest ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "LATEST_ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Fuel type from VISTA",
                        "path": [
                            "FUEL_TYPE"
                        ]
                    },
                    {
                        "description": "Sales channel - VISTA. e.g. Private, Fleet & Business",
                        "path": [
                            "GLOBAL_SALES_CHANNEL_DESC"
                        ]
                    },
                    {
                        "description": "Model year - VISTA ( e.g. 24MY)",
                        "path": [
                            "MODEL_YEAR_DESC"
                        ]
                    },
                    {
                        "description": "4 letter model id derived from model_description e.g. L460",
                        "path": [
                            "MODEL_ID"
                        ]
                    },
                    {
                        "description": "Adjusted_offassy_time timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_OFFASSY"
                        ]
                    },
                    {
                        "description": "Adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_ABS"
                        ]
                    },
                    {
                        "description": "Latest_adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_LATEST_ABS"
                        ]
                    },
                    {
                        "description": "Marktet for which the car is made for. Europe",
                        "path": [
                            "DEST_REGION"
                        ]
                    },
                    {
                        "description": "Region of the market for which the car is made for. e.g Italy",
                        "path": [
                            "DEST_MARKET"
                        ]
                    },
                    {
                        "description": "Brochure Model Code. e.g AJ460",
                        "path": [
                            "BMC"
                        ]
                    },
                    {
                        "description": "E.g. 2.0L Diesel I4",
                        "path": [
                            "ENGINE_FAMILY"
                        ]
                    },
                    {
                        "description": "E.g. 260JZ",
                        "path": [
                            "DPCK_CODE"
                        ]
                    },
                    {
                        "description": "E.g. SE/HSE",
                        "path": [
                            "TRIM_SPEC"
                        ]
                    },
                    {
                        "description": "Date at which WIP data needs to be looked at",
                        "path": [
                            "WIP_REPORT_DAY"
                        ]
                    },
                    {
                        "description": "Boolean used to identify if the plant was operational on the Day. Not production days are not counted in WIP age.",
                        "path": [
                            "PRODUCTION_DAY"
                        ]
                    },
                    {
                        "description": "Sudo column w/t value that is used for calculating",
                        "path": [
                            "WIP_COUNTER"
                        ]
                    },
                    {
                        "description": "Number of days car has been in WIP on a given reporting day",
                        "path": [
                            "WIP_AGE"
                        ]
                    },
                    {
                        "description": "Maximum WIP age for a given plant-model combination",
                        "path": [
                            "MAX_WIP_AGE_PLANT_MODEL"
                        ]
                    },
                    {
                        "description": "Plan / target corrosponding to table_type",
                        "path": [
                            "PLAN"
                        ]
                    },
                    {
                        "description": "Date for which data is looked at. Use this in Tableau !",
                        "path": [
                            "REPORT_DATE"
                        ]
                    },
                    {
                        "description": "One of BUILD, ABS, WIP. Tells which of the aforementioned 3 does an meta_order_number belong to for a report_date",
                        "path": [
                            "TABLE_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars build for a REPORT_DATE, MODEL_ID, ASSY_LOC_ID combination",
                        "path": [
                            "BUILD_QTY"
                        ]
                    },
                    {
                        "description": "Why loss happened which caused delta against the plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_REASON"
                        ]
                    },
                    {
                        "description": "One of \"Supplier, Quality Production, MP&L, Facilities, Systems/IT, Launch, Other, Quality Holds, Special Cause\"",
                        "path": [
                            "LOSS_CATEGORY"
                        ]
                    },
                    {
                        "description": "Timestamp of when the loss entry was modified/created",
                        "path": [
                            "LOSS_MODIFIED_TIMESTAMP"
                        ]
                    },
                    {
                        "description": "Email of entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_EMAIL"
                        ]
                    },
                    {
                        "description": "Name of the entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_NAME"
                        ]
                    },
                    {
                        "description": "Number of cars away from plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_QTY"
                        ]
                    },
                    {
                        "description": "Date on which loss happened",
                        "path": [
                            "LOSS_DATE"
                        ]
                    },
                    {
                        "description": "BUILD or ABS",
                        "path": [
                            "LOSS_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars affected by the loss for a ASSY_LOC_ID, MODEL_ID combination",
                        "path": [
                            "AFFECTED_NUMBER"
                        ]
                    },
                    {
                        "description": "320_LOSS_COMMENTARY: When was the loss last modified in the Tableau/Power App/SharePoint List",
                        "path": [
                            "MODIFIED_AT"
                        ]
                    },
                    {
                        "description": "Description of the location where the event happened",
                        "path": [
                            "EVENT_LOC_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the record is archived in D42",
                        "path": [
                            "ARCHIVE_IND"
                        ]
                    },
                    {
                        "description": "Used to identify FLEET and OUV cars in D42",
                        "path": [
                            "ARCO_ID"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was Accepted by Sales(ABS). Check ABS_IND to know the current ABS status of the car as car can be ABSed multiple times",
                        "path": [
                            "ABS_DATE"
                        ]
                    },
                    {
                        "description": "Unique identifier for an event in D42",
                        "path": [
                            "EVEN_ID"
                        ]
                    },
                    {
                        "description": "Location id of where the event happened",
                        "path": [
                            "EVENT_LOC_ID"
                        ]
                    },
                    {
                        "description": "Description of the event",
                        "path": [
                            "EVENT_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Timestap of when the event was recorded in D42",
                        "path": [
                            "LAST_UPDATED"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if car is ('OUV', 'SDV') and built in China then it will not be included in ABS for China reporting and by lineage WIP",
                        "path": [
                            "CHINA_ABS_EXCLUSION_IND"
                        ]
                    },
                    {
                        "description": "Date of the saturday of the week for REPORT_DATE",
                        "path": [
                            "REPORT_DATE_SATURDAY"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "WEEK_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production week (saturday)",
                        "path": [
                            "PRODUCTION_WEEK_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production week (friday)",
                        "path": [
                            "PRODUCTION_WEEK_END"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "MONTH_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production month (saturday)",
                        "path": [
                            "PRODUCTION_MONTH_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production month (friday)",
                        "path": [
                            "PRODUCTION_MONTH_END"
                        ]
                    },
                    {
                        "description": "Indenfier for start of production month for Tableau. Is inferred from MONTH_PER_ID in 'yymm' format to 'yyyy-mm-01'",
                        "path": [
                            "PRODUCTION_MONTH_ID"
                        ]
                    }
                ]
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "0100_INDIA_ACTUALS",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "vista_metadata_access",
                    "name": "0500_VISTA_ORDER_METADATA",
                    "database": "jlr-it-scanalytics-prod"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "0150_INDIA_ACTUALS",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "TABLE"
        },
        {
            "type": "table",
            "target": {
                "schema": "daily_production_report",
                "name": "0300_PRODUCTION_DATA_DPR",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\nWITH D42_DATA AS (\n  SELECT *\n  FROM `jlr-it-scanalytics-prod.daily_production_report.0100_DPR_D42_META_DATA_FLAT`\n)\n\n, PRODUCTION_METADATA AS (\n  SELECT\n    D.META_ORDER_NUMBER\n    , D.VEH_ID\n    , D.FULL_VIN\n    , D.CSO_NUMBER\n    , D.ARCO_ID\n    , D.VEHICLE_SCRAPPED\n    , D.CHINA_ABS_EXCLUSION_IND\n    , D.KD_IND\n    , D.ABS_IND\n    , D.SVO_IND\n    , D.FIRST_ABS_DATE\n    , D.LATEST_ABS_DATE\n    , D.FIRST_RFS_DATE\n    , D.LATEST_RFS_DATE\n    , D.OFFASSY_DATETIME\n    ---- s/o OFFASY_TIME ----\n    , CASE\n      WHEN D.ASSY_LOC_ID IN ('NTP') THEN TIMESTAMP(DATETIME(TIMESTAMP(OFFASSY_DATETIME), 'CET'))\n      WHEN D.ASSY_LOC_ID IN ('CHP') THEN TIMESTAMP_ADD(TIMESTAMP(D.OFFASSY_DATETIME), INTERVAL 8 HOUR)\n      ELSE TIMESTAMP(D.OFFASSY_DATETIME, 'UTC')\n    END          AS ADJUSTED_OFFASSY_TIME\n    ---- e/o OFFASY_TIME ----\n    ---- s/o ABS ----\n    , CASE\n      WHEN D.ASSY_LOC_ID IN ('NTP') THEN TIMESTAMP_ADD(TIMESTAMP(D.FIRST_ABS_DATE), INTERVAL 1 HOUR)\n      WHEN D.ASSY_LOC_ID IN ('CHP') THEN TIMESTAMP_ADD(TIMESTAMP(D.FIRST_ABS_DATE), INTERVAL 8 HOUR)\n      WHEN SVO_IND = 'Y' AND SVO_HOLD_WHEN_RFSED THEN TIMESTAMP(D.FIRST_RFS_DATE)\n      WHEN SVO_IND = 'Y' AND NOT SVO_HOLD_WHEN_RFSED THEN TIMESTAMP(D.FIRST_ABS_DATE)\n      ELSE TIMESTAMP(D.FIRST_ABS_DATE, 'UTC')\n    END\n      AS ADJUSTED_ABS_DATE\n      ---- e/o ABS ----\n      ---- s/o latest ABS ----\n    , CASE\n      WHEN D.ASSY_LOC_ID IN ('NTP') THEN TIMESTAMP_ADD(TIMESTAMP(D.LATEST_ABS_DATE), INTERVAL 1 HOUR)\n      WHEN D.ASSY_LOC_ID IN ('CHP') THEN TIMESTAMP_ADD(TIMESTAMP(D.LATEST_ABS_DATE), INTERVAL 8 HOUR)\n      WHEN SVO_IND = 'Y' AND SVO_HOLD_WHEN_RFSED THEN TIMESTAMP(D.LATEST_RFS_DATE)\n      WHEN SVO_IND = 'Y' AND NOT SVO_HOLD_WHEN_RFSED THEN TIMESTAMP(D.LATEST_ABS_DATE)\n      ELSE TIMESTAMP(D.LATEST_ABS_DATE, 'UTC')\n    END\n      AS LATEST_ADJUSTED_ABS_DATE\n    ---- e/o latest ABS  ----\n    , D.ASSY_LOC_ID\n    , D.MODEL_ID\n    , D.MODEL_DESCRIPTION\n    , D.FUEL_TYPE\n    , D.GLOBAL_SALES_CHANNEL_DESC\n    , D.MODEL_YEAR_DESC\n    , D.SALES_MODEL_DESC\n    , D.DEST_REGION\n    , D.DEST_MARKET\n    , D.BMC_CODE AS BMC\n    , D.ENGINE_FAMILY\n    , D.DPCK_CODE\n    , D.TRIM_SPEC\n  FROM D42_DATA AS D\n)\n\n, ADJUSTED_PRODUCTION_DATA AS (\n  /*  Adjust the production numbers to align with production hours */\n  SELECT\n    *\n    -- 6am to 6am built reporting hours\n    , DATE(TIMESTAMP_SUB(TIMESTAMP(ADJUSTED_OFFASSY_TIME), INTERVAL IF(EXTRACT(HOUR FROM ADJUSTED_OFFASSY_TIME) >= 6, 6, 18) HOUR))       AS ADJUSTED_REPORT_DATE_OFFASSY\n    , CASE\n      -- 7am to 7am shift in 'HWP'\n      WHEN ASSY_LOC_ID IN ('HWP') AND ADJUSTED_ABS_DATE > '2023-12-31' THEN DATE(TIMESTAMP_SUB(TIMESTAMP(ADJUSTED_ABS_DATE), INTERVAL IF(EXTRACT(HOUR FROM ADJUSTED_ABS_DATE) >= 6, 6, 18) HOUR))\n      WHEN ASSY_LOC_ID IN ('HWP') THEN DATE(TIMESTAMP_SUB(TIMESTAMP(ADJUSTED_ABS_DATE), INTERVAL IF(EXTRACT(HOUR FROM ADJUSTED_ABS_DATE) >= 7, 7, 18) HOUR))\n      -- All plants except NITRA stop counting ABSed cars after midnight on Friday\n      WHEN ASSY_LOC_ID != 'NTP'\n        AND EXTRACT(DAYOFWEEK FROM ADJUSTED_ABS_DATE) = 7\n        AND EXTRACT(HOUR FROM ADJUSTED_ABS_DATE) BETWEEN 0 AND 6\n      THEN DATE(ADJUSTED_ABS_DATE)\n      -- default to 6am to am reporting hours otherwise\n      ELSE DATE(TIMESTAMP_SUB(TIMESTAMP(ADJUSTED_ABS_DATE), INTERVAL IF(EXTRACT(HOUR FROM ADJUSTED_ABS_DATE) >= 6, 6, 18) HOUR))\n    END                                                                                                                                   AS ADJUSTED_REPORT_DATE_ABS\n    , DATE(TIMESTAMP_SUB(TIMESTAMP(LATEST_ADJUSTED_ABS_DATE), INTERVAL IF(EXTRACT(HOUR FROM LATEST_ADJUSTED_ABS_DATE) >= 6, 6, 18) HOUR)) AS ADJUSTED_REPORT_DATE_LATEST_ABS\n  FROM PRODUCTION_METADATA\n  WHERE 1 = 1\n    AND KD_IND = 'N'\n)\n\nSELECT *\nFROM ADJUSTED_PRODUCTION_DATA\n\n",
            "disabled": false,
            "fileName": "definitions/intermediate/0300_PRODUCTION_DATA_DPR.sqlx",
            "bigquery": {
                "clusterBy": [
                    "assy_loc_id"
                ]
            },
            "tags": [
                "DPR"
            ],
            "actionDescriptor": {
                "description": "Adds plant specific overlays to build, abs timestamps",
                "columns": [
                    {
                        "description": "Unique identifier for a car in D42",
                        "path": [
                            "VEH_ID"
                        ]
                    },
                    {
                        "description": "Unique identifier for base hold",
                        "path": [
                            "HOLD_BASE_ID"
                        ]
                    },
                    {
                        "description": "Base hold description",
                        "path": [
                            "HOLD_BASE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold type",
                        "path": [
                            "HOLD_TYPE_ID"
                        ]
                    },
                    {
                        "description": "Hold type description",
                        "path": [
                            "HOLD_TYPE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold group",
                        "path": [
                            "HOLD_GROUP_ID"
                        ]
                    },
                    {
                        "description": "Hold group description",
                        "path": [
                            "HOLD_GROUP_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Start date of hold",
                        "path": [
                            "HOLD_START_DATE"
                        ]
                    },
                    {
                        "description": "End date of hold",
                        "path": [
                            "HOLD_END_DATE"
                        ]
                    },
                    {
                        "description": "Reason for removing hold, if exisists",
                        "path": [
                            "HOLD_REMOVAL_REASON"
                        ]
                    },
                    {
                        "description": "Unique identifier for car in VISTA",
                        "path": [
                            "META_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Short vin",
                        "path": [
                            "SHORT_VIN"
                        ]
                    },
                    {
                        "description": "Full vin - cars in allocation will not have a VIN",
                        "path": [
                            "FULL_VIN"
                        ]
                    },
                    {
                        "description": "Unique identifier for an order in PLO",
                        "path": [
                            "SPECIFIC_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Identifier in MES",
                        "path": [
                            "CSO_NUMBER"
                        ]
                    },
                    {
                        "description": "Model description e.g L460 - Range Rover",
                        "path": [
                            "MODEL_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Location id of where car was assembled",
                        "path": [
                            "ASSY_LOC_ID"
                        ]
                    },
                    {
                        "description": "Name of the plant where car was build",
                        "path": [
                            "PLANT_NAME"
                        ]
                    },
                    {
                        "description": "Unique identifier for a dealer",
                        "path": [
                            "DEAL_ID"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was sent to a scrapped cars dealer",
                        "path": [
                            "VEHICLE_SCRAPPED"
                        ]
                    },
                    {
                        "description": "Indicator for cars which are assembled in other plants & shipped to India",
                        "path": [
                            "KD_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when a car was built",
                        "path": [
                            "OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car was ABSed. Note that a car can be ABSed multiple times",
                        "path": [
                            "ABS_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Accepted by Sales(ABS)",
                        "path": [
                            "FIRST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was last Accepted by Sales(ABS)",
                        "path": [
                            "LATEST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was Ready for Sales(RFS)",
                        "path": [
                            "RFS_IND"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car is a special vehicle",
                        "path": [
                            "SVO_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "FIRST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "LATEST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. If a hold is not an SVO hold it will be False",
                        "path": [
                            "_SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. All rows for an order will be true if it had SVO hold when RFSed",
                        "path": [
                            "SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "Off assembly timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Latest ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "LATEST_ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Fuel type from VISTA",
                        "path": [
                            "FUEL_TYPE"
                        ]
                    },
                    {
                        "description": "Sales channel - VISTA. e.g. Private, Fleet & Business",
                        "path": [
                            "GLOBAL_SALES_CHANNEL_DESC"
                        ]
                    },
                    {
                        "description": "Model year - VISTA ( e.g. 24MY)",
                        "path": [
                            "MODEL_YEAR_DESC"
                        ]
                    },
                    {
                        "description": "4 letter model id derived from model_description e.g. L460",
                        "path": [
                            "MODEL_ID"
                        ]
                    },
                    {
                        "description": "Adjusted_offassy_time timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_OFFASSY"
                        ]
                    },
                    {
                        "description": "Adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_ABS"
                        ]
                    },
                    {
                        "description": "Latest_adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_LATEST_ABS"
                        ]
                    },
                    {
                        "description": "Marktet for which the car is made for. Europe",
                        "path": [
                            "DEST_REGION"
                        ]
                    },
                    {
                        "description": "Region of the market for which the car is made for. e.g Italy",
                        "path": [
                            "DEST_MARKET"
                        ]
                    },
                    {
                        "description": "Brochure Model Code. e.g AJ460",
                        "path": [
                            "BMC"
                        ]
                    },
                    {
                        "description": "E.g. 2.0L Diesel I4",
                        "path": [
                            "ENGINE_FAMILY"
                        ]
                    },
                    {
                        "description": "E.g. 260JZ",
                        "path": [
                            "DPCK_CODE"
                        ]
                    },
                    {
                        "description": "E.g. SE/HSE",
                        "path": [
                            "TRIM_SPEC"
                        ]
                    },
                    {
                        "description": "Date at which WIP data needs to be looked at",
                        "path": [
                            "WIP_REPORT_DAY"
                        ]
                    },
                    {
                        "description": "Boolean used to identify if the plant was operational on the Day. Not production days are not counted in WIP age.",
                        "path": [
                            "PRODUCTION_DAY"
                        ]
                    },
                    {
                        "description": "Sudo column w/t value that is used for calculating",
                        "path": [
                            "WIP_COUNTER"
                        ]
                    },
                    {
                        "description": "Number of days car has been in WIP on a given reporting day",
                        "path": [
                            "WIP_AGE"
                        ]
                    },
                    {
                        "description": "Maximum WIP age for a given plant-model combination",
                        "path": [
                            "MAX_WIP_AGE_PLANT_MODEL"
                        ]
                    },
                    {
                        "description": "Plan / target corrosponding to table_type",
                        "path": [
                            "PLAN"
                        ]
                    },
                    {
                        "description": "Date for which data is looked at. Use this in Tableau !",
                        "path": [
                            "REPORT_DATE"
                        ]
                    },
                    {
                        "description": "One of BUILD, ABS, WIP. Tells which of the aforementioned 3 does an meta_order_number belong to for a report_date",
                        "path": [
                            "TABLE_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars build for a REPORT_DATE, MODEL_ID, ASSY_LOC_ID combination",
                        "path": [
                            "BUILD_QTY"
                        ]
                    },
                    {
                        "description": "Why loss happened which caused delta against the plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_REASON"
                        ]
                    },
                    {
                        "description": "One of \"Supplier, Quality Production, MP&L, Facilities, Systems/IT, Launch, Other, Quality Holds, Special Cause\"",
                        "path": [
                            "LOSS_CATEGORY"
                        ]
                    },
                    {
                        "description": "Timestamp of when the loss entry was modified/created",
                        "path": [
                            "LOSS_MODIFIED_TIMESTAMP"
                        ]
                    },
                    {
                        "description": "Email of entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_EMAIL"
                        ]
                    },
                    {
                        "description": "Name of the entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_NAME"
                        ]
                    },
                    {
                        "description": "Number of cars away from plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_QTY"
                        ]
                    },
                    {
                        "description": "Date on which loss happened",
                        "path": [
                            "LOSS_DATE"
                        ]
                    },
                    {
                        "description": "BUILD or ABS",
                        "path": [
                            "LOSS_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars affected by the loss for a ASSY_LOC_ID, MODEL_ID combination",
                        "path": [
                            "AFFECTED_NUMBER"
                        ]
                    },
                    {
                        "description": "320_LOSS_COMMENTARY: When was the loss last modified in the Tableau/Power App/SharePoint List",
                        "path": [
                            "MODIFIED_AT"
                        ]
                    },
                    {
                        "description": "Description of the location where the event happened",
                        "path": [
                            "EVENT_LOC_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the record is archived in D42",
                        "path": [
                            "ARCHIVE_IND"
                        ]
                    },
                    {
                        "description": "Used to identify FLEET and OUV cars in D42",
                        "path": [
                            "ARCO_ID"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was Accepted by Sales(ABS). Check ABS_IND to know the current ABS status of the car as car can be ABSed multiple times",
                        "path": [
                            "ABS_DATE"
                        ]
                    },
                    {
                        "description": "Unique identifier for an event in D42",
                        "path": [
                            "EVEN_ID"
                        ]
                    },
                    {
                        "description": "Location id of where the event happened",
                        "path": [
                            "EVENT_LOC_ID"
                        ]
                    },
                    {
                        "description": "Description of the event",
                        "path": [
                            "EVENT_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Timestap of when the event was recorded in D42",
                        "path": [
                            "LAST_UPDATED"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if car is ('OUV', 'SDV') and built in China then it will not be included in ABS for China reporting and by lineage WIP",
                        "path": [
                            "CHINA_ABS_EXCLUSION_IND"
                        ]
                    },
                    {
                        "description": "Date of the saturday of the week for REPORT_DATE",
                        "path": [
                            "REPORT_DATE_SATURDAY"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "WEEK_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production week (saturday)",
                        "path": [
                            "PRODUCTION_WEEK_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production week (friday)",
                        "path": [
                            "PRODUCTION_WEEK_END"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "MONTH_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production month (saturday)",
                        "path": [
                            "PRODUCTION_MONTH_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production month (friday)",
                        "path": [
                            "PRODUCTION_MONTH_END"
                        ]
                    },
                    {
                        "description": "Indenfier for start of production month for Tableau. Is inferred from MONTH_PER_ID in 'yymm' format to 'yyyy-mm-01'",
                        "path": [
                            "PRODUCTION_MONTH_ID"
                        ]
                    }
                ]
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report_assertions",
                    "name": "ASSER_CHECK_D42_SOURCE_FROM_ORDER_PROCESSING",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "0100_DPR_D42_META_DATA_FLAT",
                    "database": "jlr-it-scanalytics-prod"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "0300_PRODUCTION_DATA_DPR",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "TABLE"
        },
        {
            "type": "table",
            "target": {
                "schema": "daily_production_report",
                "name": "0400_WIP_HISTORY",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\nWITH\n\nORDERS_NOT_ABSED_ON_OFFASSY_DAY AS (\n  SELECT * FROM\n    `jlr-it-scanalytics-dev.daily_production_report.0300_PRODUCTION_DATA_DPR`\n  WHERE 1 = 1\n    AND NOT VEHICLE_SCRAPPED\n    AND NOT CHINA_ABS_EXCLUSION_IND\n    AND (\n      (ADJUSTED_REPORT_DATE_OFFASSY != ADJUSTED_REPORT_DATE_ABS)  -- SAME DAY BUILT & ABS IS NOT WIP\n      OR ADJUSTED_REPORT_DATE_ABS IS NULL\n    )\n)\n\n, PLANT_SHUT_DOWN_DAYS AS (\n  SELECT * FROM `jlr-it-scanalytics-dev.daily_production_report.050_SHUTDOWN_DAYS`\n)\n\n, WIP_COUNTER_TABLE AS (\n  SELECT\n    META_ORDER_NUMBER\n    , VEH_ID\n    , FULL_VIN\n    , ABS_IND\n    , MODEL_ID\n    , MODEL_YEAR_DESC\n    , SALES_MODEL_DESC\n    , ENGINE_FAMILY\n    , DPCK_CODE\n    , TRIM_SPEC\n    , FUEL_TYPE\n    , GLOBAL_SALES_CHANNEL_DESC\n    , DEST_REGION\n    , DEST_MARKET\n    , SVO_IND\n    , ASSY_LOC_ID\n    , ADJUSTED_REPORT_DATE_OFFASSY\n    , ADJUSTED_REPORT_DATE_ABS\n    , WIP_REPORT_DAY\n    , 1 AS WIP_COUNTER\n  FROM\n    ORDERS_NOT_ABSED_ON_OFFASSY_DAY\n  , UNNEST(GENERATE_DATE_ARRAY(\n    ADJUSTED_REPORT_DATE_OFFASSY\n    , COALESCE(\n      DATE_SUB(ADJUSTED_REPORT_DATE_ABS, INTERVAL 1 DAY)\n      , DATE_SUB(CURRENT_DATE() + 1, INTERVAL 1 DAY)\n    )\n  )) AS WIP_REPORT_DAY\n)\n\n, PLANT_SHUTDOWN_ON_WIP_DAY AS ( -- ASSIGN SHUTDOWN DATE TO A WIP DAY IF THE PLANT WAS SHUTDOWN ON THAT DAY\n  SELECT\n    W.*\n    , P.SHUTDOWN_DATE\n  FROM WIP_COUNTER_TABLE AS W\n  LEFT JOIN PLANT_SHUT_DOWN_DAYS AS P\n    ON W.ASSY_LOC_ID = P.ASSY_LOC_ID\n    AND W.WIP_REPORT_DAY = P.SHUTDOWN_DATE\n)\n\n, PLANT_SHUTDOWN_FLAG_WIP_DAY AS ( -- WEEKENDS AND NON-PRODUCTIONS DAYS NOT COUNTED FOR WIP_AGE\n  SELECT\n    *\n    , CASE\n      WHEN EXTRACT(DAYOFWEEK FROM WIP_REPORT_DAY) IN (1, 7) OR SHUTDOWN_DATE IS NOT NULL THEN 0\n      ELSE 1\n    END                                                                                                  AS WIP_AGE_COUNTER\n    , NOT COALESCE(EXTRACT(DAYOFWEEK FROM WIP_REPORT_DAY) IN (1, 7) OR SHUTDOWN_DATE IS NOT NULL, FALSE) AS PRODUCTION_DAY\n  FROM PLANT_SHUTDOWN_ON_WIP_DAY\n)\n\n, WIP_COUNTER_AGE_TABLE AS (\n  SELECT\n    META_ORDER_NUMBER\n    , VEH_ID\n    , FULL_VIN\n    , ABS_IND\n    , MODEL_ID\n    , MODEL_YEAR_DESC\n    , SALES_MODEL_DESC\n    , ENGINE_FAMILY\n    , DPCK_CODE\n    , TRIM_SPEC\n    , FUEL_TYPE\n    , GLOBAL_SALES_CHANNEL_DESC\n    , DEST_REGION\n    , DEST_MARKET\n    , SVO_IND\n    , ASSY_LOC_ID\n    , ADJUSTED_REPORT_DATE_OFFASSY\n    , ADJUSTED_REPORT_DATE_ABS\n    , WIP_REPORT_DAY\n    , PRODUCTION_DAY\n    , WIP_COUNTER\n    , SUM(WIP_AGE_COUNTER) OVER (PARTITION BY META_ORDER_NUMBER ORDER BY WIP_REPORT_DAY) AS WIP_AGE\n  FROM PLANT_SHUTDOWN_FLAG_WIP_DAY\n)\n\n, FINAL_WIP_HISTORY_RAW AS (\n  SELECT\n    *\n    , MAX(WIP_AGE) OVER (PLANT_MODEL) AS MAX_WIP_AGE_PLANT_MODEL\n  -- CAST(PERCENTILE_CONT(WIP_AGE, 0.1) OVER(PLANT_MODEL) AS INT) AS WIP_AGE_10_PERCENTILE,\n  -- CAST(PERCENTILE_CONT(WIP_AGE, 0.5) OVER(PLANT_MODEL) AS INT) AS MEDIAN_WIP_AGE,\n  -- CAST(PERCENTILE_CONT(WIP_AGE, 0.9) OVER(PLANT_MODEL) AS INT) AS WIP_AGE_90_PERCENTILE\n  FROM WIP_COUNTER_AGE_TABLE\n  WINDOW PLANT_MODEL AS (PARTITION BY ASSY_LOC_ID, MODEL_ID)\n)\n\nSELECT * FROM FINAL_WIP_HISTORY_RAW\n-- WHERE 1=1\n-- AND WIP_REPORT_DAY = '2023-05-03'\n-- AND ASSY_LOC_ID = 'SLP'\n-- AND ORDER_NUMBER = 17189667\n-- ORDER BY WIP_REPORT_DAY\n-- AND EXTRACT(YEAR FROM WIP_REPORT_DAY) = 2023\n-- AND EXTRACT(MONTH FROM WIP_REPORT_DAY) = 5\n\n",
            "disabled": false,
            "fileName": "definitions/intermediate/0400_WIP_HISTORY.sqlx",
            "bigquery": {
                "partitionBy": "wip_report_day",
                "clusterBy": [
                    "assy_loc_id"
                ]
            },
            "tags": [
                "DPR",
                "WIP"
            ],
            "actionDescriptor": {
                "description": "WIP history for all reporting days in the last year",
                "columns": [
                    {
                        "description": "Unique identifier for a car in D42",
                        "path": [
                            "VEH_ID"
                        ]
                    },
                    {
                        "description": "Unique identifier for base hold",
                        "path": [
                            "HOLD_BASE_ID"
                        ]
                    },
                    {
                        "description": "Base hold description",
                        "path": [
                            "HOLD_BASE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold type",
                        "path": [
                            "HOLD_TYPE_ID"
                        ]
                    },
                    {
                        "description": "Hold type description",
                        "path": [
                            "HOLD_TYPE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold group",
                        "path": [
                            "HOLD_GROUP_ID"
                        ]
                    },
                    {
                        "description": "Hold group description",
                        "path": [
                            "HOLD_GROUP_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Start date of hold",
                        "path": [
                            "HOLD_START_DATE"
                        ]
                    },
                    {
                        "description": "End date of hold",
                        "path": [
                            "HOLD_END_DATE"
                        ]
                    },
                    {
                        "description": "Reason for removing hold, if exisists",
                        "path": [
                            "HOLD_REMOVAL_REASON"
                        ]
                    },
                    {
                        "description": "Unique identifier for car in VISTA",
                        "path": [
                            "META_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Short vin",
                        "path": [
                            "SHORT_VIN"
                        ]
                    },
                    {
                        "description": "Full vin - cars in allocation will not have a VIN",
                        "path": [
                            "FULL_VIN"
                        ]
                    },
                    {
                        "description": "Unique identifier for an order in PLO",
                        "path": [
                            "SPECIFIC_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Identifier in MES",
                        "path": [
                            "CSO_NUMBER"
                        ]
                    },
                    {
                        "description": "Model description e.g L460 - Range Rover",
                        "path": [
                            "MODEL_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Location id of where car was assembled",
                        "path": [
                            "ASSY_LOC_ID"
                        ]
                    },
                    {
                        "description": "Name of the plant where car was build",
                        "path": [
                            "PLANT_NAME"
                        ]
                    },
                    {
                        "description": "Unique identifier for a dealer",
                        "path": [
                            "DEAL_ID"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was sent to a scrapped cars dealer",
                        "path": [
                            "VEHICLE_SCRAPPED"
                        ]
                    },
                    {
                        "description": "Indicator for cars which are assembled in other plants & shipped to India",
                        "path": [
                            "KD_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when a car was built",
                        "path": [
                            "OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car was ABSed. Note that a car can be ABSed multiple times",
                        "path": [
                            "ABS_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Accepted by Sales(ABS)",
                        "path": [
                            "FIRST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was last Accepted by Sales(ABS)",
                        "path": [
                            "LATEST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was Ready for Sales(RFS)",
                        "path": [
                            "RFS_IND"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car is a special vehicle",
                        "path": [
                            "SVO_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "FIRST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "LATEST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. If a hold is not an SVO hold it will be False",
                        "path": [
                            "_SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. All rows for an order will be true if it had SVO hold when RFSed",
                        "path": [
                            "SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "Off assembly timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Latest ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "LATEST_ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Fuel type from VISTA",
                        "path": [
                            "FUEL_TYPE"
                        ]
                    },
                    {
                        "description": "Sales channel - VISTA. e.g. Private, Fleet & Business",
                        "path": [
                            "GLOBAL_SALES_CHANNEL_DESC"
                        ]
                    },
                    {
                        "description": "Model year - VISTA ( e.g. 24MY)",
                        "path": [
                            "MODEL_YEAR_DESC"
                        ]
                    },
                    {
                        "description": "4 letter model id derived from model_description e.g. L460",
                        "path": [
                            "MODEL_ID"
                        ]
                    },
                    {
                        "description": "Adjusted_offassy_time timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_OFFASSY"
                        ]
                    },
                    {
                        "description": "Adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_ABS"
                        ]
                    },
                    {
                        "description": "Latest_adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_LATEST_ABS"
                        ]
                    },
                    {
                        "description": "Marktet for which the car is made for. Europe",
                        "path": [
                            "DEST_REGION"
                        ]
                    },
                    {
                        "description": "Region of the market for which the car is made for. e.g Italy",
                        "path": [
                            "DEST_MARKET"
                        ]
                    },
                    {
                        "description": "Brochure Model Code. e.g AJ460",
                        "path": [
                            "BMC"
                        ]
                    },
                    {
                        "description": "E.g. 2.0L Diesel I4",
                        "path": [
                            "ENGINE_FAMILY"
                        ]
                    },
                    {
                        "description": "E.g. 260JZ",
                        "path": [
                            "DPCK_CODE"
                        ]
                    },
                    {
                        "description": "E.g. SE/HSE",
                        "path": [
                            "TRIM_SPEC"
                        ]
                    },
                    {
                        "description": "Date at which WIP data needs to be looked at",
                        "path": [
                            "WIP_REPORT_DAY"
                        ]
                    },
                    {
                        "description": "Boolean used to identify if the plant was operational on the Day. Not production days are not counted in WIP age.",
                        "path": [
                            "PRODUCTION_DAY"
                        ]
                    },
                    {
                        "description": "Sudo column w/t value that is used for calculating",
                        "path": [
                            "WIP_COUNTER"
                        ]
                    },
                    {
                        "description": "Number of days car has been in WIP on a given reporting day",
                        "path": [
                            "WIP_AGE"
                        ]
                    },
                    {
                        "description": "Maximum WIP age for a given plant-model combination",
                        "path": [
                            "MAX_WIP_AGE_PLANT_MODEL"
                        ]
                    },
                    {
                        "description": "Plan / target corrosponding to table_type",
                        "path": [
                            "PLAN"
                        ]
                    },
                    {
                        "description": "Date for which data is looked at. Use this in Tableau !",
                        "path": [
                            "REPORT_DATE"
                        ]
                    },
                    {
                        "description": "One of BUILD, ABS, WIP. Tells which of the aforementioned 3 does an meta_order_number belong to for a report_date",
                        "path": [
                            "TABLE_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars build for a REPORT_DATE, MODEL_ID, ASSY_LOC_ID combination",
                        "path": [
                            "BUILD_QTY"
                        ]
                    },
                    {
                        "description": "Why loss happened which caused delta against the plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_REASON"
                        ]
                    },
                    {
                        "description": "One of \"Supplier, Quality Production, MP&L, Facilities, Systems/IT, Launch, Other, Quality Holds, Special Cause\"",
                        "path": [
                            "LOSS_CATEGORY"
                        ]
                    },
                    {
                        "description": "Timestamp of when the loss entry was modified/created",
                        "path": [
                            "LOSS_MODIFIED_TIMESTAMP"
                        ]
                    },
                    {
                        "description": "Email of entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_EMAIL"
                        ]
                    },
                    {
                        "description": "Name of the entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_NAME"
                        ]
                    },
                    {
                        "description": "Number of cars away from plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_QTY"
                        ]
                    },
                    {
                        "description": "Date on which loss happened",
                        "path": [
                            "LOSS_DATE"
                        ]
                    },
                    {
                        "description": "BUILD or ABS",
                        "path": [
                            "LOSS_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars affected by the loss for a ASSY_LOC_ID, MODEL_ID combination",
                        "path": [
                            "AFFECTED_NUMBER"
                        ]
                    },
                    {
                        "description": "320_LOSS_COMMENTARY: When was the loss last modified in the Tableau/Power App/SharePoint List",
                        "path": [
                            "MODIFIED_AT"
                        ]
                    },
                    {
                        "description": "Description of the location where the event happened",
                        "path": [
                            "EVENT_LOC_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the record is archived in D42",
                        "path": [
                            "ARCHIVE_IND"
                        ]
                    },
                    {
                        "description": "Used to identify FLEET and OUV cars in D42",
                        "path": [
                            "ARCO_ID"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was Accepted by Sales(ABS). Check ABS_IND to know the current ABS status of the car as car can be ABSed multiple times",
                        "path": [
                            "ABS_DATE"
                        ]
                    },
                    {
                        "description": "Unique identifier for an event in D42",
                        "path": [
                            "EVEN_ID"
                        ]
                    },
                    {
                        "description": "Location id of where the event happened",
                        "path": [
                            "EVENT_LOC_ID"
                        ]
                    },
                    {
                        "description": "Description of the event",
                        "path": [
                            "EVENT_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Timestap of when the event was recorded in D42",
                        "path": [
                            "LAST_UPDATED"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if car is ('OUV', 'SDV') and built in China then it will not be included in ABS for China reporting and by lineage WIP",
                        "path": [
                            "CHINA_ABS_EXCLUSION_IND"
                        ]
                    },
                    {
                        "description": "Date of the saturday of the week for REPORT_DATE",
                        "path": [
                            "REPORT_DATE_SATURDAY"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "WEEK_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production week (saturday)",
                        "path": [
                            "PRODUCTION_WEEK_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production week (friday)",
                        "path": [
                            "PRODUCTION_WEEK_END"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "MONTH_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production month (saturday)",
                        "path": [
                            "PRODUCTION_MONTH_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production month (friday)",
                        "path": [
                            "PRODUCTION_MONTH_END"
                        ]
                    },
                    {
                        "description": "Indenfier for start of production month for Tableau. Is inferred from MONTH_PER_ID in 'yymm' format to 'yyyy-mm-01'",
                        "path": [
                            "PRODUCTION_MONTH_ID"
                        ]
                    }
                ]
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "0300_PRODUCTION_DATA_DPR",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "050_SHUTDOWN_DAYS",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "0400_WIP_HISTORY",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "TABLE"
        },
        {
            "type": "table",
            "target": {
                "schema": "daily_production_report",
                "name": "0450_INDIA_WIP_HISTORY",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\nWITH INDIA_BUILD AS (\n  SELECT * FROM `jlr-it-scanalytics-dev.daily_production_report.0150_INDIA_ACTUALS`\n  WHERE TABLE_TYPE = 'BUILD'\n)\n\n, INDIA_ABS AS (\n  SELECT * FROM `jlr-it-scanalytics-dev.daily_production_report.0150_INDIA_ACTUALS`\n  WHERE TABLE_TYPE = 'ABS'\n)\n\n, ORDERS_NOT_ABSED_ON_OFFASSY_DAY AS (\n  SELECT\n    B.META_ORDER_NUMBER\n    , INT64(NULL)                      AS VEH_ID -- India actuals are not in D42\n    , COALESCE(B.FULL_VIN, A.FULL_VIN) AS FULL_VIN\n    , B.ABS_IND\n    , B.MODEL_ID\n    , B.MODEL_YEAR_DESC\n    , B.SALES_MODEL_DESC\n    , B.ENGINE_FAMILY\n    , B.DPCK_CODE\n    , B.TRIM_SPEC\n    , B.FUEL_TYPE\n    , B.GLOBAL_SALES_CHANNEL_DESC\n    , B.REGION\n    , B.MARKET\n    , B.SVO_IND\n    , B.ASSY_LOC_ID\n    , 1                                AS WIP_COUNTER\n    , B.REPORT_DATE                    AS ADJUSTED_REPORT_DATE_OFFASSY\n    , A.REPORT_DATE                    AS ADJUSTED_REPORT_DATE_ABS\n  FROM INDIA_BUILD AS B\n  LEFT JOIN\n    INDIA_ABS AS A\n    ON B.FULL_VIN = A.FULL_VIN\n)\n\n, PLANT_SHUT_DOWN_DAYS AS (\n  SELECT * FROM `jlr-it-scanalytics-dev.daily_production_report.050_SHUTDOWN_DAYS`\n)\n\n, WIP_COUNTER_TABLE AS (\n  SELECT\n    META_ORDER_NUMBER\n    , O.VEH_ID\n    , O.FULL_VIN\n    , O.ABS_IND\n    , O.MODEL_ID\n    , O.MODEL_YEAR_DESC\n    , O.SALES_MODEL_DESC\n    , O.ENGINE_FAMILY\n    , O.DPCK_CODE\n    , O.TRIM_SPEC\n    , O.FUEL_TYPE\n    , O.GLOBAL_SALES_CHANNEL_DESC\n    , O.REGION\n    , O.MARKET\n    , O.SVO_IND\n    , O.ASSY_LOC_ID\n    , ADJUSTED_REPORT_DATE_OFFASSY\n    , ADJUSTED_REPORT_DATE_ABS\n    , WIP_REPORT_DAY\n    , 1 AS WIP_COUNTER\n  FROM\n    ORDERS_NOT_ABSED_ON_OFFASSY_DAY AS O\n  , UNNEST(GENERATE_DATE_ARRAY(\n    ADJUSTED_REPORT_DATE_OFFASSY\n    , COALESCE(\n      DATE_SUB(ADJUSTED_REPORT_DATE_ABS, INTERVAL 1 DAY)\n      , DATE_SUB(CURRENT_DATE() + 1, INTERVAL 1 DAY)\n    )\n  )) AS WIP_REPORT_DAY\n)\n\n\n, PLANT_SHUTDOWN_ON_WIP_DAY AS ( -- ASSIGN SHUTDOWN DATE TO A WIP DAY IF THE PLANT WAS SHUTDOWN ON THAT DAY\n  SELECT\n    W.*\n    , P.SHUTDOWN_DATE\n  FROM WIP_COUNTER_TABLE AS W\n  LEFT JOIN PLANT_SHUT_DOWN_DAYS AS P\n    ON W.ASSY_LOC_ID = P.ASSY_LOC_ID\n    AND W.WIP_REPORT_DAY = P.SHUTDOWN_DATE\n)\n\n, PLANT_SHUTDOWN_FLAG_WIP_DAY AS ( -- WEEKENDS AND NON-PRODUCTIONS DAYS NOT COUNTED FOR WIP_AGE\n  SELECT\n    *\n    , CASE\n      WHEN EXTRACT(DAYOFWEEK FROM WIP_REPORT_DAY) IN (1, 7) OR SHUTDOWN_DATE IS NOT NULL THEN 0\n      ELSE 1\n    END                                                                                                  AS WIP_AGE_COUNTER\n    , NOT COALESCE(EXTRACT(DAYOFWEEK FROM WIP_REPORT_DAY) IN (1, 7) OR SHUTDOWN_DATE IS NOT NULL, FALSE) AS PRODUCTION_DAY\n  FROM PLANT_SHUTDOWN_ON_WIP_DAY\n)\n\n\n, WIP_COUNTER_AGE_TABLE AS (\n  SELECT\n    META_ORDER_NUMBER\n    , VEH_ID\n    , FULL_VIN\n    , ABS_IND\n    , MODEL_ID\n    , MODEL_YEAR_DESC\n    , SALES_MODEL_DESC\n    , ENGINE_FAMILY\n    , DPCK_CODE\n    , TRIM_SPEC\n    , FUEL_TYPE\n    , GLOBAL_SALES_CHANNEL_DESC\n    , REGION\n    , MARKET\n    , SVO_IND\n    , ASSY_LOC_ID\n    , ADJUSTED_REPORT_DATE_OFFASSY\n    , ADJUSTED_REPORT_DATE_ABS\n    , WIP_REPORT_DAY\n    , PRODUCTION_DAY\n    , WIP_COUNTER\n    , SUM(WIP_AGE_COUNTER) OVER (PARTITION BY META_ORDER_NUMBER ORDER BY WIP_REPORT_DAY) AS WIP_AGE\n  FROM PLANT_SHUTDOWN_FLAG_WIP_DAY\n)\n\n, FINAL_WIP_HISTORY_RAW AS (\n  SELECT\n    *\n    , MAX(WIP_AGE) OVER (PLANT_MODEL) AS MAX_WIP_AGE_PLANT_MODEL\n  -- CAST(PERCENTILE_CONT(WIP_AGE, 0.1) OVER(PLANT_MODEL) AS INT) AS WIP_AGE_10_PERCENTILE,\n  -- CAST(PERCENTILE_CONT(WIP_AGE, 0.5) OVER(PLANT_MODEL) AS INT) AS MEDIAN_WIP_AGE,\n  -- CAST(PERCENTILE_CONT(WIP_AGE, 0.9) OVER(PLANT_MODEL) AS INT) AS WIP_AGE_90_PERCENTILE\n  FROM WIP_COUNTER_AGE_TABLE\n  WINDOW PLANT_MODEL AS (PARTITION BY ASSY_LOC_ID, MODEL_ID)\n)\n\nSELECT * FROM FINAL_WIP_HISTORY_RAW\n\n--  WHERE FULL_VIN = 'SALCA2AN0RL965803'\n-- WHERE WIP_REPORT_DAY = '2024-04-29'\n\n",
            "disabled": false,
            "fileName": "definitions/intermediate/0450_INDIA_WIP_HISTORY.sqlx",
            "bigquery": {
                "partitionBy": "wip_report_day",
                "clusterBy": [
                    "assy_loc_id"
                ]
            },
            "tags": [
                "DPR",
                "WIP"
            ],
            "actionDescriptor": {
                "description": "WIP history for all reporting days in the last year",
                "columns": [
                    {
                        "description": "Unique identifier for a car in D42",
                        "path": [
                            "VEH_ID"
                        ]
                    },
                    {
                        "description": "Unique identifier for base hold",
                        "path": [
                            "HOLD_BASE_ID"
                        ]
                    },
                    {
                        "description": "Base hold description",
                        "path": [
                            "HOLD_BASE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold type",
                        "path": [
                            "HOLD_TYPE_ID"
                        ]
                    },
                    {
                        "description": "Hold type description",
                        "path": [
                            "HOLD_TYPE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold group",
                        "path": [
                            "HOLD_GROUP_ID"
                        ]
                    },
                    {
                        "description": "Hold group description",
                        "path": [
                            "HOLD_GROUP_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Start date of hold",
                        "path": [
                            "HOLD_START_DATE"
                        ]
                    },
                    {
                        "description": "End date of hold",
                        "path": [
                            "HOLD_END_DATE"
                        ]
                    },
                    {
                        "description": "Reason for removing hold, if exisists",
                        "path": [
                            "HOLD_REMOVAL_REASON"
                        ]
                    },
                    {
                        "description": "Unique identifier for car in VISTA",
                        "path": [
                            "META_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Short vin",
                        "path": [
                            "SHORT_VIN"
                        ]
                    },
                    {
                        "description": "Full vin - cars in allocation will not have a VIN",
                        "path": [
                            "FULL_VIN"
                        ]
                    },
                    {
                        "description": "Unique identifier for an order in PLO",
                        "path": [
                            "SPECIFIC_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Identifier in MES",
                        "path": [
                            "CSO_NUMBER"
                        ]
                    },
                    {
                        "description": "Model description e.g L460 - Range Rover",
                        "path": [
                            "MODEL_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Location id of where car was assembled",
                        "path": [
                            "ASSY_LOC_ID"
                        ]
                    },
                    {
                        "description": "Name of the plant where car was build",
                        "path": [
                            "PLANT_NAME"
                        ]
                    },
                    {
                        "description": "Unique identifier for a dealer",
                        "path": [
                            "DEAL_ID"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was sent to a scrapped cars dealer",
                        "path": [
                            "VEHICLE_SCRAPPED"
                        ]
                    },
                    {
                        "description": "Indicator for cars which are assembled in other plants & shipped to India",
                        "path": [
                            "KD_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when a car was built",
                        "path": [
                            "OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car was ABSed. Note that a car can be ABSed multiple times",
                        "path": [
                            "ABS_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Accepted by Sales(ABS)",
                        "path": [
                            "FIRST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was last Accepted by Sales(ABS)",
                        "path": [
                            "LATEST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was Ready for Sales(RFS)",
                        "path": [
                            "RFS_IND"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car is a special vehicle",
                        "path": [
                            "SVO_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "FIRST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "LATEST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. If a hold is not an SVO hold it will be False",
                        "path": [
                            "_SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. All rows for an order will be true if it had SVO hold when RFSed",
                        "path": [
                            "SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "Off assembly timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Latest ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "LATEST_ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Fuel type from VISTA",
                        "path": [
                            "FUEL_TYPE"
                        ]
                    },
                    {
                        "description": "Sales channel - VISTA. e.g. Private, Fleet & Business",
                        "path": [
                            "GLOBAL_SALES_CHANNEL_DESC"
                        ]
                    },
                    {
                        "description": "Model year - VISTA ( e.g. 24MY)",
                        "path": [
                            "MODEL_YEAR_DESC"
                        ]
                    },
                    {
                        "description": "4 letter model id derived from model_description e.g. L460",
                        "path": [
                            "MODEL_ID"
                        ]
                    },
                    {
                        "description": "Adjusted_offassy_time timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_OFFASSY"
                        ]
                    },
                    {
                        "description": "Adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_ABS"
                        ]
                    },
                    {
                        "description": "Latest_adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_LATEST_ABS"
                        ]
                    },
                    {
                        "description": "Marktet for which the car is made for. Europe",
                        "path": [
                            "DEST_REGION"
                        ]
                    },
                    {
                        "description": "Region of the market for which the car is made for. e.g Italy",
                        "path": [
                            "DEST_MARKET"
                        ]
                    },
                    {
                        "description": "Brochure Model Code. e.g AJ460",
                        "path": [
                            "BMC"
                        ]
                    },
                    {
                        "description": "E.g. 2.0L Diesel I4",
                        "path": [
                            "ENGINE_FAMILY"
                        ]
                    },
                    {
                        "description": "E.g. 260JZ",
                        "path": [
                            "DPCK_CODE"
                        ]
                    },
                    {
                        "description": "E.g. SE/HSE",
                        "path": [
                            "TRIM_SPEC"
                        ]
                    },
                    {
                        "description": "Date at which WIP data needs to be looked at",
                        "path": [
                            "WIP_REPORT_DAY"
                        ]
                    },
                    {
                        "description": "Boolean used to identify if the plant was operational on the Day. Not production days are not counted in WIP age.",
                        "path": [
                            "PRODUCTION_DAY"
                        ]
                    },
                    {
                        "description": "Sudo column w/t value that is used for calculating",
                        "path": [
                            "WIP_COUNTER"
                        ]
                    },
                    {
                        "description": "Number of days car has been in WIP on a given reporting day",
                        "path": [
                            "WIP_AGE"
                        ]
                    },
                    {
                        "description": "Maximum WIP age for a given plant-model combination",
                        "path": [
                            "MAX_WIP_AGE_PLANT_MODEL"
                        ]
                    },
                    {
                        "description": "Plan / target corrosponding to table_type",
                        "path": [
                            "PLAN"
                        ]
                    },
                    {
                        "description": "Date for which data is looked at. Use this in Tableau !",
                        "path": [
                            "REPORT_DATE"
                        ]
                    },
                    {
                        "description": "One of BUILD, ABS, WIP. Tells which of the aforementioned 3 does an meta_order_number belong to for a report_date",
                        "path": [
                            "TABLE_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars build for a REPORT_DATE, MODEL_ID, ASSY_LOC_ID combination",
                        "path": [
                            "BUILD_QTY"
                        ]
                    },
                    {
                        "description": "Why loss happened which caused delta against the plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_REASON"
                        ]
                    },
                    {
                        "description": "One of \"Supplier, Quality Production, MP&L, Facilities, Systems/IT, Launch, Other, Quality Holds, Special Cause\"",
                        "path": [
                            "LOSS_CATEGORY"
                        ]
                    },
                    {
                        "description": "Timestamp of when the loss entry was modified/created",
                        "path": [
                            "LOSS_MODIFIED_TIMESTAMP"
                        ]
                    },
                    {
                        "description": "Email of entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_EMAIL"
                        ]
                    },
                    {
                        "description": "Name of the entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_NAME"
                        ]
                    },
                    {
                        "description": "Number of cars away from plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_QTY"
                        ]
                    },
                    {
                        "description": "Date on which loss happened",
                        "path": [
                            "LOSS_DATE"
                        ]
                    },
                    {
                        "description": "BUILD or ABS",
                        "path": [
                            "LOSS_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars affected by the loss for a ASSY_LOC_ID, MODEL_ID combination",
                        "path": [
                            "AFFECTED_NUMBER"
                        ]
                    },
                    {
                        "description": "320_LOSS_COMMENTARY: When was the loss last modified in the Tableau/Power App/SharePoint List",
                        "path": [
                            "MODIFIED_AT"
                        ]
                    },
                    {
                        "description": "Description of the location where the event happened",
                        "path": [
                            "EVENT_LOC_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the record is archived in D42",
                        "path": [
                            "ARCHIVE_IND"
                        ]
                    },
                    {
                        "description": "Used to identify FLEET and OUV cars in D42",
                        "path": [
                            "ARCO_ID"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was Accepted by Sales(ABS). Check ABS_IND to know the current ABS status of the car as car can be ABSed multiple times",
                        "path": [
                            "ABS_DATE"
                        ]
                    },
                    {
                        "description": "Unique identifier for an event in D42",
                        "path": [
                            "EVEN_ID"
                        ]
                    },
                    {
                        "description": "Location id of where the event happened",
                        "path": [
                            "EVENT_LOC_ID"
                        ]
                    },
                    {
                        "description": "Description of the event",
                        "path": [
                            "EVENT_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Timestap of when the event was recorded in D42",
                        "path": [
                            "LAST_UPDATED"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if car is ('OUV', 'SDV') and built in China then it will not be included in ABS for China reporting and by lineage WIP",
                        "path": [
                            "CHINA_ABS_EXCLUSION_IND"
                        ]
                    },
                    {
                        "description": "Date of the saturday of the week for REPORT_DATE",
                        "path": [
                            "REPORT_DATE_SATURDAY"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "WEEK_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production week (saturday)",
                        "path": [
                            "PRODUCTION_WEEK_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production week (friday)",
                        "path": [
                            "PRODUCTION_WEEK_END"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "MONTH_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production month (saturday)",
                        "path": [
                            "PRODUCTION_MONTH_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production month (friday)",
                        "path": [
                            "PRODUCTION_MONTH_END"
                        ]
                    },
                    {
                        "description": "Indenfier for start of production month for Tableau. Is inferred from MONTH_PER_ID in 'yymm' format to 'yyyy-mm-01'",
                        "path": [
                            "PRODUCTION_MONTH_ID"
                        ]
                    }
                ]
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "0150_INDIA_ACTUALS",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "050_SHUTDOWN_DAYS",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "0450_INDIA_WIP_HISTORY",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "TABLE"
        },
        {
            "type": "table",
            "target": {
                "schema": "daily_production_report",
                "name": "050_SHUTDOWN_DAYS",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\nWITH PLANT_SHUT_DOWN_DAYS AS (\n  SELECT\n    CASE\n      WHEN PLANT = 'SOLIHULL' THEN 'SLP'\n      WHEN PLANT = 'CB' THEN 'CBP'\n      WHEN PLANT = 'HALEWOOD' THEN 'HWP'\n      WHEN PLANT = 'NITRA' THEN 'NTP'\n      WHEN PLANT = 'GRAZ' THEN 'GZP'\n      WHEN PLANT = 'INDIA' THEN 'IND'\n      WHEN PLANT = 'BRAZIL' THEN 'BRP'\n      ELSE PLANT\n    END AS ASSY_LOC_ID\n    , SHUTDOWN_DATE\n  FROM `jlr-it-scanalytics-prod.daily_production_report.SHUTDOWN_DATES_ALL_PLANTS`\n)\n\nSELECT * FROM PLANT_SHUT_DOWN_DAYS\n\n",
            "disabled": false,
            "fileName": "definitions/intermediate/050_SHUTDOWN_DAYS.sqlx",
            "tags": [
                "DPR",
                "SHUTDOWN_DATES"
            ],
            "actionDescriptor": {
                "description": "Shutdown days with plant mapping",
                "columns": [
                    {
                        "description": "Unique identifier for a car in D42",
                        "path": [
                            "VEH_ID"
                        ]
                    },
                    {
                        "description": "Unique identifier for base hold",
                        "path": [
                            "HOLD_BASE_ID"
                        ]
                    },
                    {
                        "description": "Base hold description",
                        "path": [
                            "HOLD_BASE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold type",
                        "path": [
                            "HOLD_TYPE_ID"
                        ]
                    },
                    {
                        "description": "Hold type description",
                        "path": [
                            "HOLD_TYPE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold group",
                        "path": [
                            "HOLD_GROUP_ID"
                        ]
                    },
                    {
                        "description": "Hold group description",
                        "path": [
                            "HOLD_GROUP_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Start date of hold",
                        "path": [
                            "HOLD_START_DATE"
                        ]
                    },
                    {
                        "description": "End date of hold",
                        "path": [
                            "HOLD_END_DATE"
                        ]
                    },
                    {
                        "description": "Reason for removing hold, if exisists",
                        "path": [
                            "HOLD_REMOVAL_REASON"
                        ]
                    },
                    {
                        "description": "Unique identifier for car in VISTA",
                        "path": [
                            "META_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Short vin",
                        "path": [
                            "SHORT_VIN"
                        ]
                    },
                    {
                        "description": "Full vin - cars in allocation will not have a VIN",
                        "path": [
                            "FULL_VIN"
                        ]
                    },
                    {
                        "description": "Unique identifier for an order in PLO",
                        "path": [
                            "SPECIFIC_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Identifier in MES",
                        "path": [
                            "CSO_NUMBER"
                        ]
                    },
                    {
                        "description": "Model description e.g L460 - Range Rover",
                        "path": [
                            "MODEL_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Location id of where car was assembled",
                        "path": [
                            "ASSY_LOC_ID"
                        ]
                    },
                    {
                        "description": "Name of the plant where car was build",
                        "path": [
                            "PLANT_NAME"
                        ]
                    },
                    {
                        "description": "Unique identifier for a dealer",
                        "path": [
                            "DEAL_ID"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was sent to a scrapped cars dealer",
                        "path": [
                            "VEHICLE_SCRAPPED"
                        ]
                    },
                    {
                        "description": "Indicator for cars which are assembled in other plants & shipped to India",
                        "path": [
                            "KD_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when a car was built",
                        "path": [
                            "OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car was ABSed. Note that a car can be ABSed multiple times",
                        "path": [
                            "ABS_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Accepted by Sales(ABS)",
                        "path": [
                            "FIRST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was last Accepted by Sales(ABS)",
                        "path": [
                            "LATEST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was Ready for Sales(RFS)",
                        "path": [
                            "RFS_IND"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car is a special vehicle",
                        "path": [
                            "SVO_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "FIRST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "LATEST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. If a hold is not an SVO hold it will be False",
                        "path": [
                            "_SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. All rows for an order will be true if it had SVO hold when RFSed",
                        "path": [
                            "SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "Off assembly timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Latest ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "LATEST_ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Fuel type from VISTA",
                        "path": [
                            "FUEL_TYPE"
                        ]
                    },
                    {
                        "description": "Sales channel - VISTA. e.g. Private, Fleet & Business",
                        "path": [
                            "GLOBAL_SALES_CHANNEL_DESC"
                        ]
                    },
                    {
                        "description": "Model year - VISTA ( e.g. 24MY)",
                        "path": [
                            "MODEL_YEAR_DESC"
                        ]
                    },
                    {
                        "description": "4 letter model id derived from model_description e.g. L460",
                        "path": [
                            "MODEL_ID"
                        ]
                    },
                    {
                        "description": "Adjusted_offassy_time timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_OFFASSY"
                        ]
                    },
                    {
                        "description": "Adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_ABS"
                        ]
                    },
                    {
                        "description": "Latest_adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_LATEST_ABS"
                        ]
                    },
                    {
                        "description": "Marktet for which the car is made for. Europe",
                        "path": [
                            "DEST_REGION"
                        ]
                    },
                    {
                        "description": "Region of the market for which the car is made for. e.g Italy",
                        "path": [
                            "DEST_MARKET"
                        ]
                    },
                    {
                        "description": "Brochure Model Code. e.g AJ460",
                        "path": [
                            "BMC"
                        ]
                    },
                    {
                        "description": "E.g. 2.0L Diesel I4",
                        "path": [
                            "ENGINE_FAMILY"
                        ]
                    },
                    {
                        "description": "E.g. 260JZ",
                        "path": [
                            "DPCK_CODE"
                        ]
                    },
                    {
                        "description": "E.g. SE/HSE",
                        "path": [
                            "TRIM_SPEC"
                        ]
                    },
                    {
                        "description": "Date at which WIP data needs to be looked at",
                        "path": [
                            "WIP_REPORT_DAY"
                        ]
                    },
                    {
                        "description": "Boolean used to identify if the plant was operational on the Day. Not production days are not counted in WIP age.",
                        "path": [
                            "PRODUCTION_DAY"
                        ]
                    },
                    {
                        "description": "Sudo column w/t value that is used for calculating",
                        "path": [
                            "WIP_COUNTER"
                        ]
                    },
                    {
                        "description": "Number of days car has been in WIP on a given reporting day",
                        "path": [
                            "WIP_AGE"
                        ]
                    },
                    {
                        "description": "Maximum WIP age for a given plant-model combination",
                        "path": [
                            "MAX_WIP_AGE_PLANT_MODEL"
                        ]
                    },
                    {
                        "description": "Plan / target corrosponding to table_type",
                        "path": [
                            "PLAN"
                        ]
                    },
                    {
                        "description": "Date for which data is looked at. Use this in Tableau !",
                        "path": [
                            "REPORT_DATE"
                        ]
                    },
                    {
                        "description": "One of BUILD, ABS, WIP. Tells which of the aforementioned 3 does an meta_order_number belong to for a report_date",
                        "path": [
                            "TABLE_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars build for a REPORT_DATE, MODEL_ID, ASSY_LOC_ID combination",
                        "path": [
                            "BUILD_QTY"
                        ]
                    },
                    {
                        "description": "Why loss happened which caused delta against the plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_REASON"
                        ]
                    },
                    {
                        "description": "One of \"Supplier, Quality Production, MP&L, Facilities, Systems/IT, Launch, Other, Quality Holds, Special Cause\"",
                        "path": [
                            "LOSS_CATEGORY"
                        ]
                    },
                    {
                        "description": "Timestamp of when the loss entry was modified/created",
                        "path": [
                            "LOSS_MODIFIED_TIMESTAMP"
                        ]
                    },
                    {
                        "description": "Email of entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_EMAIL"
                        ]
                    },
                    {
                        "description": "Name of the entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_NAME"
                        ]
                    },
                    {
                        "description": "Number of cars away from plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_QTY"
                        ]
                    },
                    {
                        "description": "Date on which loss happened",
                        "path": [
                            "LOSS_DATE"
                        ]
                    },
                    {
                        "description": "BUILD or ABS",
                        "path": [
                            "LOSS_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars affected by the loss for a ASSY_LOC_ID, MODEL_ID combination",
                        "path": [
                            "AFFECTED_NUMBER"
                        ]
                    },
                    {
                        "description": "320_LOSS_COMMENTARY: When was the loss last modified in the Tableau/Power App/SharePoint List",
                        "path": [
                            "MODIFIED_AT"
                        ]
                    },
                    {
                        "description": "Description of the location where the event happened",
                        "path": [
                            "EVENT_LOC_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the record is archived in D42",
                        "path": [
                            "ARCHIVE_IND"
                        ]
                    },
                    {
                        "description": "Used to identify FLEET and OUV cars in D42",
                        "path": [
                            "ARCO_ID"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was Accepted by Sales(ABS). Check ABS_IND to know the current ABS status of the car as car can be ABSed multiple times",
                        "path": [
                            "ABS_DATE"
                        ]
                    },
                    {
                        "description": "Unique identifier for an event in D42",
                        "path": [
                            "EVEN_ID"
                        ]
                    },
                    {
                        "description": "Location id of where the event happened",
                        "path": [
                            "EVENT_LOC_ID"
                        ]
                    },
                    {
                        "description": "Description of the event",
                        "path": [
                            "EVENT_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Timestap of when the event was recorded in D42",
                        "path": [
                            "LAST_UPDATED"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if car is ('OUV', 'SDV') and built in China then it will not be included in ABS for China reporting and by lineage WIP",
                        "path": [
                            "CHINA_ABS_EXCLUSION_IND"
                        ]
                    },
                    {
                        "description": "Date of the saturday of the week for REPORT_DATE",
                        "path": [
                            "REPORT_DATE_SATURDAY"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "WEEK_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production week (saturday)",
                        "path": [
                            "PRODUCTION_WEEK_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production week (friday)",
                        "path": [
                            "PRODUCTION_WEEK_END"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "MONTH_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production month (saturday)",
                        "path": [
                            "PRODUCTION_MONTH_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production month (friday)",
                        "path": [
                            "PRODUCTION_MONTH_END"
                        ]
                    },
                    {
                        "description": "Indenfier for start of production month for Tableau. Is inferred from MONTH_PER_ID in 'yymm' format to 'yyyy-mm-01'",
                        "path": [
                            "PRODUCTION_MONTH_ID"
                        ]
                    }
                ]
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "0150_INDIA_ACTUALS",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "SHUTDOWN_DATES_ALL_PLANTS",
                    "database": "jlr-it-scanalytics-prod"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "050_SHUTDOWN_DAYS",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "TABLE"
        },
        {
            "type": "table",
            "target": {
                "schema": "daily_production_report",
                "name": "310_DPRD_LATEST_BUILD_ABS_WIP_PLAN",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\nWITH OTHER_PLANTS_BUILD_ABS_WIP_PLAN AS (\n  SELECT\n    *\n    , DENSE_RANK() OVER (PARTITION BY ASSY_LOC_ID, MODEL_ID, SALES_MODEL_DESC, REPORT_DATE ORDER BY LAST_UPDATE_DATETIME DESC) AS RN\n  FROM `jlr-it-scanalytics-prod.daily_production_report.DPRD_BUILD_ABS_WIP_PLAN`\n  QUALIFY RN = 1\n)\n\n, INDIA_LATEST_BUILD_ABS_WIP_PLAN AS (\n  SELECT\n    *\n    , DENSE_RANK() OVER (PARTITION BY ASSY_LOC_ID, MODEL_ID, REPORT_DATE ORDER BY LAST_UPDATE_DATETIME DESC) AS RN\n  FROM `jlr-it-scanalytics-dev.daily_production_report.DPRD_INDIA_BUILD_ABS_WIP_PLAN`\n  QUALIFY RN = 1\n)\n\n, ALL_PLANTS_LATEST_BUILD_ABS_WIP_PLAN AS (\n  SELECT REPORT_DATE, DAY_OF_WEEK, ASSY_LOC_ID, MODEL_ID, SALES_MODEL_DESC, BUILD_PLAN, ABS_TARGET, WIP_TARGET, LAST_UPDATE_DATETIME, RN FROM OTHER_PLANTS_BUILD_ABS_WIP_PLAN\n  UNION ALL\n  SELECT REPORT_DATE, DAY_OF_WEEK, ASSY_LOC_ID, MODEL_ID, STRING(NULL) AS SALES_MODEL_DESC, BUILD_PLAN, ABS_TARGET, WIP_TARGET, LAST_UPDATE_DATETIME, RN FROM INDIA_LATEST_BUILD_ABS_WIP_PLAN\n)\n\n\n, LATEST_BUILD_ABS_WIP_PLAN AS (\n  SELECT\n    * EXCEPT (RN)\n    , SALES_MODEL_DESC IS NULL                                                             AS SALES_MODEL_DESC_IS_NULL\n    , COALESCE(COUNT(*) OVER (PARTITION BY MODEL_ID, REPORT_DATE, ASSY_LOC_ID) > 1, FALSE) AS SALES_MODEL_DESC_LEVEL_PLAN_AVAILABLE\n  FROM ALL_PLANTS_LATEST_BUILD_ABS_WIP_PLAN\n)\n\n, _SALES_MODEL_DESC_LEVEL_BUILD_ABS_WIP_PLAN_WO_DUPLICATES AS (\n  SELECT\n    *\n    -- The below will happen when we have both model and sales_model_desc level plans available\n    -- an edge case that happens during the transition period when they would have uploaded model level plans in the prior week\n    , COALESCE(SALES_MODEL_DESC_LEVEL_PLAN_AVAILABLE AND SALES_MODEL_DESC_IS_NULL, FALSE) AS EXCLUDE_ROW\n  FROM LATEST_BUILD_ABS_WIP_PLAN\n)\n\n, SALES_MODEL_DESC_LEVEL_BUILD_ABS_WIP_PLAN_WO_DUPLICATES AS (\n  SELECT *\n  FROM _SALES_MODEL_DESC_LEVEL_BUILD_ABS_WIP_PLAN_WO_DUPLICATES\n  WHERE NOT EXCLUDE_ROW\n)\n\n\n, SALES_MODEL_DESC_LEVEL_BUILD_ABS_WIP_PLAN AS (\n  SELECT\n    *\n    , SUM(BUILD_PLAN) OVER (PARTITION BY REPORT_DATE, ASSY_LOC_ID, MODEL_ID, SALES_MODEL_DESC) AS SALES_MODEL_DESC_LEVEL_BUILD_TARGET\n    , SUM(ABS_TARGET) OVER (PARTITION BY REPORT_DATE, ASSY_LOC_ID, MODEL_ID, SALES_MODEL_DESC) AS SALES_MODEL_DESC_LEVEL_ABS_TARGET\n    , SUM(WIP_TARGET) OVER (PARTITION BY REPORT_DATE, ASSY_LOC_ID, MODEL_ID, SALES_MODEL_DESC) AS SALES_MODEL_DESC_LEVEL_WIP_TARGET\n  FROM SALES_MODEL_DESC_LEVEL_BUILD_ABS_WIP_PLAN_WO_DUPLICATES\n)\n\n\n, DIGITAL_DPR_PLAN AS (\n  SELECT DISTINCT\n    REPORT_DATE\n    , DAY_OF_WEEK\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SALES_MODEL_DESC\n    , SALES_MODEL_DESC_LEVEL_BUILD_TARGET AS BUILD_TARGET\n    , SALES_MODEL_DESC_LEVEL_ABS_TARGET   AS ABS_TARGET\n    , SALES_MODEL_DESC_LEVEL_WIP_TARGET   AS WIP_TARGET\n    , LAST_UPDATE_DATETIME\n  FROM SALES_MODEL_DESC_LEVEL_BUILD_ABS_WIP_PLAN\n  WHERE REPORT_DATE >= '2023-12-01'\n)\n\n, MANUAL_DPR_PLAN AS (\n  SELECT\n    REPORT_DAY     AS REPORT_DATE\n    , DAY_OF_WEEK\n    , CASE\n      WHEN ASSY_LOC_ID = 'INDIA' THEN 'INP'\n      ELSE ASSY_LOC_ID\n    END        AS ASSY_LOC_ID\n    , MODEL_ID\n    , STRING(NULL) AS SALES_MODEL_DESC\n    , BUILD_TARGET\n    , ABS_TARGET\n    , WIP_TARGET\n    , LAST_UPDATE_DATETIME\n  FROM\n    `jlr-it-scanalytics-prod.daily_production_report.OLD_BUILD_ABS_WIP_PLAN_V`\n  WHERE\n    1 = 1\n    AND REPORT_DAY >= '2023-04-01'\n    AND REPORT_DAY < '2023-12-01'\n)\n\n\n, COMBINED_PLAN AS (\n  SELECT * FROM DIGITAL_DPR_PLAN\n  UNION ALL\n  SELECT * FROM MANUAL_DPR_PLAN\n)\n\n, FINAL_TABLE AS (\n  SELECT\n    *\n    , CASE\n      WHEN ASSY_LOC_ID = 'SLP' THEN 'SOLIHULL PLANT'\n      WHEN ASSY_LOC_ID = 'HWP' THEN 'HALEWOOD'\n      WHEN ASSY_LOC_ID = 'GZP' THEN 'PLANT GRAZ'\n      WHEN ASSY_LOC_ID = 'NTP' THEN 'NITRA PLANT'\n      WHEN ASSY_LOC_ID = 'BRP' THEN 'BRAZIL ITATIAIA PLANT'\n      WHEN ASSY_LOC_ID = 'CBP' THEN 'CASTLE BROMWICH'\n      ELSE ASSY_LOC_ID\n    END AS PLANT_NAME\n  FROM COMBINED_PLAN ORDER BY REPORT_DATE ASC\n)\n\nSELECT * FROM FINAL_TABLE\n\n",
            "disabled": false,
            "fileName": "definitions/intermediate/310_DPRD_LATEST_BUILD_ABS_WIP_PLAN.sqlx",
            "tags": [
                "DPR",
                "PLAN"
            ],
            "actionDescriptor": {
                "description": "Gets the latest plan uploaded by the vehicle scheduling team",
                "columns": [
                    {
                        "description": "Unique identifier for a car in D42",
                        "path": [
                            "VEH_ID"
                        ]
                    },
                    {
                        "description": "Unique identifier for base hold",
                        "path": [
                            "HOLD_BASE_ID"
                        ]
                    },
                    {
                        "description": "Base hold description",
                        "path": [
                            "HOLD_BASE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold type",
                        "path": [
                            "HOLD_TYPE_ID"
                        ]
                    },
                    {
                        "description": "Hold type description",
                        "path": [
                            "HOLD_TYPE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold group",
                        "path": [
                            "HOLD_GROUP_ID"
                        ]
                    },
                    {
                        "description": "Hold group description",
                        "path": [
                            "HOLD_GROUP_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Start date of hold",
                        "path": [
                            "HOLD_START_DATE"
                        ]
                    },
                    {
                        "description": "End date of hold",
                        "path": [
                            "HOLD_END_DATE"
                        ]
                    },
                    {
                        "description": "Reason for removing hold, if exisists",
                        "path": [
                            "HOLD_REMOVAL_REASON"
                        ]
                    },
                    {
                        "description": "Unique identifier for car in VISTA",
                        "path": [
                            "META_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Short vin",
                        "path": [
                            "SHORT_VIN"
                        ]
                    },
                    {
                        "description": "Full vin - cars in allocation will not have a VIN",
                        "path": [
                            "FULL_VIN"
                        ]
                    },
                    {
                        "description": "Unique identifier for an order in PLO",
                        "path": [
                            "SPECIFIC_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Identifier in MES",
                        "path": [
                            "CSO_NUMBER"
                        ]
                    },
                    {
                        "description": "Model description e.g L460 - Range Rover",
                        "path": [
                            "MODEL_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Location id of where car was assembled",
                        "path": [
                            "ASSY_LOC_ID"
                        ]
                    },
                    {
                        "description": "Name of the plant where car was build",
                        "path": [
                            "PLANT_NAME"
                        ]
                    },
                    {
                        "description": "Unique identifier for a dealer",
                        "path": [
                            "DEAL_ID"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was sent to a scrapped cars dealer",
                        "path": [
                            "VEHICLE_SCRAPPED"
                        ]
                    },
                    {
                        "description": "Indicator for cars which are assembled in other plants & shipped to India",
                        "path": [
                            "KD_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when a car was built",
                        "path": [
                            "OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car was ABSed. Note that a car can be ABSed multiple times",
                        "path": [
                            "ABS_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Accepted by Sales(ABS)",
                        "path": [
                            "FIRST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was last Accepted by Sales(ABS)",
                        "path": [
                            "LATEST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was Ready for Sales(RFS)",
                        "path": [
                            "RFS_IND"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car is a special vehicle",
                        "path": [
                            "SVO_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "FIRST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "LATEST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. If a hold is not an SVO hold it will be False",
                        "path": [
                            "_SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. All rows for an order will be true if it had SVO hold when RFSed",
                        "path": [
                            "SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "Off assembly timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Latest ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "LATEST_ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Fuel type from VISTA",
                        "path": [
                            "FUEL_TYPE"
                        ]
                    },
                    {
                        "description": "Sales channel - VISTA. e.g. Private, Fleet & Business",
                        "path": [
                            "GLOBAL_SALES_CHANNEL_DESC"
                        ]
                    },
                    {
                        "description": "Model year - VISTA ( e.g. 24MY)",
                        "path": [
                            "MODEL_YEAR_DESC"
                        ]
                    },
                    {
                        "description": "4 letter model id derived from model_description e.g. L460",
                        "path": [
                            "MODEL_ID"
                        ]
                    },
                    {
                        "description": "Adjusted_offassy_time timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_OFFASSY"
                        ]
                    },
                    {
                        "description": "Adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_ABS"
                        ]
                    },
                    {
                        "description": "Latest_adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_LATEST_ABS"
                        ]
                    },
                    {
                        "description": "Marktet for which the car is made for. Europe",
                        "path": [
                            "DEST_REGION"
                        ]
                    },
                    {
                        "description": "Region of the market for which the car is made for. e.g Italy",
                        "path": [
                            "DEST_MARKET"
                        ]
                    },
                    {
                        "description": "Brochure Model Code. e.g AJ460",
                        "path": [
                            "BMC"
                        ]
                    },
                    {
                        "description": "E.g. 2.0L Diesel I4",
                        "path": [
                            "ENGINE_FAMILY"
                        ]
                    },
                    {
                        "description": "E.g. 260JZ",
                        "path": [
                            "DPCK_CODE"
                        ]
                    },
                    {
                        "description": "E.g. SE/HSE",
                        "path": [
                            "TRIM_SPEC"
                        ]
                    },
                    {
                        "description": "Date at which WIP data needs to be looked at",
                        "path": [
                            "WIP_REPORT_DAY"
                        ]
                    },
                    {
                        "description": "Boolean used to identify if the plant was operational on the Day. Not production days are not counted in WIP age.",
                        "path": [
                            "PRODUCTION_DAY"
                        ]
                    },
                    {
                        "description": "Sudo column w/t value that is used for calculating",
                        "path": [
                            "WIP_COUNTER"
                        ]
                    },
                    {
                        "description": "Number of days car has been in WIP on a given reporting day",
                        "path": [
                            "WIP_AGE"
                        ]
                    },
                    {
                        "description": "Maximum WIP age for a given plant-model combination",
                        "path": [
                            "MAX_WIP_AGE_PLANT_MODEL"
                        ]
                    },
                    {
                        "description": "Plan / target corrosponding to table_type",
                        "path": [
                            "PLAN"
                        ]
                    },
                    {
                        "description": "Date for which data is looked at. Use this in Tableau !",
                        "path": [
                            "REPORT_DATE"
                        ]
                    },
                    {
                        "description": "One of BUILD, ABS, WIP. Tells which of the aforementioned 3 does an meta_order_number belong to for a report_date",
                        "path": [
                            "TABLE_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars build for a REPORT_DATE, MODEL_ID, ASSY_LOC_ID combination",
                        "path": [
                            "BUILD_QTY"
                        ]
                    },
                    {
                        "description": "Why loss happened which caused delta against the plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_REASON"
                        ]
                    },
                    {
                        "description": "One of \"Supplier, Quality Production, MP&L, Facilities, Systems/IT, Launch, Other, Quality Holds, Special Cause\"",
                        "path": [
                            "LOSS_CATEGORY"
                        ]
                    },
                    {
                        "description": "Timestamp of when the loss entry was modified/created",
                        "path": [
                            "LOSS_MODIFIED_TIMESTAMP"
                        ]
                    },
                    {
                        "description": "Email of entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_EMAIL"
                        ]
                    },
                    {
                        "description": "Name of the entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_NAME"
                        ]
                    },
                    {
                        "description": "Number of cars away from plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_QTY"
                        ]
                    },
                    {
                        "description": "Date on which loss happened",
                        "path": [
                            "LOSS_DATE"
                        ]
                    },
                    {
                        "description": "BUILD or ABS",
                        "path": [
                            "LOSS_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars affected by the loss for a ASSY_LOC_ID, MODEL_ID combination",
                        "path": [
                            "AFFECTED_NUMBER"
                        ]
                    },
                    {
                        "description": "320_LOSS_COMMENTARY: When was the loss last modified in the Tableau/Power App/SharePoint List",
                        "path": [
                            "MODIFIED_AT"
                        ]
                    },
                    {
                        "description": "Description of the location where the event happened",
                        "path": [
                            "EVENT_LOC_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the record is archived in D42",
                        "path": [
                            "ARCHIVE_IND"
                        ]
                    },
                    {
                        "description": "Used to identify FLEET and OUV cars in D42",
                        "path": [
                            "ARCO_ID"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was Accepted by Sales(ABS). Check ABS_IND to know the current ABS status of the car as car can be ABSed multiple times",
                        "path": [
                            "ABS_DATE"
                        ]
                    },
                    {
                        "description": "Unique identifier for an event in D42",
                        "path": [
                            "EVEN_ID"
                        ]
                    },
                    {
                        "description": "Location id of where the event happened",
                        "path": [
                            "EVENT_LOC_ID"
                        ]
                    },
                    {
                        "description": "Description of the event",
                        "path": [
                            "EVENT_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Timestap of when the event was recorded in D42",
                        "path": [
                            "LAST_UPDATED"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if car is ('OUV', 'SDV') and built in China then it will not be included in ABS for China reporting and by lineage WIP",
                        "path": [
                            "CHINA_ABS_EXCLUSION_IND"
                        ]
                    },
                    {
                        "description": "Date of the saturday of the week for REPORT_DATE",
                        "path": [
                            "REPORT_DATE_SATURDAY"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "WEEK_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production week (saturday)",
                        "path": [
                            "PRODUCTION_WEEK_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production week (friday)",
                        "path": [
                            "PRODUCTION_WEEK_END"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "MONTH_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production month (saturday)",
                        "path": [
                            "PRODUCTION_MONTH_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production month (friday)",
                        "path": [
                            "PRODUCTION_MONTH_END"
                        ]
                    },
                    {
                        "description": "Indenfier for start of production month for Tableau. Is inferred from MONTH_PER_ID in 'yymm' format to 'yyyy-mm-01'",
                        "path": [
                            "PRODUCTION_MONTH_ID"
                        ]
                    }
                ]
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "DPRD_BUILD_ABS_WIP_PLAN",
                    "database": "jlr-it-scanalytics-prod"
                },
                {
                    "schema": "daily_production_report",
                    "name": "DPRD_INDIA_BUILD_ABS_WIP_PLAN",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "OLD_BUILD_ABS_WIP_PLAN_V",
                    "database": "jlr-it-scanalytics-prod"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "310_DPRD_LATEST_BUILD_ABS_WIP_PLAN",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "TABLE"
        },
        {
            "type": "table",
            "target": {
                "schema": "daily_production_report_access",
                "name": "0200_D42_EVENTS_META_DATA",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\nWITH VEHICLE_EVENTS AS (\n  SELECT\n    VEH_ID\n    , LOEV_ID\n    , LAST_UPDATED\n    , CANCELLED\n    , END_DATE\n  FROM `jlr-it-scanalytics-prod.JLR_DL_EDW_D42_RAW_ACCESS.VEHICLE_EVENTS_V`\n  WHERE DATE(PARTITIONDATE) = CURRENT_DATE()\n)\n\n\n, EVENTS AS (\n  SELECT\n    ID            AS EVEN_ID\n    , DESCRIPTION AS EVENT_DESCRIPTION\n  FROM `jlr-it-scanalytics-prod.JLR_DL_EDW_D42_RAW_ACCESS.EVENTS_V`\n  WHERE DATE(PARTITIONDATE) = CURRENT_DATE()\n)\n\n, LOCATIONS AS (\n  SELECT\n    ID AS LOC_ID\n    , DESCRIPTION\n    , KD_LOC\n  FROM `jlr-it-scanalytics-prod.JLR_DL_EDW_D42_RAW_ACCESS.LOCATIONS_V`\n  WHERE DATE(PARTITIONDATE) = CURRENT_DATE()\n)\n\n, LOCATION_EVENTS AS (\n  SELECT\n    * EXCEPT (ID)\n    , ID AS LOEV_ID\n  FROM `jlr-it-scanalytics-prod.JLR_DL_EDW_D42_RAW_ACCESS.LOCATION_EVENTS_V`\n  WHERE DATE(PARTITIONDATE) = CURRENT_DATE()\n  -- AND EVEN_ID IN ('OFFASSY',  \"RFS\", \"ABS\")\n)\n\n, DEAL_ID_SCRAPPED_CARS AS (\n  SELECT DISTINCT ID AS DEAL_ID\n  FROM `jlr-it-scanalytics-prod.JLR_DL_EDW_D42_RAW_ACCESS.DEALERS_V`\n  WHERE LOWER(DESCRIPTION) LIKE '%aborted%'\n)\n\n, MODELS AS (\n  SELECT\n    ID            AS MODEL_ID\n    , DESCRIPTION AS MODEL_DESCRIPTION\n  FROM `jlr-it-scanalytics-prod.JLR_DL_EDW_D42_RAW_ACCESS.MODELS_V`\n  WHERE DATE(PARTITIONDATE) = CURRENT_DATE()\n)\n\n\n, VEHICLE_ORDERS AS (\n  SELECT\n    ID                                                                        AS VEH_ID\n    , CAST(META_ORDER_NUMBER AS INT64)                                        AS META_ORDER_NUMBER -- VISTA\n    , CONCAT(BWMI_ID, VP_VIN_PREFIX, CHASSIS_NUMBER)                          AS FULL_VIN\n    , SHORT_VIN -- NOT UNIQUE, ALSO LOGIC DIFFERENT TO OTHER SYSTEMS\n    , CSO_NUMBER -- MES\n    , SPECIFIC_ORDER_NUMBER -- PLO\n    , ARCHIVE_IND -- L STANDS FOR LIVE RECORD AND NOT ARCHIVED VEHICLES ARE GENERALLY ARCHIVED 12 MONTHS AFTER DELIVERY\n    , LOC_ID\n    , ARCO_ID\n    , ASSY_LOC_ID\n    , MODE_ID                                                                 AS MODEL_ID\n    , ABS_IND\n    , DEAL_ID\n    , COALESCE(DEAL_ID IN (SELECT DEAL_ID FROM DEAL_ID_SCRAPPED_CARS), FALSE) AS VEHICLE_SCRAPPED\n    , KD_IND\n    , RFS_IND\n    , SVO_IND -- Y/N, SET WHEN A VEHICLE HAS AN SVO HOLD APPLIED, SO MAY HAVE FALSE POSITIVES\n    , ABS_DATE\n    , END_DATE\n  FROM `jlr-it-scanalytics-prod.JLR_DL_EDW_D42_RAW_ACCESS.VEHICLE_ORDERS_V`\n  WHERE DATE(PARTITIONDATE) = CURRENT_DATE()\n    AND META_ORDER_NUMBER != '' AND META_ORDER_NUMBER IS NOT NULL\n)\n\n, D42_EVENT_METADATA AS (\n  SELECT\n    VO.VEH_ID\n    , VO.META_ORDER_NUMBER\n    , VO.SHORT_VIN\n    , VO.FULL_VIN\n    , VO.CSO_NUMBER\n    , VO.SPECIFIC_ORDER_NUMBER\n    , VO.ARCHIVE_IND\n    , VO.ARCO_ID\n    , VO.ASSY_LOC_ID\n    , VO.ABS_IND\n    , ABS_DATE\n    -- MODELS.MODEL_REF, -- TWO CHARACTER MODEL CODE\n    , M.MODEL_DESCRIPTION -- MODEL STRING, FED BY ANOTHER SYSTEM, NOT RELIABLE ?\n    , LOE.EVEN_ID  -- 'OFFASSY',  \"RFS\", \"ABS\", \"MOK\"\n    , LOE.LOC_ID                                                                  AS EVENT_LOC_ID\n    , L1.DESCRIPTION                                                              AS EVENT_LOC_DESCRIPTION\n    , EV.EVENT_DESCRIPTION\n    , VE.LAST_UPDATED\n    , VO.DEAL_ID\n    , COALESCE(VO.DEAL_ID IN (SELECT DEAL_ID FROM DEAL_ID_SCRAPPED_CARS), FALSE)  AS VEHICLE_SCRAPPED\n    , COALESCE(VO.ARCO_ID IN ('OUV', 'SDV') AND VO.ASSY_LOC_ID IN ('CHP'), FALSE) AS CHINA_ABS_EXCLUSION_IND\n    , KD_IND\n    , VO.RFS_IND\n    , VO.SVO_IND -- Y/N, SET WHEN A VEHICLE HAS AN SVO HOLD APPLIED, SO MAY HAVE FALSE POSITIVES\n  FROM VEHICLE_EVENTS AS VE\n  LEFT JOIN LOCATION_EVENTS AS LOE ON VE.LOEV_ID = LOE.LOEV_ID\n  LEFT JOIN EVENTS AS EV ON LOE.EVEN_ID = EV.EVEN_ID\n  LEFT JOIN VEHICLE_ORDERS AS VO ON VE.VEH_ID = VO.VEH_ID\n  LEFT JOIN MODELS AS M ON VO.MODEL_ID = M.MODEL_ID\n  LEFT JOIN LOCATIONS AS L1 ON LOE.LOC_ID = L1.LOC_ID\n  LEFT JOIN LOCATIONS AS L2 ON VO.ASSY_LOC_ID = L2.LOC_ID\n  WHERE 1 = 1\n    AND VE.LAST_UPDATED >= '2020-06-16'\n    AND (VO.END_DATE IS NULL OR VO.END_DATE < '2008-01-01') -- NO DELETED VEHICLES\n    -- AND VO.ASSY_LOC_ID NOT IN (\"CHP\")\n    AND VO.KD_IND = 'N' -- NO INDIA KD (ABS PROCESS IS DIFFERENT)\n    AND VO.ARCHIVE_IND = 'L' -- 'LIVE' D42 VEHICLES ONLY, GETS RID OF ANCIENT HISTORY. VEHICLES ARCHIVED ~12 MONTHS POST DELIVERY\n)\n\nSELECT * FROM D42_EVENT_METADATA\n\n",
            "disabled": false,
            "fileName": "definitions/outputs/0200_D42_EVENTS_META_DATA.sqlx",
            "bigquery": {
                "clusterBy": [
                    "assy_loc_id"
                ]
            },
            "tags": [
                "VEHICLE_SCHEDULING_TEAM_REQ",
                "DPR"
            ],
            "actionDescriptor": {
                "description": "Base table for all D42 events for a meta_order_number",
                "columns": [
                    {
                        "description": "Unique identifier for a car in D42",
                        "path": [
                            "VEH_ID"
                        ]
                    },
                    {
                        "description": "Unique identifier for base hold",
                        "path": [
                            "HOLD_BASE_ID"
                        ]
                    },
                    {
                        "description": "Base hold description",
                        "path": [
                            "HOLD_BASE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold type",
                        "path": [
                            "HOLD_TYPE_ID"
                        ]
                    },
                    {
                        "description": "Hold type description",
                        "path": [
                            "HOLD_TYPE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold group",
                        "path": [
                            "HOLD_GROUP_ID"
                        ]
                    },
                    {
                        "description": "Hold group description",
                        "path": [
                            "HOLD_GROUP_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Start date of hold",
                        "path": [
                            "HOLD_START_DATE"
                        ]
                    },
                    {
                        "description": "End date of hold",
                        "path": [
                            "HOLD_END_DATE"
                        ]
                    },
                    {
                        "description": "Reason for removing hold, if exisists",
                        "path": [
                            "HOLD_REMOVAL_REASON"
                        ]
                    },
                    {
                        "description": "Unique identifier for car in VISTA",
                        "path": [
                            "META_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Short vin",
                        "path": [
                            "SHORT_VIN"
                        ]
                    },
                    {
                        "description": "Full vin - cars in allocation will not have a VIN",
                        "path": [
                            "FULL_VIN"
                        ]
                    },
                    {
                        "description": "Unique identifier for an order in PLO",
                        "path": [
                            "SPECIFIC_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Identifier in MES",
                        "path": [
                            "CSO_NUMBER"
                        ]
                    },
                    {
                        "description": "Model description e.g L460 - Range Rover",
                        "path": [
                            "MODEL_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Location id of where car was assembled",
                        "path": [
                            "ASSY_LOC_ID"
                        ]
                    },
                    {
                        "description": "Name of the plant where car was build",
                        "path": [
                            "PLANT_NAME"
                        ]
                    },
                    {
                        "description": "Unique identifier for a dealer",
                        "path": [
                            "DEAL_ID"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was sent to a scrapped cars dealer",
                        "path": [
                            "VEHICLE_SCRAPPED"
                        ]
                    },
                    {
                        "description": "Indicator for cars which are assembled in other plants & shipped to India",
                        "path": [
                            "KD_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when a car was built",
                        "path": [
                            "OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car was ABSed. Note that a car can be ABSed multiple times",
                        "path": [
                            "ABS_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Accepted by Sales(ABS)",
                        "path": [
                            "FIRST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was last Accepted by Sales(ABS)",
                        "path": [
                            "LATEST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was Ready for Sales(RFS)",
                        "path": [
                            "RFS_IND"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car is a special vehicle",
                        "path": [
                            "SVO_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "FIRST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "LATEST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. If a hold is not an SVO hold it will be False",
                        "path": [
                            "_SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. All rows for an order will be true if it had SVO hold when RFSed",
                        "path": [
                            "SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "Off assembly timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Latest ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "LATEST_ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Fuel type from VISTA",
                        "path": [
                            "FUEL_TYPE"
                        ]
                    },
                    {
                        "description": "Sales channel - VISTA. e.g. Private, Fleet & Business",
                        "path": [
                            "GLOBAL_SALES_CHANNEL_DESC"
                        ]
                    },
                    {
                        "description": "Model year - VISTA ( e.g. 24MY)",
                        "path": [
                            "MODEL_YEAR_DESC"
                        ]
                    },
                    {
                        "description": "4 letter model id derived from model_description e.g. L460",
                        "path": [
                            "MODEL_ID"
                        ]
                    },
                    {
                        "description": "Adjusted_offassy_time timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_OFFASSY"
                        ]
                    },
                    {
                        "description": "Adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_ABS"
                        ]
                    },
                    {
                        "description": "Latest_adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_LATEST_ABS"
                        ]
                    },
                    {
                        "description": "Marktet for which the car is made for. Europe",
                        "path": [
                            "DEST_REGION"
                        ]
                    },
                    {
                        "description": "Region of the market for which the car is made for. e.g Italy",
                        "path": [
                            "DEST_MARKET"
                        ]
                    },
                    {
                        "description": "Brochure Model Code. e.g AJ460",
                        "path": [
                            "BMC"
                        ]
                    },
                    {
                        "description": "E.g. 2.0L Diesel I4",
                        "path": [
                            "ENGINE_FAMILY"
                        ]
                    },
                    {
                        "description": "E.g. 260JZ",
                        "path": [
                            "DPCK_CODE"
                        ]
                    },
                    {
                        "description": "E.g. SE/HSE",
                        "path": [
                            "TRIM_SPEC"
                        ]
                    },
                    {
                        "description": "Date at which WIP data needs to be looked at",
                        "path": [
                            "WIP_REPORT_DAY"
                        ]
                    },
                    {
                        "description": "Boolean used to identify if the plant was operational on the Day. Not production days are not counted in WIP age.",
                        "path": [
                            "PRODUCTION_DAY"
                        ]
                    },
                    {
                        "description": "Sudo column w/t value that is used for calculating",
                        "path": [
                            "WIP_COUNTER"
                        ]
                    },
                    {
                        "description": "Number of days car has been in WIP on a given reporting day",
                        "path": [
                            "WIP_AGE"
                        ]
                    },
                    {
                        "description": "Maximum WIP age for a given plant-model combination",
                        "path": [
                            "MAX_WIP_AGE_PLANT_MODEL"
                        ]
                    },
                    {
                        "description": "Plan / target corrosponding to table_type",
                        "path": [
                            "PLAN"
                        ]
                    },
                    {
                        "description": "Date for which data is looked at. Use this in Tableau !",
                        "path": [
                            "REPORT_DATE"
                        ]
                    },
                    {
                        "description": "One of BUILD, ABS, WIP. Tells which of the aforementioned 3 does an meta_order_number belong to for a report_date",
                        "path": [
                            "TABLE_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars build for a REPORT_DATE, MODEL_ID, ASSY_LOC_ID combination",
                        "path": [
                            "BUILD_QTY"
                        ]
                    },
                    {
                        "description": "Why loss happened which caused delta against the plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_REASON"
                        ]
                    },
                    {
                        "description": "One of \"Supplier, Quality Production, MP&L, Facilities, Systems/IT, Launch, Other, Quality Holds, Special Cause\"",
                        "path": [
                            "LOSS_CATEGORY"
                        ]
                    },
                    {
                        "description": "Timestamp of when the loss entry was modified/created",
                        "path": [
                            "LOSS_MODIFIED_TIMESTAMP"
                        ]
                    },
                    {
                        "description": "Email of entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_EMAIL"
                        ]
                    },
                    {
                        "description": "Name of the entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_NAME"
                        ]
                    },
                    {
                        "description": "Number of cars away from plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_QTY"
                        ]
                    },
                    {
                        "description": "Date on which loss happened",
                        "path": [
                            "LOSS_DATE"
                        ]
                    },
                    {
                        "description": "BUILD or ABS",
                        "path": [
                            "LOSS_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars affected by the loss for a ASSY_LOC_ID, MODEL_ID combination",
                        "path": [
                            "AFFECTED_NUMBER"
                        ]
                    },
                    {
                        "description": "320_LOSS_COMMENTARY: When was the loss last modified in the Tableau/Power App/SharePoint List",
                        "path": [
                            "MODIFIED_AT"
                        ]
                    },
                    {
                        "description": "Description of the location where the event happened",
                        "path": [
                            "EVENT_LOC_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the record is archived in D42",
                        "path": [
                            "ARCHIVE_IND"
                        ]
                    },
                    {
                        "description": "Used to identify FLEET and OUV cars in D42",
                        "path": [
                            "ARCO_ID"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was Accepted by Sales(ABS). Check ABS_IND to know the current ABS status of the car as car can be ABSed multiple times",
                        "path": [
                            "ABS_DATE"
                        ]
                    },
                    {
                        "description": "Unique identifier for an event in D42",
                        "path": [
                            "EVEN_ID"
                        ]
                    },
                    {
                        "description": "Location id of where the event happened",
                        "path": [
                            "EVENT_LOC_ID"
                        ]
                    },
                    {
                        "description": "Description of the event",
                        "path": [
                            "EVENT_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Timestap of when the event was recorded in D42",
                        "path": [
                            "LAST_UPDATED"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if car is ('OUV', 'SDV') and built in China then it will not be included in ABS for China reporting and by lineage WIP",
                        "path": [
                            "CHINA_ABS_EXCLUSION_IND"
                        ]
                    },
                    {
                        "description": "Date of the saturday of the week for REPORT_DATE",
                        "path": [
                            "REPORT_DATE_SATURDAY"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "WEEK_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production week (saturday)",
                        "path": [
                            "PRODUCTION_WEEK_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production week (friday)",
                        "path": [
                            "PRODUCTION_WEEK_END"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "MONTH_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production month (saturday)",
                        "path": [
                            "PRODUCTION_MONTH_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production month (friday)",
                        "path": [
                            "PRODUCTION_MONTH_END"
                        ]
                    },
                    {
                        "description": "Indenfier for start of production month for Tableau. Is inferred from MONTH_PER_ID in 'yymm' format to 'yyyy-mm-01'",
                        "path": [
                            "PRODUCTION_MONTH_ID"
                        ]
                    }
                ]
            },
            "dependencyTargets": [
                {
                    "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                    "name": "VEHICLE_EVENTS_V",
                    "database": "jlr-it-scanalytics-prod"
                },
                {
                    "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                    "name": "EVENTS_V",
                    "database": "jlr-it-scanalytics-prod"
                },
                {
                    "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                    "name": "LOCATIONS_V",
                    "database": "jlr-it-scanalytics-prod"
                },
                {
                    "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                    "name": "LOCATION_EVENTS_V",
                    "database": "jlr-it-scanalytics-prod"
                },
                {
                    "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                    "name": "DEALERS_V",
                    "database": "jlr-it-scanalytics-prod"
                },
                {
                    "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                    "name": "MODELS_V",
                    "database": "jlr-it-scanalytics-prod"
                },
                {
                    "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                    "name": "VEHICLE_ORDERS_V",
                    "database": "jlr-it-scanalytics-prod"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_access",
                "name": "0200_D42_EVENTS_META_DATA",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "TABLE"
        },
        {
            "type": "table",
            "target": {
                "schema": "daily_production_report_access",
                "name": "0320_LOSS_COMMENTARY",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\nWITH CTE AS (\n  SELECT\n    DATE(TIMESTAMP_ADD(TIMESTAMP(DATEAFFECTED), INTERVAL 1 HOUR)) AS LOSS_DATE\n    , AFFECTEDNUMBER                                              AS AFFECTED_NUMBER\n    , CASE\n      WHEN PLANT = 'Solihull' THEN 'SLP'\n      WHEN PLANT = 'Nitra' THEN 'NTP'\n      WHEN PLANT = 'Graz' THEN 'GZP'\n      WHEN PLANT = 'Brazil' THEN 'BRP'\n      WHEN PLANT = 'Halewood' THEN 'HWP'\n      WHEN PLANT = 'CB' THEN 'CBP'\n      WHEN PLANT = 'CJLR' THEN 'CHP'\n      WHEN PLANT = 'India' THEN 'INP'\n      ELSE PLANT\n    END                                                           AS ASSY_LOC_ID\n    , MODELCODE                                                   AS MODEL_IDS\n    , LOSSTYPE                                                    AS LOSS_TYPE\n    , LOSSCATEGORY                                                AS LOSS_CATEGORY\n    , ROOTCAUSECOMMENTARY                                         AS LOSS_REASON\n    , AUTHOR_EMAIL                                                AS CREATED_BY_EMAIL\n    , DATE(CREATED)                                               AS CREATED_AT\n    , EDITOR_EMAIL                                                AS MODIFIED_BY_EMAIL\n    , DATE(MODIFIED)                                              AS MODIFIED_AT\n  FROM `jlr-it-scanalytics-dev.daily_production_report.DPR_COMMENTARY_SHAREPOINT_LIST_RAW`\n  WHERE LOSS_COMMENTARY_LAST_UPLOADED_FORM_SHAREPOINT = (SELECT MAX(LOSS_COMMENTARY_LAST_UPLOADED_FORM_SHAREPOINT) FROM `jlr-it-scanalytics-dev.daily_production_report.DPR_COMMENTARY_SHAREPOINT_LIST_RAW`)\n)\n\n, CTE1 AS (\n  SELECT\n    *\n    , ROW_NUMBER() OVER (PARTITION BY MODEL_IDS, AFFECTED_NUMBER, MODIFIED_AT, LOSS_DATE, LOSS_CATEGORY, LOSS_TYPE) AS RN\n  FROM\n    CTE\n  , UNNEST(SPLIT(AFFECTED_NUMBER, ',')) AS _AFFECTED_NUMBER\n)\n\n, CTE2 AS (\n  SELECT\n    LOSS_DATE\n    , ASSY_LOC_ID\n    , MODEL_IDS\n    , TRIM(SPLIT(MODEL_IDS, ',')[ORDINAL(RN)]) AS MODEL_ID\n    , LOSS_TYPE\n    , LOSS_CATEGORY\n    , LOSS_REASON\n    , CAST(TRIM(_AFFECTED_NUMBER) AS INT64)    AS _AFFECTED_NUMBER\n    , MODIFIED_AT\n    , MODIFIED_BY_EMAIL\n    , AFFECTED_NUMBER\n  FROM CTE1\n)\n\nSELECT * FROM CTE2\n\n",
            "disabled": false,
            "fileName": "definitions/outputs/0320_LOSS_COMMENTARY.sqlx",
            "tags": [
                "DPR",
                "LOSS_COMMENTARY"
            ],
            "actionDescriptor": {
                "description": "Get loss commentary metadata which comes from Power App -> Sharepoint list -> Power Automate -> Google Drive -> BigQuery (scheduled)",
                "columns": [
                    {
                        "description": "Unique identifier for a car in D42",
                        "path": [
                            "VEH_ID"
                        ]
                    },
                    {
                        "description": "Unique identifier for base hold",
                        "path": [
                            "HOLD_BASE_ID"
                        ]
                    },
                    {
                        "description": "Base hold description",
                        "path": [
                            "HOLD_BASE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold type",
                        "path": [
                            "HOLD_TYPE_ID"
                        ]
                    },
                    {
                        "description": "Hold type description",
                        "path": [
                            "HOLD_TYPE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold group",
                        "path": [
                            "HOLD_GROUP_ID"
                        ]
                    },
                    {
                        "description": "Hold group description",
                        "path": [
                            "HOLD_GROUP_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Start date of hold",
                        "path": [
                            "HOLD_START_DATE"
                        ]
                    },
                    {
                        "description": "End date of hold",
                        "path": [
                            "HOLD_END_DATE"
                        ]
                    },
                    {
                        "description": "Reason for removing hold, if exisists",
                        "path": [
                            "HOLD_REMOVAL_REASON"
                        ]
                    },
                    {
                        "description": "Unique identifier for car in VISTA",
                        "path": [
                            "META_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Short vin",
                        "path": [
                            "SHORT_VIN"
                        ]
                    },
                    {
                        "description": "Full vin - cars in allocation will not have a VIN",
                        "path": [
                            "FULL_VIN"
                        ]
                    },
                    {
                        "description": "Unique identifier for an order in PLO",
                        "path": [
                            "SPECIFIC_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Identifier in MES",
                        "path": [
                            "CSO_NUMBER"
                        ]
                    },
                    {
                        "description": "Model description e.g L460 - Range Rover",
                        "path": [
                            "MODEL_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Location id of where car was assembled",
                        "path": [
                            "ASSY_LOC_ID"
                        ]
                    },
                    {
                        "description": "Name of the plant where car was build",
                        "path": [
                            "PLANT_NAME"
                        ]
                    },
                    {
                        "description": "Unique identifier for a dealer",
                        "path": [
                            "DEAL_ID"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was sent to a scrapped cars dealer",
                        "path": [
                            "VEHICLE_SCRAPPED"
                        ]
                    },
                    {
                        "description": "Indicator for cars which are assembled in other plants & shipped to India",
                        "path": [
                            "KD_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when a car was built",
                        "path": [
                            "OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car was ABSed. Note that a car can be ABSed multiple times",
                        "path": [
                            "ABS_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Accepted by Sales(ABS)",
                        "path": [
                            "FIRST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was last Accepted by Sales(ABS)",
                        "path": [
                            "LATEST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was Ready for Sales(RFS)",
                        "path": [
                            "RFS_IND"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car is a special vehicle",
                        "path": [
                            "SVO_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "FIRST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "LATEST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. If a hold is not an SVO hold it will be False",
                        "path": [
                            "_SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. All rows for an order will be true if it had SVO hold when RFSed",
                        "path": [
                            "SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "Off assembly timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Latest ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "LATEST_ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Fuel type from VISTA",
                        "path": [
                            "FUEL_TYPE"
                        ]
                    },
                    {
                        "description": "Sales channel - VISTA. e.g. Private, Fleet & Business",
                        "path": [
                            "GLOBAL_SALES_CHANNEL_DESC"
                        ]
                    },
                    {
                        "description": "Model year - VISTA ( e.g. 24MY)",
                        "path": [
                            "MODEL_YEAR_DESC"
                        ]
                    },
                    {
                        "description": "4 letter model id derived from model_description e.g. L460",
                        "path": [
                            "MODEL_ID"
                        ]
                    },
                    {
                        "description": "Adjusted_offassy_time timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_OFFASSY"
                        ]
                    },
                    {
                        "description": "Adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_ABS"
                        ]
                    },
                    {
                        "description": "Latest_adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_LATEST_ABS"
                        ]
                    },
                    {
                        "description": "Marktet for which the car is made for. Europe",
                        "path": [
                            "DEST_REGION"
                        ]
                    },
                    {
                        "description": "Region of the market for which the car is made for. e.g Italy",
                        "path": [
                            "DEST_MARKET"
                        ]
                    },
                    {
                        "description": "Brochure Model Code. e.g AJ460",
                        "path": [
                            "BMC"
                        ]
                    },
                    {
                        "description": "E.g. 2.0L Diesel I4",
                        "path": [
                            "ENGINE_FAMILY"
                        ]
                    },
                    {
                        "description": "E.g. 260JZ",
                        "path": [
                            "DPCK_CODE"
                        ]
                    },
                    {
                        "description": "E.g. SE/HSE",
                        "path": [
                            "TRIM_SPEC"
                        ]
                    },
                    {
                        "description": "Date at which WIP data needs to be looked at",
                        "path": [
                            "WIP_REPORT_DAY"
                        ]
                    },
                    {
                        "description": "Boolean used to identify if the plant was operational on the Day. Not production days are not counted in WIP age.",
                        "path": [
                            "PRODUCTION_DAY"
                        ]
                    },
                    {
                        "description": "Sudo column w/t value that is used for calculating",
                        "path": [
                            "WIP_COUNTER"
                        ]
                    },
                    {
                        "description": "Number of days car has been in WIP on a given reporting day",
                        "path": [
                            "WIP_AGE"
                        ]
                    },
                    {
                        "description": "Maximum WIP age for a given plant-model combination",
                        "path": [
                            "MAX_WIP_AGE_PLANT_MODEL"
                        ]
                    },
                    {
                        "description": "Plan / target corrosponding to table_type",
                        "path": [
                            "PLAN"
                        ]
                    },
                    {
                        "description": "Date for which data is looked at. Use this in Tableau !",
                        "path": [
                            "REPORT_DATE"
                        ]
                    },
                    {
                        "description": "One of BUILD, ABS, WIP. Tells which of the aforementioned 3 does an meta_order_number belong to for a report_date",
                        "path": [
                            "TABLE_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars build for a REPORT_DATE, MODEL_ID, ASSY_LOC_ID combination",
                        "path": [
                            "BUILD_QTY"
                        ]
                    },
                    {
                        "description": "Why loss happened which caused delta against the plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_REASON"
                        ]
                    },
                    {
                        "description": "One of \"Supplier, Quality Production, MP&L, Facilities, Systems/IT, Launch, Other, Quality Holds, Special Cause\"",
                        "path": [
                            "LOSS_CATEGORY"
                        ]
                    },
                    {
                        "description": "Timestamp of when the loss entry was modified/created",
                        "path": [
                            "LOSS_MODIFIED_TIMESTAMP"
                        ]
                    },
                    {
                        "description": "Email of entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_EMAIL"
                        ]
                    },
                    {
                        "description": "Name of the entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_NAME"
                        ]
                    },
                    {
                        "description": "Number of cars away from plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_QTY"
                        ]
                    },
                    {
                        "description": "Date on which loss happened",
                        "path": [
                            "LOSS_DATE"
                        ]
                    },
                    {
                        "description": "BUILD or ABS",
                        "path": [
                            "LOSS_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars affected by the loss for a ASSY_LOC_ID, MODEL_ID combination",
                        "path": [
                            "AFFECTED_NUMBER"
                        ]
                    },
                    {
                        "description": "320_LOSS_COMMENTARY: When was the loss last modified in the Tableau/Power App/SharePoint List",
                        "path": [
                            "MODIFIED_AT"
                        ]
                    },
                    {
                        "description": "Description of the location where the event happened",
                        "path": [
                            "EVENT_LOC_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the record is archived in D42",
                        "path": [
                            "ARCHIVE_IND"
                        ]
                    },
                    {
                        "description": "Used to identify FLEET and OUV cars in D42",
                        "path": [
                            "ARCO_ID"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was Accepted by Sales(ABS). Check ABS_IND to know the current ABS status of the car as car can be ABSed multiple times",
                        "path": [
                            "ABS_DATE"
                        ]
                    },
                    {
                        "description": "Unique identifier for an event in D42",
                        "path": [
                            "EVEN_ID"
                        ]
                    },
                    {
                        "description": "Location id of where the event happened",
                        "path": [
                            "EVENT_LOC_ID"
                        ]
                    },
                    {
                        "description": "Description of the event",
                        "path": [
                            "EVENT_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Timestap of when the event was recorded in D42",
                        "path": [
                            "LAST_UPDATED"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if car is ('OUV', 'SDV') and built in China then it will not be included in ABS for China reporting and by lineage WIP",
                        "path": [
                            "CHINA_ABS_EXCLUSION_IND"
                        ]
                    },
                    {
                        "description": "Date of the saturday of the week for REPORT_DATE",
                        "path": [
                            "REPORT_DATE_SATURDAY"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "WEEK_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production week (saturday)",
                        "path": [
                            "PRODUCTION_WEEK_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production week (friday)",
                        "path": [
                            "PRODUCTION_WEEK_END"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "MONTH_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production month (saturday)",
                        "path": [
                            "PRODUCTION_MONTH_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production month (friday)",
                        "path": [
                            "PRODUCTION_MONTH_END"
                        ]
                    },
                    {
                        "description": "Indenfier for start of production month for Tableau. Is inferred from MONTH_PER_ID in 'yymm' format to 'yyyy-mm-01'",
                        "path": [
                            "PRODUCTION_MONTH_ID"
                        ]
                    }
                ]
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "DPR_COMMENTARY_SHAREPOINT_LIST_RAW",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_access",
                "name": "0320_LOSS_COMMENTARY",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "TABLE"
        },
        {
            "type": "table",
            "target": {
                "schema": "daily_production_report_access",
                "name": "0450_ENGINES",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\nWITH ENGINES_PLAN_ACTUALS AS (\n  SELECT\n    *\n    , DENSE_RANK() OVER (PARTITION BY ASSY_LOC_ID, ENGINE, REPORT_DATE ORDER BY LAST_UPDATE_DATETIME DESC) AS RN\n  FROM `jlr-it-scanalytics-prod.daily_production_report.DPR_ENGINES_PLAN_WT_ACTUALS`\n  QUALIFY RN = 1\n)\n\n\n, ADM_PER_WEEK AS (\n  SELECT\n    TYPE_ID\n    , PER_ID\n    , DATE(PER_IN_DATE)  AS PER_IN_DATE\n    , DATE(PER_OUT_DATE) AS PER_OUT_DATE\n  FROM `jlr-it-scanalytics-prod.JLR_DL_EDW_PLO_RAW_ACCESS.ADM_PER_V`\n  WHERE TYPE_ID = 'W'\n)\n\n\n, ADM_PER_MONTH AS (\n  SELECT\n    TYPE_ID\n    , PER_ID\n    , DATE(PER_IN_DATE)  AS PER_IN_DATE\n    , DATE(PER_OUT_DATE) AS PER_OUT_DATE\n  FROM `jlr-it-scanalytics-prod.JLR_DL_EDW_PLO_RAW_ACCESS.ADM_PER_V`\n  WHERE TYPE_ID = 'P'\n)\n\n\n, FINAL_ENGINE_TABLE AS (\n  SELECT\n    *\n    , DATE_TRUNC(REPORT_DATE, WEEK (SATURDAY)) AS REPORT_DATE_SATURDAY\n  FROM ENGINES_PLAN_ACTUALS\n)\n\n\n, FINAL_ENGINES_TABLE_WT_PRODUCTION_WEEKS AS (\n  SELECT\n    F.*\n    , W.PER_ID                                                                                                                                                                     AS WEEK_PER_ID\n    , W.PER_IN_DATE                                                                                                                                                                AS PRODUCTION_WEEK_START\n    , W.PER_OUT_DATE                                                                                                                                                               AS PRODUCTION_WEEK_END\n    , M.PER_ID                                                                                                                                                                     AS MONTH_PER_ID\n    , DATE(CONCAT(20, SUBSTR(CAST(M.PER_ID AS STRING), 1, 2), '-', SUBSTR(CAST(M.PER_ID AS STRING), 3, 2), '-', 01)) AS PRODUCTION_MONTH_ID\n    , M.PER_IN_DATE                                                                                                                                                                AS PRODUCTION_MONTH_START\n    , M.PER_OUT_DATE                                                                                                                                                               AS PRODUCTION_MONTH_END\n  FROM FINAL_ENGINE_TABLE AS F\n  LEFT JOIN\n    ADM_PER_WEEK AS W\n    ON F.REPORT_DATE_SATURDAY = W.PER_IN_DATE\n  LEFT JOIN\n    ADM_PER_MONTH AS M\n    ON F.REPORT_DATE_SATURDAY BETWEEN M.PER_IN_DATE AND M.PER_OUT_DATE\n)\n\n\nSELECT *\n\nFROM FINAL_ENGINES_TABLE_WT_PRODUCTION_WEEKS\nWHERE REPORT_DATE >= '2024-04-27'\n\n",
            "disabled": false,
            "fileName": "definitions/outputs/0450_ENGINES.sqlx",
            "tags": [
                "DPR",
                "ENGINES"
            ],
            "actionDescriptor": {
                "description": "To get latest uploaded engines Plan and Actuals by solihull vehicle scheduling with Production Calendar",
                "columns": [
                    {
                        "description": "Unique identifier for a car in D42",
                        "path": [
                            "VEH_ID"
                        ]
                    },
                    {
                        "description": "Unique identifier for base hold",
                        "path": [
                            "HOLD_BASE_ID"
                        ]
                    },
                    {
                        "description": "Base hold description",
                        "path": [
                            "HOLD_BASE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold type",
                        "path": [
                            "HOLD_TYPE_ID"
                        ]
                    },
                    {
                        "description": "Hold type description",
                        "path": [
                            "HOLD_TYPE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold group",
                        "path": [
                            "HOLD_GROUP_ID"
                        ]
                    },
                    {
                        "description": "Hold group description",
                        "path": [
                            "HOLD_GROUP_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Start date of hold",
                        "path": [
                            "HOLD_START_DATE"
                        ]
                    },
                    {
                        "description": "End date of hold",
                        "path": [
                            "HOLD_END_DATE"
                        ]
                    },
                    {
                        "description": "Reason for removing hold, if exisists",
                        "path": [
                            "HOLD_REMOVAL_REASON"
                        ]
                    },
                    {
                        "description": "Unique identifier for car in VISTA",
                        "path": [
                            "META_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Short vin",
                        "path": [
                            "SHORT_VIN"
                        ]
                    },
                    {
                        "description": "Full vin - cars in allocation will not have a VIN",
                        "path": [
                            "FULL_VIN"
                        ]
                    },
                    {
                        "description": "Unique identifier for an order in PLO",
                        "path": [
                            "SPECIFIC_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Identifier in MES",
                        "path": [
                            "CSO_NUMBER"
                        ]
                    },
                    {
                        "description": "Model description e.g L460 - Range Rover",
                        "path": [
                            "MODEL_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Location id of where car was assembled",
                        "path": [
                            "ASSY_LOC_ID"
                        ]
                    },
                    {
                        "description": "Name of the plant where car was build",
                        "path": [
                            "PLANT_NAME"
                        ]
                    },
                    {
                        "description": "Unique identifier for a dealer",
                        "path": [
                            "DEAL_ID"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was sent to a scrapped cars dealer",
                        "path": [
                            "VEHICLE_SCRAPPED"
                        ]
                    },
                    {
                        "description": "Indicator for cars which are assembled in other plants & shipped to India",
                        "path": [
                            "KD_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when a car was built",
                        "path": [
                            "OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car was ABSed. Note that a car can be ABSed multiple times",
                        "path": [
                            "ABS_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Accepted by Sales(ABS)",
                        "path": [
                            "FIRST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was last Accepted by Sales(ABS)",
                        "path": [
                            "LATEST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was Ready for Sales(RFS)",
                        "path": [
                            "RFS_IND"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car is a special vehicle",
                        "path": [
                            "SVO_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "FIRST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "LATEST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. If a hold is not an SVO hold it will be False",
                        "path": [
                            "_SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. All rows for an order will be true if it had SVO hold when RFSed",
                        "path": [
                            "SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "Off assembly timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Latest ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "LATEST_ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Fuel type from VISTA",
                        "path": [
                            "FUEL_TYPE"
                        ]
                    },
                    {
                        "description": "Sales channel - VISTA. e.g. Private, Fleet & Business",
                        "path": [
                            "GLOBAL_SALES_CHANNEL_DESC"
                        ]
                    },
                    {
                        "description": "Model year - VISTA ( e.g. 24MY)",
                        "path": [
                            "MODEL_YEAR_DESC"
                        ]
                    },
                    {
                        "description": "4 letter model id derived from model_description e.g. L460",
                        "path": [
                            "MODEL_ID"
                        ]
                    },
                    {
                        "description": "Adjusted_offassy_time timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_OFFASSY"
                        ]
                    },
                    {
                        "description": "Adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_ABS"
                        ]
                    },
                    {
                        "description": "Latest_adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_LATEST_ABS"
                        ]
                    },
                    {
                        "description": "Marktet for which the car is made for. Europe",
                        "path": [
                            "DEST_REGION"
                        ]
                    },
                    {
                        "description": "Region of the market for which the car is made for. e.g Italy",
                        "path": [
                            "DEST_MARKET"
                        ]
                    },
                    {
                        "description": "Brochure Model Code. e.g AJ460",
                        "path": [
                            "BMC"
                        ]
                    },
                    {
                        "description": "E.g. 2.0L Diesel I4",
                        "path": [
                            "ENGINE_FAMILY"
                        ]
                    },
                    {
                        "description": "E.g. 260JZ",
                        "path": [
                            "DPCK_CODE"
                        ]
                    },
                    {
                        "description": "E.g. SE/HSE",
                        "path": [
                            "TRIM_SPEC"
                        ]
                    },
                    {
                        "description": "Date at which WIP data needs to be looked at",
                        "path": [
                            "WIP_REPORT_DAY"
                        ]
                    },
                    {
                        "description": "Boolean used to identify if the plant was operational on the Day. Not production days are not counted in WIP age.",
                        "path": [
                            "PRODUCTION_DAY"
                        ]
                    },
                    {
                        "description": "Sudo column w/t value that is used for calculating",
                        "path": [
                            "WIP_COUNTER"
                        ]
                    },
                    {
                        "description": "Number of days car has been in WIP on a given reporting day",
                        "path": [
                            "WIP_AGE"
                        ]
                    },
                    {
                        "description": "Maximum WIP age for a given plant-model combination",
                        "path": [
                            "MAX_WIP_AGE_PLANT_MODEL"
                        ]
                    },
                    {
                        "description": "Plan / target corrosponding to table_type",
                        "path": [
                            "PLAN"
                        ]
                    },
                    {
                        "description": "Date for which data is looked at. Use this in Tableau !",
                        "path": [
                            "REPORT_DATE"
                        ]
                    },
                    {
                        "description": "One of BUILD, ABS, WIP. Tells which of the aforementioned 3 does an meta_order_number belong to for a report_date",
                        "path": [
                            "TABLE_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars build for a REPORT_DATE, MODEL_ID, ASSY_LOC_ID combination",
                        "path": [
                            "BUILD_QTY"
                        ]
                    },
                    {
                        "description": "Why loss happened which caused delta against the plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_REASON"
                        ]
                    },
                    {
                        "description": "One of \"Supplier, Quality Production, MP&L, Facilities, Systems/IT, Launch, Other, Quality Holds, Special Cause\"",
                        "path": [
                            "LOSS_CATEGORY"
                        ]
                    },
                    {
                        "description": "Timestamp of when the loss entry was modified/created",
                        "path": [
                            "LOSS_MODIFIED_TIMESTAMP"
                        ]
                    },
                    {
                        "description": "Email of entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_EMAIL"
                        ]
                    },
                    {
                        "description": "Name of the entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_NAME"
                        ]
                    },
                    {
                        "description": "Number of cars away from plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_QTY"
                        ]
                    },
                    {
                        "description": "Date on which loss happened",
                        "path": [
                            "LOSS_DATE"
                        ]
                    },
                    {
                        "description": "BUILD or ABS",
                        "path": [
                            "LOSS_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars affected by the loss for a ASSY_LOC_ID, MODEL_ID combination",
                        "path": [
                            "AFFECTED_NUMBER"
                        ]
                    },
                    {
                        "description": "320_LOSS_COMMENTARY: When was the loss last modified in the Tableau/Power App/SharePoint List",
                        "path": [
                            "MODIFIED_AT"
                        ]
                    },
                    {
                        "description": "Description of the location where the event happened",
                        "path": [
                            "EVENT_LOC_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the record is archived in D42",
                        "path": [
                            "ARCHIVE_IND"
                        ]
                    },
                    {
                        "description": "Used to identify FLEET and OUV cars in D42",
                        "path": [
                            "ARCO_ID"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was Accepted by Sales(ABS). Check ABS_IND to know the current ABS status of the car as car can be ABSed multiple times",
                        "path": [
                            "ABS_DATE"
                        ]
                    },
                    {
                        "description": "Unique identifier for an event in D42",
                        "path": [
                            "EVEN_ID"
                        ]
                    },
                    {
                        "description": "Location id of where the event happened",
                        "path": [
                            "EVENT_LOC_ID"
                        ]
                    },
                    {
                        "description": "Description of the event",
                        "path": [
                            "EVENT_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Timestap of when the event was recorded in D42",
                        "path": [
                            "LAST_UPDATED"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if car is ('OUV', 'SDV') and built in China then it will not be included in ABS for China reporting and by lineage WIP",
                        "path": [
                            "CHINA_ABS_EXCLUSION_IND"
                        ]
                    },
                    {
                        "description": "Date of the saturday of the week for REPORT_DATE",
                        "path": [
                            "REPORT_DATE_SATURDAY"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "WEEK_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production week (saturday)",
                        "path": [
                            "PRODUCTION_WEEK_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production week (friday)",
                        "path": [
                            "PRODUCTION_WEEK_END"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "MONTH_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production month (saturday)",
                        "path": [
                            "PRODUCTION_MONTH_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production month (friday)",
                        "path": [
                            "PRODUCTION_MONTH_END"
                        ]
                    },
                    {
                        "description": "Indenfier for start of production month for Tableau. Is inferred from MONTH_PER_ID in 'yymm' format to 'yyyy-mm-01'",
                        "path": [
                            "PRODUCTION_MONTH_ID"
                        ]
                    }
                ]
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "DPR_ENGINES_PLAN_WT_ACTUALS",
                    "database": "jlr-it-scanalytics-prod"
                },
                {
                    "schema": "JLR_DL_EDW_PLO_RAW_ACCESS",
                    "name": "ADM_PER_V",
                    "database": "jlr-it-scanalytics-prod"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_access",
                "name": "0450_ENGINES",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "TABLE"
        },
        {
            "type": "table",
            "target": {
                "schema": "daily_production_report_access",
                "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\nWITH BUILD_ABS_WIP_TARGETS AS (\n  SELECT * FROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\n)\n\n, WIP_TABLE AS (\n  SELECT * FROM `jlr-it-scanalytics-dev.daily_production_report.0400_WIP_HISTORY`\n  UNION ALL\n  SELECT * FROM `jlr-it-scanalytics-dev.daily_production_report.0450_INDIA_WIP_HISTORY`\n)\n\n, BUILD_ABS_WIP_LOSS_REASONS AS (\n  SELECT * FROM `jlr-it-scanalytics-dev.daily_production_report_access.0320_LOSS_COMMENTARY`\n)\n\n, BUILD_LOSS_REASONS AS (\n  SELECT * FROM BUILD_ABS_WIP_LOSS_REASONS WHERE LOSS_TYPE = 'BUILD'\n)\n\n, ABS_LOSS_REASONS AS (\n  SELECT * FROM BUILD_ABS_WIP_LOSS_REASONS WHERE LOSS_TYPE = 'ABS'\n)\n\n, WIP_LOSS_REASONS AS (\n  SELECT * FROM BUILD_ABS_WIP_LOSS_REASONS WHERE LOSS_TYPE = 'WIP'\n)\n\n, BUILD_INDIA_ACTUALS AS (\n  SELECT * FROM `jlr-it-scanalytics-dev.daily_production_report.0150_INDIA_ACTUALS`\n  WHERE TABLE_TYPE = 'BUILD'\n)\n\n, ABS_INDIA_ACTUALS AS (\n  SELECT * FROM `jlr-it-scanalytics-dev.daily_production_report.0150_INDIA_ACTUALS`\n  WHERE TABLE_TYPE = 'ABS'\n)\n\n, ALL_PLANTS_BUILD AS (\n  SELECT\n    META_ORDER_NUMBER\n    , FULL_VIN\n    , ADJUSTED_REPORT_DATE_OFFASSY AS REPORT_DATE\n    , SVO_IND\n    , ABS_IND\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SALES_MODEL_DESC\n    , MODEL_YEAR_DESC\n    , ENGINE_FAMILY\n    , DPCK_CODE\n    , TRIM_SPEC\n    , FUEL_TYPE\n    , GLOBAL_SALES_CHANNEL_DESC\n    , DEST_REGION\n    , DEST_MARKET\n  FROM `jlr-it-scanalytics-dev.daily_production_report.0300_PRODUCTION_DATA_DPR`\n  UNION ALL\n  SELECT\n    META_ORDER_NUMBER\n    , FULL_VIN\n    , REPORT_DATE\n    , SVO_IND\n    , ABS_IND\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SALES_MODEL_DESC\n    , MODEL_YEAR_DESC\n    , ENGINE_FAMILY\n    , DPCK_CODE\n    , TRIM_SPEC\n    , FUEL_TYPE\n    , GLOBAL_SALES_CHANNEL_DESC\n    , DEST_REGION\n    , DEST_MARKET\n  FROM BUILD_INDIA_ACTUALS\n)\n\n, ALL_PLANTS_ABS AS (\n  SELECT\n    META_ORDER_NUMBER\n    , FULL_VIN\n    , ADJUSTED_REPORT_DATE_ABS AS REPORT_DATE\n    , SVO_IND\n    , ABS_IND\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SALES_MODEL_DESC\n    , MODEL_YEAR_DESC\n    , ENGINE_FAMILY\n    , DPCK_CODE\n    , TRIM_SPEC\n    , FUEL_TYPE\n    , GLOBAL_SALES_CHANNEL_DESC\n    , DEST_REGION\n    , DEST_MARKET\n    , CHINA_ABS_EXCLUSION_IND\n  FROM `jlr-it-scanalytics-dev.daily_production_report.0300_PRODUCTION_DATA_DPR`\n  UNION ALL\n  SELECT\n    META_ORDER_NUMBER\n    , FULL_VIN\n    , REPORT_DATE\n    , SVO_IND\n    , ABS_IND\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SALES_MODEL_DESC\n    , MODEL_YEAR_DESC\n    , ENGINE_FAMILY\n    , DPCK_CODE\n    , TRIM_SPEC\n    , FUEL_TYPE\n    , GLOBAL_SALES_CHANNEL_DESC\n    , DEST_REGION\n    , DEST_MARKET\n    , CHINA_ABS_EXCLUSION_IND\n  FROM ABS_INDIA_ACTUALS\n)\n\n\n, ADM_PER_WEEK AS (\n  SELECT\n    TYPE_ID\n    , PER_ID\n    , DATE(PER_IN_DATE)  AS PER_IN_DATE\n    , DATE(PER_OUT_DATE) AS PER_OUT_DATE\n  FROM `jlr-it-scanalytics-prod.JLR_DL_EDW_PLO_RAW_ACCESS.ADM_PER_V`\n  WHERE TYPE_ID = 'W'\n)\n\n, ADM_PER_MONTH AS (\n  SELECT\n    TYPE_ID\n    , PER_ID\n    , DATE(PER_IN_DATE)  AS PER_IN_DATE\n    , DATE(PER_OUT_DATE) AS PER_OUT_DATE\n  FROM `jlr-it-scanalytics-prod.JLR_DL_EDW_PLO_RAW_ACCESS.ADM_PER_V`\n  WHERE TYPE_ID = 'P'\n)\n\n\n, _BUILD_TABLE_WT_PLAN AS (\n  SELECT\n    META_ORDER_NUMBER\n    , FULL_VIN\n    , ABS_IND\n    , SVO_IND\n    , COALESCE(A.MODEL_ID, P.MODEL_ID)                                                                     AS MODEL_ID\n    , MODEL_YEAR_DESC\n    , COALESCE(A.SALES_MODEL_DESC, P.SALES_MODEL_DESC)                                                     AS SALES_MODEL_DESC\n    , ENGINE_FAMILY\n    , DPCK_CODE\n    , TRIM_SPEC\n    , FUEL_TYPE\n    , GLOBAL_SALES_CHANNEL_DESC\n    , DEST_REGION\n    , DEST_MARKET\n    , COALESCE(A.ASSY_LOC_ID, P.ASSY_LOC_ID)                                                               AS ASSY_LOC_ID\n    , COALESCE(P.BUILD_TARGET, Q.BUILD_TARGET)                                                             AS PLAN\n    , COALESCE(A.REPORT_DATE, P.REPORT_DATE)                                                               AS REPORT_DATE\n    , COUNT(DISTINCT META_ORDER_NUMBER) OVER (PARTITION BY DATE(A.REPORT_DATE), A.MODEL_ID, A.ASSY_LOC_ID) AS BUILD_QTY\n    , LOSS_REASON\n    , LOSS_CATEGORY\n    , MODIFIED_AT                                                                                          AS LOSS_MODIFIED_TIMESTAMP\n    , MODIFIED_BY_EMAIL                                                                                    AS LOSS_MODIFIED_BY_EMAIL\n    , _AFFECTED_NUMBER                                                                                     AS LOSS_QTY\n    , 'BUILD'                                                                                              AS TABLE_TYPE\n  FROM ALL_PLANTS_BUILD AS A\n  FULL OUTER JOIN\n    BUILD_ABS_WIP_TARGETS AS P\n    ON A.REPORT_DATE = P.REPORT_DATE\n    AND A.ASSY_LOC_ID = P.ASSY_LOC_ID\n    AND A.MODEL_ID = P.MODEL_ID\n    AND A.SALES_MODEL_DESC = P.SALES_MODEL_DESC\n  FULL OUTER JOIN\n    BUILD_ABS_WIP_TARGETS AS Q\n    ON A.REPORT_DATE = Q.REPORT_DATE\n    AND A.ASSY_LOC_ID = Q.ASSY_LOC_ID\n    AND A.MODEL_ID = Q.MODEL_ID\n  FULL OUTER JOIN\n    BUILD_LOSS_REASONS AS R\n    ON Q.REPORT_DATE = R.LOSS_DATE\n    AND Q.ASSY_LOC_ID = R.ASSY_LOC_ID\n    AND Q.MODEL_ID = R.MODEL_ID\n)\n\n, BUILD_TABLE_WT_PLAN AS (\n  SELECT\n    *\n    , COUNT(META_ORDER_NUMBER) OVER (PARTITION BY ASSY_LOC_ID, MODEL_ID, REPORT_DATE) AS CNT\n  FROM _BUILD_TABLE_WT_PLAN WHERE 1 = 1\n  QUALIFY NOT (CNT > 0 AND META_ORDER_NUMBER IS NULL AND SALES_MODEL_DESC IS NULL)\n)\n\n, BUILD_PLAN_WT_QTY AS (\n  SELECT DISTINCT\n    REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , BUILD_QTY\n    , PLAN\n  FROM BUILD_TABLE_WT_PLAN\n)\n\n, ABS_TABLE_WT_CHINA_FILTER AS (\n  SELECT * FROM ALL_PLANTS_ABS WHERE 1 = 1\n    AND CHINA_ABS_EXCLUSION_IND = FALSE\n)\n\n, _ABS_TABLE_WT_PLAN AS (\n  SELECT\n    META_ORDER_NUMBER\n    , FULL_VIN\n    , ABS_IND\n    , SVO_IND\n    , COALESCE(A.MODEL_ID, P.MODEL_ID)                 AS MODEL_ID\n    , MODEL_YEAR_DESC\n    , COALESCE(A.SALES_MODEL_DESC, P.SALES_MODEL_DESC) AS SALES_MODEL_DESC\n    , ENGINE_FAMILY\n    , DPCK_CODE\n    , TRIM_SPEC\n    , FUEL_TYPE\n    , GLOBAL_SALES_CHANNEL_DESC\n    , DEST_REGION\n    , DEST_MARKET\n    , COALESCE(A.ASSY_LOC_ID, P.ASSY_LOC_ID)           AS ASSY_LOC_ID\n    , COALESCE(P.ABS_TARGET, Q.ABS_TARGET)             AS PLAN\n    , COALESCE(A.REPORT_DATE, P.REPORT_DATE)           AS REPORT_DATE\n    , LOSS_REASON\n    , LOSS_CATEGORY\n    , MODIFIED_AT                                      AS LOSS_MODIFIED_TIMESTAMP\n    , MODIFIED_BY_EMAIL\n      AS LOSS_MODIFIED_BY_EMAIL\n    -- MODIFIED_BY_NAME AS LOSS_MODIFIED_BY_NAME,\n    , _AFFECTED_NUMBER                                 AS LOSS_QTY\n    , 'ABS'                                            AS TABLE_TYPE\n  FROM ABS_TABLE_WT_CHINA_FILTER AS A\n  FULL OUTER JOIN\n    BUILD_ABS_WIP_TARGETS AS P\n    ON A.REPORT_DATE = P.REPORT_DATE\n    AND A.ASSY_LOC_ID = P.ASSY_LOC_ID\n    AND A.MODEL_ID = P.MODEL_ID\n    AND A.SALES_MODEL_DESC = P.SALES_MODEL_DESC\n  FULL OUTER JOIN\n    BUILD_ABS_WIP_TARGETS AS Q\n    ON A.REPORT_DATE = Q.REPORT_DATE\n    AND A.ASSY_LOC_ID = Q.ASSY_LOC_ID\n    AND A.MODEL_ID = Q.MODEL_ID\n  FULL OUTER JOIN\n    BUILD_LOSS_REASONS AS R\n    ON Q.REPORT_DATE = R.LOSS_DATE\n    AND Q.ASSY_LOC_ID = R.ASSY_LOC_ID\n    AND Q.MODEL_ID = R.MODEL_ID\n)\n\n\n\n, ABS_TABLE_WT_DYNAMIC_PLAN AS (\n  SELECT DISTINCT\n    A.META_ORDER_NUMBER\n    , A.FULL_VIN\n    , A.ABS_IND\n    , A.SVO_IND\n    , A.MODEL_ID\n    , A.MODEL_YEAR_DESC\n    , A.SALES_MODEL_DESC\n    , A.ENGINE_FAMILY\n    , A.DPCK_CODE\n    , A.TRIM_SPEC\n    , A.FUEL_TYPE\n    , A.GLOBAL_SALES_CHANNEL_DESC\n    , A.DEST_REGION\n    , A.DEST_MARKET\n    , A.ASSY_LOC_ID\n    , CASE\n      WHEN A.ASSY_LOC_ID != 'SLP' THEN A.PLAN\n      WHEN A.ASSY_LOC_ID = 'SLP' AND A.REPORT_DATE >= '2024-02-26' THEN B.PLAN\n      -- The below conditions are needed to preserve history of what the plans used to be before the aforementioned case statements\n      WHEN A.REPORT_DATE < CURRENT_DATE() AND EXTRACT(DAYOFWEEK FROM A.REPORT_DATE) = 6 THEN CAST(0.85 * B.BUILD_QTY AS INT64)\n      WHEN A.REPORT_DATE < CURRENT_DATE() AND EXTRACT(DAYOFWEEK FROM A.REPORT_DATE) IN (1, 2, 3, 4, 5, 7) THEN CAST(0.98 * B.BUILD_QTY AS INT64)\n      WHEN A.REPORT_DATE >= CURRENT_DATE() AND EXTRACT(DAYOFWEEK FROM A.REPORT_DATE) = 6 THEN CAST(0.85 * B.PLAN AS INT64)\n      WHEN A.REPORT_DATE >= CURRENT_DATE() AND EXTRACT(DAYOFWEEK FROM A.REPORT_DATE) IN (1, 2, 3, 4, 5, 7) THEN CAST(0.98 * B.PLAN AS INT64)\n    END           AS PLAN\n    , A.REPORT_DATE\n    , B.BUILD_QTY AS BUILD_QTY\n    , A.LOSS_REASON\n    , A.LOSS_CATEGORY\n    , A.LOSS_MODIFIED_TIMESTAMP\n    , A.LOSS_MODIFIED_BY_EMAIL\n    -- a.LOSS_MODIFIED_BY_NAME,\n    , A.LOSS_QTY\n    , A.TABLE_TYPE\n  FROM _ABS_TABLE_WT_PLAN AS A\n  LEFT JOIN\n    BUILD_PLAN_WT_QTY AS B\n    USING (REPORT_DATE, MODEL_ID, ASSY_LOC_ID)\n)\n\n, ABS_TABLE_WT_PLAN AS (\n  SELECT\n    *\n    , COUNT(META_ORDER_NUMBER) OVER (PARTITION BY ASSY_LOC_ID, MODEL_ID, REPORT_DATE) AS CNT\n  FROM ABS_TABLE_WT_DYNAMIC_PLAN WHERE 1 = 1\n  QUALIFY NOT (CNT > 0 AND META_ORDER_NUMBER IS NULL AND SALES_MODEL_DESC IS NULL)\n)\n\n\n, _WIP_TABLE_WT_PLAN AS (\n  SELECT\n    META_ORDER_NUMBER\n    , FULL_VIN\n    , ABS_IND\n    , SVO_IND\n    , COALESCE(W.MODEL_ID, P.MODEL_ID)                 AS MODEL_ID\n    , MODEL_YEAR_DESC\n    , COALESCE(W.SALES_MODEL_DESC, P.SALES_MODEL_DESC) AS SALES_MODEL_DESC\n    , ENGINE_FAMILY\n    , DPCK_CODE\n    , TRIM_SPEC\n    , FUEL_TYPE\n    , GLOBAL_SALES_CHANNEL_DESC\n    , DEST_REGION\n    , DEST_MARKET\n    , COALESCE(W.ASSY_LOC_ID, P.ASSY_LOC_ID)           AS ASSY_LOC_ID\n    , COALESCE(P.WIP_TARGET, Q.WIP_TARGET)             AS PLAN\n    , COALESCE(WIP_REPORT_DAY, P.REPORT_DATE)          AS REPORT_DATE\n    , NULL                                             AS BUILD_QTY\n    , LOSS_REASON\n    , LOSS_CATEGORY\n    , MODIFIED_AT                                      AS LOSS_MODIFIED_TIMESTAMP\n    , MODIFIED_BY_EMAIL\n      AS LOSS_MODIFIED_BY_EMAIL\n    -- MODIFIED_BY_NAME AS LOSS_MODIFIED_BY_NAME,\n    , _AFFECTED_NUMBER                                 AS LOSS_QTY\n    , 'WIP'                                            AS TABLE_TYPE\n  FROM WIP_TABLE AS W\n  FULL OUTER JOIN\n    BUILD_ABS_WIP_TARGETS AS P\n    ON W.WIP_REPORT_DAY = P.REPORT_DATE\n    AND W.ASSY_LOC_ID = P.ASSY_LOC_ID\n    AND W.MODEL_ID = P.MODEL_ID\n    AND W.SALES_MODEL_DESC = P.SALES_MODEL_DESC\n  FULL OUTER JOIN\n    BUILD_ABS_WIP_TARGETS AS Q\n    ON W.WIP_REPORT_DAY = Q.REPORT_DATE\n    AND W.ASSY_LOC_ID = Q.ASSY_LOC_ID\n    AND W.MODEL_ID = Q.MODEL_ID\n  FULL OUTER JOIN\n    BUILD_LOSS_REASONS AS R\n    ON Q.REPORT_DATE = R.LOSS_DATE\n    AND Q.ASSY_LOC_ID = R.ASSY_LOC_ID\n    AND Q.MODEL_ID = R.MODEL_ID\n\n)\n\n, WIP_TABLE_WT_PLAN AS (\n  SELECT\n    *\n    , COUNT(META_ORDER_NUMBER) OVER (PARTITION BY ASSY_LOC_ID, MODEL_ID, REPORT_DATE) AS CNT\n  FROM _WIP_TABLE_WT_PLAN\n  QUALIFY NOT (CNT > 0 AND META_ORDER_NUMBER IS NULL AND SALES_MODEL_DESC IS NULL)\n)\n\n, FINAL_PROD_TABLE AS (\n\n  SELECT\n    *\n    , DATE_TRUNC(REPORT_DATE, WEEK (SATURDAY)) AS REPORT_DATE_SATURDAY\n  FROM BUILD_TABLE_WT_PLAN\n\n  UNION ALL\n\n  SELECT\n    *\n    , DATE_TRUNC(REPORT_DATE, WEEK (SATURDAY)) AS REPORT_DATE_SATURDAY\n  FROM ABS_TABLE_WT_PLAN\n\n  UNION ALL\n\n  SELECT\n    *\n    , DATE_TRUNC(REPORT_DATE, WEEK (SATURDAY)) AS REPORT_DATE_SATURDAY\n  FROM WIP_TABLE_WT_PLAN\n\n)\n\n, FINAL_PROD_TABLE_WT_PRODUCTION_WEEKS AS (\n  SELECT\n    F.*\n    , W.PER_ID                                                                                                                                                                     AS WEEK_PER_ID\n    , W.PER_IN_DATE                                                                                                                                                                AS PRODUCTION_WEEK_START\n    , W.PER_OUT_DATE                                                                                                                                                               AS PRODUCTION_WEEK_END\n    , M.PER_ID                                                                                                                                                                     AS MONTH_PER_ID\n    -- PRODUCTION_MONTH_ID -->>  20yy-mm-01\n    , DATE(CONCAT(20, SUBSTR(CAST(M.PER_ID AS STRING), 1, 2), '-', SUBSTR(CAST(M.PER_ID AS STRING), 3, 2), '-', 01)) AS PRODUCTION_MONTH_ID\n    , M.PER_IN_DATE                                                                                                                                                                AS PRODUCTION_MONTH_START\n    , M.PER_OUT_DATE                                                                                                                                                               AS PRODUCTION_MONTH_END\n  FROM FINAL_PROD_TABLE AS F\n  LEFT JOIN\n    ADM_PER_WEEK AS W\n    ON F.REPORT_DATE_SATURDAY = W.PER_IN_DATE\n  LEFT JOIN\n    ADM_PER_MONTH AS M\n    ON F.REPORT_DATE_SATURDAY BETWEEN M.PER_IN_DATE AND M.PER_OUT_DATE\n)\n\nSELECT\n  *\n  , CURRENT_DATETIME() AS TABLE_RUN_DATETIME\nFROM FINAL_PROD_TABLE_WT_PRODUCTION_WEEKS\nWHERE REPORT_DATE > '2023-03-30'\n\n",
            "disabled": false,
            "fileName": "definitions/outputs/0500_DPR_BUILD_ABS_WIP_TABLEAU.sqlx",
            "bigquery": {
                "partitionBy": "report_date",
                "clusterBy": [
                    "table_type",
                    "assy_loc_id"
                ]
            },
            "tags": [
                "DPR",
                "FINAL"
            ],
            "actionDescriptor": {
                "description": "Build, ABS, WIP data can be queried on a single table on a single date column",
                "columns": [
                    {
                        "description": "Unique identifier for a car in D42",
                        "path": [
                            "VEH_ID"
                        ]
                    },
                    {
                        "description": "Unique identifier for base hold",
                        "path": [
                            "HOLD_BASE_ID"
                        ]
                    },
                    {
                        "description": "Base hold description",
                        "path": [
                            "HOLD_BASE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold type",
                        "path": [
                            "HOLD_TYPE_ID"
                        ]
                    },
                    {
                        "description": "Hold type description",
                        "path": [
                            "HOLD_TYPE_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Unique identifier for hold group",
                        "path": [
                            "HOLD_GROUP_ID"
                        ]
                    },
                    {
                        "description": "Hold group description",
                        "path": [
                            "HOLD_GROUP_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Start date of hold",
                        "path": [
                            "HOLD_START_DATE"
                        ]
                    },
                    {
                        "description": "End date of hold",
                        "path": [
                            "HOLD_END_DATE"
                        ]
                    },
                    {
                        "description": "Reason for removing hold, if exisists",
                        "path": [
                            "HOLD_REMOVAL_REASON"
                        ]
                    },
                    {
                        "description": "Unique identifier for car in VISTA",
                        "path": [
                            "META_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Short vin",
                        "path": [
                            "SHORT_VIN"
                        ]
                    },
                    {
                        "description": "Full vin - cars in allocation will not have a VIN",
                        "path": [
                            "FULL_VIN"
                        ]
                    },
                    {
                        "description": "Unique identifier for an order in PLO",
                        "path": [
                            "SPECIFIC_ORDER_NUMBER"
                        ]
                    },
                    {
                        "description": "Identifier in MES",
                        "path": [
                            "CSO_NUMBER"
                        ]
                    },
                    {
                        "description": "Model description e.g L460 - Range Rover",
                        "path": [
                            "MODEL_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Location id of where car was assembled",
                        "path": [
                            "ASSY_LOC_ID"
                        ]
                    },
                    {
                        "description": "Name of the plant where car was build",
                        "path": [
                            "PLANT_NAME"
                        ]
                    },
                    {
                        "description": "Unique identifier for a dealer",
                        "path": [
                            "DEAL_ID"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was sent to a scrapped cars dealer",
                        "path": [
                            "VEHICLE_SCRAPPED"
                        ]
                    },
                    {
                        "description": "Indicator for cars which are assembled in other plants & shipped to India",
                        "path": [
                            "KD_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when a car was built",
                        "path": [
                            "OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car was ABSed. Note that a car can be ABSed multiple times",
                        "path": [
                            "ABS_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Accepted by Sales(ABS)",
                        "path": [
                            "FIRST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was last Accepted by Sales(ABS)",
                        "path": [
                            "LATEST_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the car was Ready for Sales(RFS)",
                        "path": [
                            "RFS_IND"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if a car is a special vehicle",
                        "path": [
                            "SVO_IND"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "FIRST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was first Ready for Sales(RFS)",
                        "path": [
                            "LATEST_RFS_DATE"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. If a hold is not an SVO hold it will be False",
                        "path": [
                            "_SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "If SVO hold was applied when it was RFSed. All rows for an order will be true if it had SVO hold when RFSed",
                        "path": [
                            "SVO_HOLD_WHEN_RFSED"
                        ]
                    },
                    {
                        "description": "Off assembly timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_OFFASSY_TIME"
                        ]
                    },
                    {
                        "description": "ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Latest ABS timestamp adjusted for reporting hours in UTC",
                        "path": [
                            "LATEST_ADJUSTED_ABS_DATE"
                        ]
                    },
                    {
                        "description": "Fuel type from VISTA",
                        "path": [
                            "FUEL_TYPE"
                        ]
                    },
                    {
                        "description": "Sales channel - VISTA. e.g. Private, Fleet & Business",
                        "path": [
                            "GLOBAL_SALES_CHANNEL_DESC"
                        ]
                    },
                    {
                        "description": "Model year - VISTA ( e.g. 24MY)",
                        "path": [
                            "MODEL_YEAR_DESC"
                        ]
                    },
                    {
                        "description": "4 letter model id derived from model_description e.g. L460",
                        "path": [
                            "MODEL_ID"
                        ]
                    },
                    {
                        "description": "Adjusted_offassy_time timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_OFFASSY"
                        ]
                    },
                    {
                        "description": "Adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_ABS"
                        ]
                    },
                    {
                        "description": "Latest_adjusted_abs_date timestamp adjusted to align with each plants individual reporting hours, *mostly 6AM to 6AM",
                        "path": [
                            "ADJUSTED_REPORT_DATE_LATEST_ABS"
                        ]
                    },
                    {
                        "description": "Marktet for which the car is made for. Europe",
                        "path": [
                            "DEST_REGION"
                        ]
                    },
                    {
                        "description": "Region of the market for which the car is made for. e.g Italy",
                        "path": [
                            "DEST_MARKET"
                        ]
                    },
                    {
                        "description": "Brochure Model Code. e.g AJ460",
                        "path": [
                            "BMC"
                        ]
                    },
                    {
                        "description": "E.g. 2.0L Diesel I4",
                        "path": [
                            "ENGINE_FAMILY"
                        ]
                    },
                    {
                        "description": "E.g. 260JZ",
                        "path": [
                            "DPCK_CODE"
                        ]
                    },
                    {
                        "description": "E.g. SE/HSE",
                        "path": [
                            "TRIM_SPEC"
                        ]
                    },
                    {
                        "description": "Date at which WIP data needs to be looked at",
                        "path": [
                            "WIP_REPORT_DAY"
                        ]
                    },
                    {
                        "description": "Boolean used to identify if the plant was operational on the Day. Not production days are not counted in WIP age.",
                        "path": [
                            "PRODUCTION_DAY"
                        ]
                    },
                    {
                        "description": "Sudo column w/t value that is used for calculating",
                        "path": [
                            "WIP_COUNTER"
                        ]
                    },
                    {
                        "description": "Number of days car has been in WIP on a given reporting day",
                        "path": [
                            "WIP_AGE"
                        ]
                    },
                    {
                        "description": "Maximum WIP age for a given plant-model combination",
                        "path": [
                            "MAX_WIP_AGE_PLANT_MODEL"
                        ]
                    },
                    {
                        "description": "Plan / target corrosponding to table_type",
                        "path": [
                            "PLAN"
                        ]
                    },
                    {
                        "description": "Date for which data is looked at. Use this in Tableau !",
                        "path": [
                            "REPORT_DATE"
                        ]
                    },
                    {
                        "description": "One of BUILD, ABS, WIP. Tells which of the aforementioned 3 does an meta_order_number belong to for a report_date",
                        "path": [
                            "TABLE_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars build for a REPORT_DATE, MODEL_ID, ASSY_LOC_ID combination",
                        "path": [
                            "BUILD_QTY"
                        ]
                    },
                    {
                        "description": "Why loss happened which caused delta against the plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_REASON"
                        ]
                    },
                    {
                        "description": "One of \"Supplier, Quality Production, MP&L, Facilities, Systems/IT, Launch, Other, Quality Holds, Special Cause\"",
                        "path": [
                            "LOSS_CATEGORY"
                        ]
                    },
                    {
                        "description": "Timestamp of when the loss entry was modified/created",
                        "path": [
                            "LOSS_MODIFIED_TIMESTAMP"
                        ]
                    },
                    {
                        "description": "Email of entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_EMAIL"
                        ]
                    },
                    {
                        "description": "Name of the entity who modified the loss",
                        "path": [
                            "LOSS_MODIFIED_BY_NAME"
                        ]
                    },
                    {
                        "description": "Number of cars away from plan for a TABLE_TYPE",
                        "path": [
                            "LOSS_QTY"
                        ]
                    },
                    {
                        "description": "Date on which loss happened",
                        "path": [
                            "LOSS_DATE"
                        ]
                    },
                    {
                        "description": "BUILD or ABS",
                        "path": [
                            "LOSS_TYPE"
                        ]
                    },
                    {
                        "description": "Number of cars affected by the loss for a ASSY_LOC_ID, MODEL_ID combination",
                        "path": [
                            "AFFECTED_NUMBER"
                        ]
                    },
                    {
                        "description": "320_LOSS_COMMENTARY: When was the loss last modified in the Tableau/Power App/SharePoint List",
                        "path": [
                            "MODIFIED_AT"
                        ]
                    },
                    {
                        "description": "Description of the location where the event happened",
                        "path": [
                            "EVENT_LOC_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if the record is archived in D42",
                        "path": [
                            "ARCHIVE_IND"
                        ]
                    },
                    {
                        "description": "Used to identify FLEET and OUV cars in D42",
                        "path": [
                            "ARCO_ID"
                        ]
                    },
                    {
                        "description": "Timestamp of when the car was Accepted by Sales(ABS). Check ABS_IND to know the current ABS status of the car as car can be ABSed multiple times",
                        "path": [
                            "ABS_DATE"
                        ]
                    },
                    {
                        "description": "Unique identifier for an event in D42",
                        "path": [
                            "EVEN_ID"
                        ]
                    },
                    {
                        "description": "Location id of where the event happened",
                        "path": [
                            "EVENT_LOC_ID"
                        ]
                    },
                    {
                        "description": "Description of the event",
                        "path": [
                            "EVENT_DESCRIPTION"
                        ]
                    },
                    {
                        "description": "Timestap of when the event was recorded in D42",
                        "path": [
                            "LAST_UPDATED"
                        ]
                    },
                    {
                        "description": "Boolean flag indicating if car is ('OUV', 'SDV') and built in China then it will not be included in ABS for China reporting and by lineage WIP",
                        "path": [
                            "CHINA_ABS_EXCLUSION_IND"
                        ]
                    },
                    {
                        "description": "Date of the saturday of the week for REPORT_DATE",
                        "path": [
                            "REPORT_DATE_SATURDAY"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "WEEK_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production week (saturday)",
                        "path": [
                            "PRODUCTION_WEEK_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production week (friday)",
                        "path": [
                            "PRODUCTION_WEEK_END"
                        ]
                    },
                    {
                        "description": "PER_ID from ADM_PER table. Follows yymm format",
                        "path": [
                            "MONTH_PER_ID"
                        ]
                    },
                    {
                        "description": "Date endicating start of the production month (saturday)",
                        "path": [
                            "PRODUCTION_MONTH_START"
                        ]
                    },
                    {
                        "description": "Date endicating end of the production month (friday)",
                        "path": [
                            "PRODUCTION_MONTH_END"
                        ]
                    },
                    {
                        "description": "Indenfier for start of production month for Tableau. Is inferred from MONTH_PER_ID in 'yymm' format to 'yyyy-mm-01'",
                        "path": [
                            "PRODUCTION_MONTH_ID"
                        ]
                    }
                ]
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "0300_PRODUCTION_DATA_DPR",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "310_DPRD_LATEST_BUILD_ABS_WIP_PLAN",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "0400_WIP_HISTORY",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "0450_INDIA_WIP_HISTORY",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report_access",
                    "name": "0320_LOSS_COMMENTARY",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "0150_INDIA_ACTUALS",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "JLR_DL_EDW_PLO_RAW_ACCESS",
                    "name": "ADM_PER_V",
                    "database": "jlr-it-scanalytics-prod"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_access",
                "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "TABLE"
        },
        {
            "type": "incremental",
            "target": {
                "schema": "daily_production_report",
                "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU_SNAP",
                "database": "jlr-it-scanalytics-dev"
            },
            "query": "\n\n\n\n\n\nSELECT *\n, CURRENT_DATETIME() AS SNAPSHOT_DATE\nFROM `jlr-it-scanalytics-dev.daily_production_report_access.0500_DPR_BUILD_ABS_WIP_TABLEAU`\n\n\n\n\n",
            "disabled": false,
            "protected": true,
            "fileName": "definitions/outputs/0500_DPR_BUILD_ABS_WIP_TABLEAU_SNAP.sqlx",
            "bigquery": {
                "partitionBy": "DATE(SNAPSHOT_DATE)",
                "partitionExpirationDays": 30
            },
            "tags": [
                "DPR",
                "FINAL",
                "SNAPSHOT"
            ],
            "actionDescriptor": {
                "description": "Snapshot of final DPR table"
            },
            "incrementalQuery": "\n\n\n\n\n\nSELECT *\n, CURRENT_DATETIME() AS SNAPSHOT_DATE\nFROM `jlr-it-scanalytics-dev.daily_production_report_access.0500_DPR_BUILD_ABS_WIP_TABLEAU`\n\nWHERE TABLE_RUN_DATETIME > (SELECT MAX(SNAPSHOT_DATE) FROM `jlr-it-scanalytics-dev.daily_production_report.0500_DPR_BUILD_ABS_WIP_TABLEAU_SNAP`)\n\n\n",
            "dependencyTargets": [
                {
                    "schema": "daily_production_report_access",
                    "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "incrementalPreOps": [
                "\n  DELETE\n  FROM\n    `jlr-it-scanalytics-dev.daily_production_report.0500_DPR_BUILD_ABS_WIP_TABLEAU_SNAP`\n  WHERE\n    DATE(SNAPSHOT_DATE) = CURRENT_DATE()\n"
            ],
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU_SNAP",
                "database": "jlr-it-scanalytics-dev"
            },
            "enumType": "INCREMENTAL"
        }
    ],
    "operations": [
        {
            "target": {
                "schema": "daily_production_report_access",
                "name": "0550_DPR_EXTRACT",
                "database": "jlr-it-scanalytics-dev"
            },
            "queries": [
                "\n\n\nEXPORT DATA OPTIONS (\n  uri = 'gs://dev_daily_production_report_extracts/dpr_extract_solihull_team/dpr_extract-2024-06-16-*.csv'\n  , format = 'CSV'\n  , overwrite = TRUE\n  , header = TRUE\n  , field_delimiter = ','\n) AS\n\nWITH DPR_DIGIT AS (\n  SELECT\n    REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SALES_MODEL_DESC\n    , TABLE_TYPE AS ROW_TYPE\n    , PLAN\n    , COUNT(DISTINCT FULL_VIN) AS ACTUAL\nFROM `jlr-it-scanalytics-dev.daily_production_report_access.0500_DPR_BUILD_ABS_WIP_TABLEAU`\n  WHERE 1 = 1\n  AND REPORT_DATE BETWEEN '2024-01-01' AND CURRENT_DATE() + 30\n  GROUP BY REPORT_DATE, ASSY_LOC_ID, MODEL_ID, SALES_MODEL_DESC, TABLE_TYPE, PLAN\n)\nSELECT * FROM DPR_DIGIT WHERE 1=1\nORDER BY REPORT_DATE DESC\n\n"
            ],
            "fileName": "definitions/outputs/0550_DPR_EXTRACT.sqlx",
            "tags": [
                "DPR",
                "EXTRACT"
            ],
            "actionDescriptor": {
                "description": "dpr aggregated extract"
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report_access",
                    "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_access",
                "name": "0550_DPR_EXTRACT",
                "database": "jlr-it-scanalytics-dev"
            }
        }
    ],
    "assertions": [
        {
            "query": "\n\n\nWITH D42_DATA_CREATED_IN_WHS_AT AS (\n  SELECT\n    TABLE_ID\n    , TIMESTAMP_MILLIS(CREATION_TIME) AS CREATION_TIME\n  FROM\n    `jlr-it-scanalytics-prod.daily_production_report.__TABLES_SUMMARY__`\n  WHERE\n    TABLE_ID = '0100_DPR_D42_META_DATA_FLAT'\n)\n\nSELECT * FROM D42_DATA_CREATED_IN_WHS_AT\nWHERE DATE(CREATION_TIME) != CURRENT_DATE\n\n",
            "fileName": "definitions/assertions/ASSER_CHECK_D42_SOURCE_FROM_ORDER_PROCESSING.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_CHECK_D42_SOURCE_FROM_ORDER_PROCESSING",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "DPR",
                "ASSER"
            ],
            "actionDescriptor": {
                "description": "Checks if the order_processing pipeline has the latest data from today to run DPR pipeline"
            },
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_CHECK_D42_SOURCE_FROM_ORDER_PROCESSING",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "query": "\n\n\nWITH CUR_PROD_DATA AS (\n  SELECT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , COUNT(DISTINCT META_ORDER_NUMBER) AS PROD_CNT\n  -- FROM `jlr-it-scanalytics-prod.daily_production_report_access.0500_DPR_BUILD_ABS_WIP_TABLEAU` -- REQUEST PERMISSIONS TO THIS DATASET\n  FROM `jlr-it-scanalytics-dev.z_aalex.DPR_BUILD_ABS_WIP_TABLEAU_V2` -- REQUEST PERMISSIONS TO THIS DATASET\n  WHERE 1 = 1\n    AND REPORT_DATE > '2024-02-16'\n    AND REPORT_DATE <= CURRENT_DATE() - 1\n  GROUP BY 1, 2, 3, 4\n)\n\n, CUR_DEV_DATA AS (\n  SELECT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , COUNT(DISTINCT META_ORDER_NUMBER) AS DEV_CNT\n  FROM `jlr-it-scanalytics-dev.daily_production_report_access.0500_DPR_BUILD_ABS_WIP_TABLEAU`\n  WHERE 1 = 1\n    AND REPORT_DATE > '2024-02-16'\n    AND REPORT_DATE <= CURRENT_DATE() - 1\n  GROUP BY 1, 2, 3, 4\n)\n\n, DATA_DELTA AS (\n  SELECT\n    TABLE_TYPE\n    , REPORT_DATE\n    , PROD_CNT\n    , DEV_CNT\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , (PROD_CNT - DEV_CNT) AS _DELTA\n  FROM\n    CUR_PROD_DATA AS P\n  FULL JOIN CUR_DEV_DATA AS D\n    USING (TABLE_TYPE, REPORT_DATE, ASSY_LOC_ID, MODEL_ID)\n)\n\n, FINAL_DELTA_TABLE AS (\n  SELECT * FROM DATA_DELTA WHERE _DELTA != 0\n)\n\nSELECT\n  TABLE_TYPE\n  , REPORT_DATE\n  , PROD_CNT\n  , DEV_CNT\n  , ASSY_LOC_ID\n  , MODEL_ID\n  , SUM(_DELTA) AS SUM_DELTA\nFROM\n  FINAL_DELTA_TABLE WHERE 1 = 1\n  AND ASSY_LOC_ID != 'CHP'\nGROUP BY 1, 2, 3, 4, 5, 6\n\n",
            "fileName": "definitions/assertions/ASSER_COMPARE_BUILT_ACTUALS_WT_VIEW.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_COMPARE_BUILT_ACTUALS_WT_VIEW",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "ASSER"
            ],
            "actionDescriptor": {
                "description": "Compares the built numbers               produced by `jlr-cat-opsim-dev.z_aalex.SLOTTED_ACTUAL_00_BUILD_PLANT_V5`               which matches DPR              Assertion should return Null to pass. This view can be used as a good test as we have extensively tested               it for months comparing it to DPR"
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "0300_PRODUCTION_DATA_DPR",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report_access",
                    "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_COMPARE_BUILT_ACTUALS_WT_VIEW",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "query": "\n\n\nWITH CURRENT_ACTUALS AS (\n  SELECT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , COALESCE(SALES_MODEL_DESC, 'NA')  AS SALES_MODEL_DESC\n    , COUNT(DISTINCT META_ORDER_NUMBER) AS CNT\n  FROM\n    `jlr-it-scanalytics-dev.daily_production_report_access.0500_DPR_BUILD_ABS_WIP_TABLEAU` WHERE 1 = 1\n    AND REPORT_DATE <= CURRENT_DATE - 2\n  GROUP BY\n    TABLE_TYPE, REPORT_DATE, ASSY_LOC_ID, MODEL_ID, SALES_MODEL_DESC\n)\n\n, PAST_ACTUALS AS (\n  SELECT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , COALESCE(SALES_MODEL_DESC, 'NA')  AS SALES_MODEL_DESC\n    , COUNT(DISTINCT META_ORDER_NUMBER) AS CNT\n  FROM\n    -- fixed to prod so that any feat branch does not compare to its own snapshot\n    `jlr-it-scanalytics-prod.daily_production_report.0500_DPR_BUILD_ABS_WIP_TABLEAU_SNAP` WHERE 1 = 1\n    AND REPORT_DATE <= CURRENT_DATE - 2\n    AND DATE(SNAPSHOT_DATE) = CURRENT_DATE() - 1\n  GROUP BY\n    TABLE_TYPE, REPORT_DATE, ASSY_LOC_ID, MODEL_ID, SALES_MODEL_DESC\n)\n\n, DIFF_TEST AS (\n  SELECT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SALES_MODEL_DESC\n    , P.CNT           AS PAST_CNT\n    , C.CNT           AS CURR_CNT\n    , (P.CNT - C.CNT) AS DELTA\n  FROM PAST_ACTUALS AS P\n  FULL JOIN CURRENT_ACTUALS AS C\n    USING (TABLE_TYPE, REPORT_DATE, ASSY_LOC_ID, MODEL_ID, SALES_MODEL_DESC)\n)\n\nSELECT * FROM DIFF_TEST WHERE 1=1\n  AND ASSY_LOC_ID NOT IN ('INP', 'CHP')\n  AND REPORT_DATE > '2023-12-16'\n  AND (DELTA != 0 OR DELTA IS NULL )\n  AND NOT (SELECT MIN(DATE(SNAPSHOT_DATE)) FROM `jlr-it-scanalytics-dev.daily_production_report.0500_DPR_BUILD_ABS_WIP_TABLEAU_SNAP`) = CURRENT_DATE()\n\n",
            "fileName": "definitions/assertions/ASSER_COMP_PREV_ACTUALS_WT_SNAPSHOT.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_COMP_PREV_ACTUALS_WT_SNAPSHOT",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "DPR",
                "ASSER"
            ],
            "actionDescriptor": {
                "description": "Compares previous days actuals from the snapshot table to current acutals form the table.                 The idea being, that acutals of the past should not change"
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report_access",
                    "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU_SNAP",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_COMP_PREV_ACTUALS_WT_SNAPSHOT",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "query": "\n\n\nWITH OUTPUT_310_BUILD_PLAN AS (\n  SELECT\n    REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SUM(BUILD_TARGET) AS PLAN\n  FROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\n  GROUP BY 1, 2, 3\n)\n\n, OUTPUT_310_ABS_PLAN AS (\n  SELECT\n    REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SUM(CASE WHEN ASSY_LOC_ID = 'SLP' THEN BUILD_TARGET ELSE ABS_TARGET END) AS PLAN\n  FROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\n  GROUP BY 1, 2, 3\n)\n\n\n, OUTPUT_310_WIP_PLAN AS (\n  SELECT\n    REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SUM(WIP_TARGET) AS PLAN\n  FROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\n  GROUP BY 1, 2, 3\n)\n\n\n\n, _OUTPUT_500_BUILD_PLAN AS (\n  SELECT DISTINCT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , CASE WHEN ASSY_LOC_ID = 'NTP' THEN  SALES_MODEL_DESC ELSE MODEL_ID END AS SALES_MODEL_DESC\n    , PLAN\n  FROM `jlr-it-scanalytics-dev.daily_production_report_access.0500_DPR_BUILD_ABS_WIP_TABLEAU`\n  WHERE TABLE_TYPE = 'BUILD'\n)\n\n, OUTPUT_500_BUILD_PLAN AS (\n  SELECT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SUM(PLAN) AS PLAN\n  FROM _OUTPUT_500_BUILD_PLAN\n  GROUP BY 1, 2, 3, 4\n)\n\n\n, _OUTPUT_500_ABS_PLAN AS (\n  SELECT DISTINCT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , CASE WHEN ASSY_LOC_ID = 'NTP' THEN  SALES_MODEL_DESC ELSE MODEL_ID END AS SALES_MODEL_DESC\n    , PLAN\n  FROM `jlr-it-scanalytics-dev.daily_production_report_access.0500_DPR_BUILD_ABS_WIP_TABLEAU`\n  WHERE TABLE_TYPE = 'ABS'\n)\n\n\n, OUTPUT_500_ABS_PLAN AS (\n  SELECT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SUM(PLAN) AS PLAN\n  FROM _OUTPUT_500_ABS_PLAN\n  GROUP BY 1, 2, 3, 4\n)\n\n\n, _OUTPUT_500_WIP_PLAN AS (\n  SELECT DISTINCT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , CASE WHEN ASSY_LOC_ID = 'NTP' THEN  SALES_MODEL_DESC ELSE MODEL_ID END AS SALES_MODEL_DESC\n    , PLAN\n  FROM `jlr-it-scanalytics-dev.daily_production_report_access.0500_DPR_BUILD_ABS_WIP_TABLEAU`\n  WHERE TABLE_TYPE = 'WIP'\n)\n\n, OUTPUT_500_WIP_PLAN AS (\n  SELECT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SUM(PLAN) AS PLAN\n  FROM _OUTPUT_500_WIP_PLAN\n  GROUP BY 1, 2, 3, 4\n)\n\n\n, BUILD_PLAN_DIFF AS (\n  SELECT\n    COALESCE(A.REPORT_DATE, O.REPORT_DATE)   AS REPORT_DATE\n    , COALESCE(A.ASSY_LOC_ID, O.ASSY_LOC_ID) AS ASSY_LOC_ID\n    , COALESCE(A.MODEL_ID, O.MODEL_ID)       AS MODEL_ID\n    , A.PLAN                                 AS PLAN_310\n    , O.PLAN                                 AS PLAN_500\n    , A.PLAN - O.PLAN                        AS PLAN_DIFF\n    , 'BUILD'                                AS TABLE_TYPE\n  FROM OUTPUT_310_BUILD_PLAN AS A\n  FULL JOIN OUTPUT_500_BUILD_PLAN AS O\n    ON A.REPORT_DATE = O.REPORT_DATE\n    AND A.MODEL_ID = O.MODEL_ID\n    AND A.ASSY_LOC_ID = O.ASSY_LOC_ID\n)\n\n, FINAL_BUILD_DIFF AS (\n  SELECT * FROM BUILD_PLAN_DIFF\n  WHERE (PLAN_500 IS NULL AND PLAN_310 IS NOT NULL)\n    OR PLAN_DIFF != 0\n)\n\n\n, ABS_PLAN_DIFF AS (\n  SELECT\n    COALESCE(A.REPORT_DATE, O.REPORT_DATE)   AS REPORT_DATE\n    , COALESCE(A.ASSY_LOC_ID, O.ASSY_LOC_ID) AS ASSY_LOC_ID\n    , COALESCE(A.MODEL_ID, O.MODEL_ID)       AS MODEL_ID\n    , A.PLAN                                 AS PLAN_310\n    , O.PLAN                                 AS PLAN_500\n    , A.PLAN - O.PLAN                        AS PLAN_DIFF\n    , 'ABS'                                  AS TABLE_TYPE\n  FROM OUTPUT_310_ABS_PLAN AS A\n  FULL JOIN OUTPUT_500_ABS_PLAN AS O\n    ON A.REPORT_DATE = O.REPORT_DATE\n    AND A.MODEL_ID = O.MODEL_ID\n    AND A.ASSY_LOC_ID = O.ASSY_LOC_ID\n)\n\n\n, FINAL_ABS_DIFF AS (\n  SELECT * FROM ABS_PLAN_DIFF\n  WHERE (PLAN_500 IS NULL AND PLAN_310 IS NOT NULL)\n    OR PLAN_DIFF != 0\n)\n\n\n, WIP_PLAN_DIFF AS (\n  SELECT\n    COALESCE(A.REPORT_DATE, O.REPORT_DATE)   AS REPORT_DATE\n    , COALESCE(A.ASSY_LOC_ID, O.ASSY_LOC_ID) AS ASSY_LOC_ID\n    , COALESCE(A.MODEL_ID, O.MODEL_ID)       AS MODEL_ID\n    , A.PLAN                                 AS PLAN_310\n    , O.PLAN                                 AS PLAN_500\n    , A.PLAN - O.PLAN                        AS PLAN_DIFF\n    , 'WIP'                                  AS TABLE_TYPE\n  FROM OUTPUT_310_WIP_PLAN AS A\n  FULL JOIN OUTPUT_500_WIP_PLAN AS O\n    ON A.REPORT_DATE = O.REPORT_DATE\n    AND A.MODEL_ID = O.MODEL_ID\n    AND A.ASSY_LOC_ID = O.ASSY_LOC_ID\n)\n\n\n, FINAL_WIP_DIFF AS (\n  SELECT * FROM WIP_PLAN_DIFF\n  WHERE (PLAN_500 IS NULL AND PLAN_310 IS NOT NULL)\n    OR PLAN_DIFF != 0\n)\n\n, FINAL_DIFF AS (\n  SELECT * FROM FINAL_BUILD_DIFF\n  UNION ALL\n  SELECT * FROM FINAL_ABS_DIFF\n  UNION ALL\n  SELECT * FROM FINAL_WIP_DIFF\n)\n\nSELECT * FROM FINAL_DIFF WHERE 1 = 1\n  AND REPORT_DATE >= '2024-04-01'\n\n",
            "fileName": "definitions/assertions/ASSER_MATCH_310_PLAN_WT_500.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_MATCH_310_PLAN_WT_500",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "DPR",
                "ASSER",
                "PLAN"
            ],
            "actionDescriptor": {
                "description": "Checks if plan produced by 310_DPRD_LATEST_BUILD_ABS_WIP_PLAN matches 0500_DPR_BUILD_ABS_WIP_TABLEAU at model level"
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report_access",
                    "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "310_DPRD_LATEST_BUILD_ABS_WIP_PLAN",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_MATCH_310_PLAN_WT_500",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "query": "\n\n\nWITH _LATEST_BUILD_ABS_WIP_PLAN AS (\n  SELECT\n    *\n    , DENSE_RANK() OVER (PARTITION BY ASSY_LOC_ID, MODEL_ID, SALES_MODEL_DESC, REPORT_DATE ORDER BY LAST_UPDATE_DATETIME DESC) AS RN\n  FROM `jlr-it-scanalytics-prod.daily_production_report.DPRD_BUILD_ABS_WIP_PLAN`\n  QUALIFY RN = 1\n)\n\n, LATEST_BUILD_ABS_WIP_PLAN AS (\n  SELECT\n    * EXCEPT (RN)\n    , SALES_MODEL_DESC IS NULL                                                             AS SALES_MODEL_DESC_IS_NULL\n    , COALESCE(COUNT(*) OVER (PARTITION BY MODEL_ID, REPORT_DATE, ASSY_LOC_ID) > 1, FALSE) AS SALES_MODEL_DESC_LEVEL_PLAN_AVAILABLE\n  FROM _LATEST_BUILD_ABS_WIP_PLAN\n)\n\n, _SALES_MODEL_DESC_LEVEL_BUILD_ABS_WIP_PLAN_WO_DUPLICATES AS (\n  SELECT\n    *\n    -- The below will happen when we have both model and sales_model_desc level plans available\n    -- an edge case that happens during the transition period when they would have uploaded model level plans in the prior week\n    , COALESCE(SALES_MODEL_DESC_LEVEL_PLAN_AVAILABLE AND SALES_MODEL_DESC_IS_NULL, FALSE) AS EXCLUDE_ROW\n  FROM LATEST_BUILD_ABS_WIP_PLAN\n)\n\n, SALES_MODEL_DESC_LEVEL_BUILD_ABS_WIP_PLAN_WO_DUPLICATES AS (\n  SELECT *\n  FROM _SALES_MODEL_DESC_LEVEL_BUILD_ABS_WIP_PLAN_WO_DUPLICATES\n  WHERE NOT EXCLUDE_ROW\n)\n\n\n, FINAL_SALES_MODEL_DESC_LEVEL_PLAN AS (\n  SELECT DISTINCT\n    REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SALES_MODEL_DESC\n    , BUILD_PLAN AS BUILD_TARGET\n    , ABS_TARGET\n    , WIP_TARGET\n  FROM SALES_MODEL_DESC_LEVEL_BUILD_ABS_WIP_PLAN_WO_DUPLICATES\n)\n\n, OUTPUT_310 AS (\n  SELECT DISTINCT\n    REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SALES_MODEL_DESC\n    , BUILD_TARGET\n    , ABS_TARGET\n    , WIP_TARGET\n  FROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\n)\n\n, _FINAL_DIFF_TABLE AS (\n  SELECT\n    COALESCE(L.REPORT_DATE, O.REPORT_DATE)             AS REPORT_DATE\n    , COALESCE(L.ASSY_LOC_ID, O.ASSY_LOC_ID)           AS ASSY_LOC_ID\n    , COALESCE(L.MODEL_ID, O.MODEL_ID)                 AS MODEL_ID\n    , COALESCE(L.SALES_MODEL_DESC, O.SALES_MODEL_DESC) AS SALES_MODEL_DESC\n    , L.BUILD_TARGET - O.BUILD_TARGET                  AS BUILD_DIFF\n    , L.ABS_TARGET - O.ABS_TARGET                      AS ABS_DIFF\n    , L.WIP_TARGET - O.WIP_TARGET                      AS WIP_DIFF\n  FROM FINAL_SALES_MODEL_DESC_LEVEL_PLAN AS L\n  FULL JOIN OUTPUT_310 AS O\n    ON\n    L.REPORT_DATE = O.REPORT_DATE\n    AND L.ASSY_LOC_ID = O.ASSY_LOC_ID\n    AND L.MODEL_ID = O.MODEL_ID\n    AND L.SALES_MODEL_DESC = O.SALES_MODEL_DESC\n)\n\n, FINAL_DIFF_TABLE AS (\n  SELECT * FROM _FINAL_DIFF_TABLE WHERE 1 = 1\n    AND REPORT_DATE >= '2023-12-01'\n)\n\nSELECT * FROM FINAL_DIFF_TABLE WHERE\n  BUILD_DIFF != 0\n  OR ABS_DIFF != 0\n  OR WIP_DIFF != 0\n\n",
            "fileName": "definitions/assertions/ASSER_MATCH_INPUT_PLAN_WT_310.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_MATCH_INPUT_PLAN_WT_310",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "DPR",
                "ASSER"
            ],
            "actionDescriptor": {
                "description": "Checks if input model level plan matches model level plan produced by 310_DPRD_LATEST_BUILD_ABS_WIP_PLAN "
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "310_DPRD_LATEST_BUILD_ABS_WIP_PLAN",
                    "database": "jlr-it-scanalytics-dev"
                },
                {
                    "schema": "daily_production_report",
                    "name": "DPRD_BUILD_ABS_WIP_PLAN",
                    "database": "jlr-it-scanalytics-prod"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_MATCH_INPUT_PLAN_WT_310",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "query": "\n\n\nWITH TEST AS (\n  SELECT DISTINCT\n    REPORT_DATE\n    , TABLE_TYPE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SALES_MODEL_DESC\n    , PLAN\n  FROM `jlr-it-scanalytics-dev.daily_production_report_access.0500_DPR_BUILD_ABS_WIP_TABLEAU`\n  WHERE 1 = 1\n)\n\nSELECT\n  *\n  , COUNT(*) OVER (PARTITION BY REPORT_DATE, TABLE_TYPE, ASSY_LOC_ID, MODEL_ID) AS CNT\nFROM\n  TEST WHERE 1 = 1\n  AND MODEL_ID NOT IN ('L663', 'X260', 'X152')\nQUALIFY CNT > 1\n\n",
            "fileName": "definitions/assertions/ASSER_MODELS_WO_SALES_MODEL_DESC_UNIQUE.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_MODELS_WO_SALES_MODEL_DESC_UNIQUE",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "DPR",
                "PLAN",
                "ASSER"
            ],
            "actionDescriptor": {
                "description": "For model_ids with no sales_model_desc we should not ever have multiple rows for the same model_id. This happens when you have build cars on current date which has sales_model_desc and you donot have sales_model_desc level plan for that model"
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report_access",
                    "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_MODELS_WO_SALES_MODEL_DESC_UNIQUE",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "query": "\n\n\nWITH TEST AS (\n  SELECT DISTINCT\n    TABLE_TYPE\n    , REPORT_DATE\n    , ASSY_LOC_ID\n    , MODEL_ID\n    , SALES_MODEL_DESC\n    , PLAN\n  FROM `jlr-it-scanalytics-dev.daily_production_report_access.0500_DPR_BUILD_ABS_WIP_TABLEAU`\n)\n\n, TEST_WT_CNT AS (\n  SELECT\n    *\n    , COUNT(*) OVER (PARTITION BY TABLE_TYPE, REPORT_DATE, ASSY_LOC_ID) AS CNT\n  FROM TEST\n)\n\nSELECT * FROM\n  TEST_WT_CNT WHERE 1 = 1\n  AND REPORT_DATE >= CURRENT_DATE - 1\n  AND ASSY_LOC_ID = 'NTP'\n  AND CNT > 4\nORDER BY TABLE_TYPE DESC\n\n",
            "fileName": "definitions/assertions/ASSER_NITRA_PLAN_FOUR_ROWS_FUTURE.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_NITRA_PLAN_FOUR_ROWS_FUTURE",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "DPR",
                "PLAN",
                "ASSER"
            ],
            "actionDescriptor": {
                "description": "We should have exactly 4 distinct rows for NITRA plant plans at table_type, report_date, assy_loc_id level. As NITRA has L663 with 3 SALES_MODEL_DESC and L462 as the other model"
            },
            "dependencyTargets": [
                {
                    "schema": "daily_production_report_access",
                    "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "ASSER_NITRA_PLAN_FOUR_ROWS_FUTURE",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "query": "\nSELECT\n  'Full_VIN IS NOT NULL' AS failing_row_condition,\n  *\nFROM `jlr-it-scanalytics-dev.daily_production_report.0100_INDIA_ACTUALS`\nWHERE NOT (Full_VIN IS NOT NULL)\n",
            "fileName": "definitions/intermediate/0100_INDIA_ACTUALS.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "daily_production_report_0100_INDIA_ACTUALS_assertions_rowConditions",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "DPR",
                "INDIA_ACTUALS"
            ],
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "0100_INDIA_ACTUALS",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "daily_production_report_0100_INDIA_ACTUALS_assertions_rowConditions",
                "database": "jlr-it-scanalytics-dev"
            },
            "parentAction": {
                "schema": "daily_production_report",
                "name": "0100_INDIA_ACTUALS",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "query": "\nSELECT\n  *\nFROM (\n  SELECT\n    meta_order_number,\n    COUNT(1) AS index_row_count\n  FROM `jlr-it-scanalytics-dev.daily_production_report.0300_PRODUCTION_DATA_DPR`\n  GROUP BY meta_order_number\n  ) AS data\nWHERE index_row_count > 1\n",
            "fileName": "definitions/intermediate/0300_PRODUCTION_DATA_DPR.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "daily_production_report_0300_PRODUCTION_DATA_DPR_assertions_uniqueKey_0",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "DPR"
            ],
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "0300_PRODUCTION_DATA_DPR",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "daily_production_report_0300_PRODUCTION_DATA_DPR_assertions_uniqueKey_0",
                "database": "jlr-it-scanalytics-dev"
            },
            "parentAction": {
                "schema": "daily_production_report",
                "name": "0300_PRODUCTION_DATA_DPR",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "query": "\nSELECT\n  'meta_order_number IS NOT NULL' AS failing_row_condition,\n  *\nFROM `jlr-it-scanalytics-dev.daily_production_report.0300_PRODUCTION_DATA_DPR`\nWHERE NOT (meta_order_number IS NOT NULL)\n",
            "fileName": "definitions/intermediate/0300_PRODUCTION_DATA_DPR.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "daily_production_report_0300_PRODUCTION_DATA_DPR_assertions_rowConditions",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "DPR"
            ],
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "0300_PRODUCTION_DATA_DPR",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "daily_production_report_0300_PRODUCTION_DATA_DPR_assertions_rowConditions",
                "database": "jlr-it-scanalytics-dev"
            },
            "parentAction": {
                "schema": "daily_production_report",
                "name": "0300_PRODUCTION_DATA_DPR",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "query": "\nSELECT\n  'REPORT_DATE IS NOT NULL' AS failing_row_condition,\n  *\nFROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\nWHERE NOT (REPORT_DATE IS NOT NULL)\nUNION ALL\nSELECT\n  'BUILD_TARGET IS NOT NULL' AS failing_row_condition,\n  *\nFROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\nWHERE NOT (BUILD_TARGET IS NOT NULL)\nUNION ALL\nSELECT\n  'ABS_TARGET IS NOT NULL' AS failing_row_condition,\n  *\nFROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\nWHERE NOT (ABS_TARGET IS NOT NULL)\nUNION ALL\nSELECT\n  'WIP_TARGET IS NOT NULL' AS failing_row_condition,\n  *\nFROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\nWHERE NOT (WIP_TARGET IS NOT NULL)\nUNION ALL\nSELECT\n  'LAST_UPDATE_DATETIME IS NOT NULL' AS failing_row_condition,\n  *\nFROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\nWHERE NOT (LAST_UPDATE_DATETIME IS NOT NULL)\nUNION ALL\nSELECT\n  'ASSY_LOC_ID IS NOT NULL' AS failing_row_condition,\n  *\nFROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\nWHERE NOT (ASSY_LOC_ID IS NOT NULL)\nUNION ALL\nSELECT\n  'MODEL_ID IS NOT NULL' AS failing_row_condition,\n  *\nFROM `jlr-it-scanalytics-dev.daily_production_report.310_DPRD_LATEST_BUILD_ABS_WIP_PLAN`\nWHERE NOT (MODEL_ID IS NOT NULL)\n",
            "fileName": "definitions/intermediate/310_DPRD_LATEST_BUILD_ABS_WIP_PLAN.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "daily_production_report_310_DPRD_LATEST_BUILD_ABS_WIP_PLAN_assertions_rowConditions",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "DPR",
                "PLAN"
            ],
            "dependencyTargets": [
                {
                    "schema": "daily_production_report",
                    "name": "310_DPRD_LATEST_BUILD_ABS_WIP_PLAN",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "daily_production_report_310_DPRD_LATEST_BUILD_ABS_WIP_PLAN_assertions_rowConditions",
                "database": "jlr-it-scanalytics-dev"
            },
            "parentAction": {
                "schema": "daily_production_report",
                "name": "310_DPRD_LATEST_BUILD_ABS_WIP_PLAN",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "query": "\nSELECT\n  'meta_order_number IS NOT NULL' AS failing_row_condition,\n  *\nFROM `jlr-it-scanalytics-dev.daily_production_report_access.0200_D42_EVENTS_META_DATA`\nWHERE NOT (meta_order_number IS NOT NULL)\n",
            "fileName": "definitions/outputs/0200_D42_EVENTS_META_DATA.sqlx",
            "target": {
                "schema": "daily_production_report_assertions",
                "name": "daily_production_report_access_0200_D42_EVENTS_META_DATA_assertions_rowConditions",
                "database": "jlr-it-scanalytics-dev"
            },
            "tags": [
                "VEHICLE_SCHEDULING_TEAM_REQ",
                "DPR"
            ],
            "dependencyTargets": [
                {
                    "schema": "daily_production_report_access",
                    "name": "0200_D42_EVENTS_META_DATA",
                    "database": "jlr-it-scanalytics-dev"
                }
            ],
            "canonicalTarget": {
                "schema": "daily_production_report_assertions",
                "name": "daily_production_report_access_0200_D42_EVENTS_META_DATA_assertions_rowConditions",
                "database": "jlr-it-scanalytics-dev"
            },
            "parentAction": {
                "schema": "daily_production_report_access",
                "name": "0200_D42_EVENTS_META_DATA",
                "database": "jlr-it-scanalytics-dev"
            }
        }
    ],
    "projectConfig": {
        "warehouse": "bigquery",
        "defaultSchema": "daily_production_report",
        "assertionSchema": "daily_production_report_assertions",
        "defaultDatabase": "jlr-it-scanalytics-dev",
        "vars": {
            "executionSetting": "dev"
        },
        "defaultLocation": "EU"
    },
    "graphErrors": {},
    "declarations": [
        {
            "target": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "DEALERS_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "DEALERS_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "HOLDS_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "HOLDS_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "HOLD_TYPES_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "HOLD_TYPES_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "HOLD_GROUPS_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "HOLD_GROUPS_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "LOCATIONS_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "LOCATIONS_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "LOCATION_EVENTS_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "LOCATION_EVENTS_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "VEHICLE_EVENTS_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "VEHICLE_EVENTS_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "VEHICLE_ORDERS_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "VEHICLE_ORDERS_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "MODELS_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "MODELS_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "EVENTS_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
                "name": "EVENTS_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "daily_production_report",
                "name": "SHUTDOWN_DATES_ALL_PLANTS",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "SHUTDOWN_DATES_ALL_PLANTS",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "daily_production_report",
                "name": "DPRD_BUILD_ABS_WIP_PLAN",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "DPRD_BUILD_ABS_WIP_PLAN",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "daily_production_report",
                "name": "DPR_ENGINES_PLAN_WT_ACTUALS",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "DPR_ENGINES_PLAN_WT_ACTUALS",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "daily_production_report",
                "name": "OLD_BUILD_ABS_WIP_PLAN_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "OLD_BUILD_ABS_WIP_PLAN_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "vista_metadata_access",
                "name": "0500_VISTA_ORDER_METADATA",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "vista_metadata_access",
                "name": "0500_VISTA_ORDER_METADATA",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "whs_projector_access",
                "name": "0300_PLO_ORDERS_ALLOCATIONS_JOINED",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "whs_projector_access",
                "name": "0300_PLO_ORDERS_ALLOCATIONS_JOINED",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "daily_production_report",
                "name": "0100_DPR_D42_META_DATA_FLAT",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "0100_DPR_D42_META_DATA_FLAT",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "daily_production_report",
                "name": "DPR_COMMENTARY_SHAREPOINT_LIST_RAW",
                "database": "jlr-it-scanalytics-dev"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "DPR_COMMENTARY_SHAREPOINT_LIST_RAW",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "target": {
                "schema": "JLR_DL_EDW_PLO_RAW_ACCESS",
                "name": "ADM_PER_V",
                "database": "jlr-it-scanalytics-prod"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "JLR_DL_EDW_PLO_RAW_ACCESS",
                "name": "ADM_PER_V",
                "database": "jlr-it-scanalytics-prod"
            }
        },
        {
            "target": {
                "schema": "daily_production_report",
                "name": "DPRD_INDIA_BUILD_ABS_WIP_PLAN_ACTUALS",
                "database": "jlr-it-scanalytics-dev"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "DPRD_INDIA_BUILD_ABS_WIP_PLAN_ACTUALS",
                "database": "jlr-it-scanalytics-dev"
            }
        },
        {
            "target": {
                "schema": "daily_production_report",
                "name": "DPRD_INDIA_BUILD_ABS_WIP_PLAN",
                "database": "jlr-it-scanalytics-dev"
            },
            "fileName": "definitions/declarations/sources.js",
            "canonicalTarget": {
                "schema": "daily_production_report",
                "name": "DPRD_INDIA_BUILD_ABS_WIP_PLAN",
                "database": "jlr-it-scanalytics-dev"
            }
        }
    ],
    "dataformCoreVersion": "3.0.0-beta.4",
    "targets": [
        {
            "schema": "daily_production_report_assertions",
            "name": "ASSER_CHECK_D42_SOURCE_FROM_ORDER_PROCESSING",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_assertions",
            "name": "ASSER_COMPARE_BUILT_ACTUALS_WT_VIEW",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_assertions",
            "name": "ASSER_COMP_PREV_ACTUALS_WT_SNAPSHOT",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_assertions",
            "name": "ASSER_MATCH_310_PLAN_WT_500",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_assertions",
            "name": "ASSER_MATCH_INPUT_PLAN_WT_310",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_assertions",
            "name": "ASSER_MODELS_WO_SALES_MODEL_DESC_UNIQUE",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_assertions",
            "name": "ASSER_NITRA_PLAN_FOUR_ROWS_FUTURE",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
            "name": "DEALERS_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
            "name": "HOLDS_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
            "name": "HOLD_TYPES_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
            "name": "HOLD_GROUPS_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
            "name": "LOCATIONS_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
            "name": "LOCATION_EVENTS_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
            "name": "VEHICLE_EVENTS_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
            "name": "VEHICLE_ORDERS_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
            "name": "MODELS_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "JLR_DL_EDW_D42_RAW_ACCESS",
            "name": "EVENTS_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "daily_production_report",
            "name": "SHUTDOWN_DATES_ALL_PLANTS",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "daily_production_report",
            "name": "DPRD_BUILD_ABS_WIP_PLAN",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "daily_production_report",
            "name": "DPR_ENGINES_PLAN_WT_ACTUALS",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "daily_production_report",
            "name": "OLD_BUILD_ABS_WIP_PLAN_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "vista_metadata_access",
            "name": "0500_VISTA_ORDER_METADATA",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "whs_projector_access",
            "name": "0300_PLO_ORDERS_ALLOCATIONS_JOINED",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "daily_production_report",
            "name": "0100_DPR_D42_META_DATA_FLAT",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "daily_production_report",
            "name": "DPR_COMMENTARY_SHAREPOINT_LIST_RAW",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "JLR_DL_EDW_PLO_RAW_ACCESS",
            "name": "ADM_PER_V",
            "database": "jlr-it-scanalytics-prod"
        },
        {
            "schema": "daily_production_report",
            "name": "DPRD_INDIA_BUILD_ABS_WIP_PLAN_ACTUALS",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report",
            "name": "DPRD_INDIA_BUILD_ABS_WIP_PLAN",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report",
            "name": "0100_INDIA_ACTUALS",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_assertions",
            "name": "daily_production_report_0100_INDIA_ACTUALS_assertions_rowConditions",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report",
            "name": "0150_INDIA_ACTUALS",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report",
            "name": "0300_PRODUCTION_DATA_DPR",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_assertions",
            "name": "daily_production_report_0300_PRODUCTION_DATA_DPR_assertions_uniqueKey_0",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_assertions",
            "name": "daily_production_report_0300_PRODUCTION_DATA_DPR_assertions_rowConditions",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report",
            "name": "0400_WIP_HISTORY",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report",
            "name": "0450_INDIA_WIP_HISTORY",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report",
            "name": "050_SHUTDOWN_DAYS",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report",
            "name": "310_DPRD_LATEST_BUILD_ABS_WIP_PLAN",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_assertions",
            "name": "daily_production_report_310_DPRD_LATEST_BUILD_ABS_WIP_PLAN_assertions_rowConditions",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_access",
            "name": "0200_D42_EVENTS_META_DATA",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_assertions",
            "name": "daily_production_report_access_0200_D42_EVENTS_META_DATA_assertions_rowConditions",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_access",
            "name": "0320_LOSS_COMMENTARY",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_access",
            "name": "0450_ENGINES",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_access",
            "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report",
            "name": "0500_DPR_BUILD_ABS_WIP_TABLEAU_SNAP",
            "database": "jlr-it-scanalytics-dev"
        },
        {
            "schema": "daily_production_report_access",
            "name": "0550_DPR_EXTRACT",
            "database": "jlr-it-scanalytics-dev"
        }
    ]
}

